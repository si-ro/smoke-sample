{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/smoke-node/async/index.js","webpack:///./node_modules/smoke-node/buffer/index.js","webpack:///./node_modules/smoke-node/streams/index.js","webpack:///./node_modules/smoke-node/rest/protocol/index.js","webpack:///./node_modules/smoke-node/sockets/index.js","webpack:///./node_modules/smoke-node/index.js","webpack:///./node_modules/smoke-node/url/index.js","webpack:///./node_modules/smoke-node/queryable/index.js","webpack:///./node_modules/smoke-node/bucket/constants.js","webpack:///./node_modules/smoke-node/sockets/socket.js","webpack:///./node_modules/smoke-node/rest/server/index.js","webpack:///./node_modules/smoke-node/querystring/index.js","webpack:///./node_modules/smoke-node/system/index.js","webpack:///./node_modules/smoke-node/database/index.js","webpack:///./node_modules/smoke-node/database/driver.js","webpack:///./node_modules/smoke-node/bucket/errors.js","webpack:///./node_modules/smoke-node/hub/index.js","webpack:///./node_modules/smoke-node/hub/page/index.js","webpack:///./node_modules/smoke-node/hub/page/sockets/index.js","webpack:///./node_modules/smoke-node/hub/page/sockets/bus.js","webpack:///./node_modules/smoke-node/hub/page/sockets/socket.js","webpack:///./node_modules/smoke-node/network/index.js","webpack:///./node_modules/smoke-node/sockets/server.js","webpack:///./node_modules/smoke-node/rest/index.js","webpack:///./node_modules/smoke-node/rest/server/router.js","webpack:///./node_modules/smoke-node/rest/server/request.js","webpack:///./node_modules/smoke-node/rest/server/response.js","webpack:///./node_modules/smoke-node/rest/fetch/index.js","webpack:///./node_modules/smoke-node/rest/fetch/request.js","webpack:///./node_modules/smoke-node/rest/fetch/response.js","webpack:///./src/index.js","webpack:///./node_modules/smoke-node/async/events.js","webpack:///./node_modules/smoke-node/async/barrier.js","webpack:///./node_modules/smoke-node/async/semaphore.js","webpack:///./node_modules/smoke-node/querystring/querystring.js","webpack:///./node_modules/smoke-node/path/index.js","webpack:///./node_modules/smoke-node/path/path.js","webpack:///./node_modules/smoke-node/url/url.js","webpack:///./node_modules/smoke-node/buffer/buffer.js","webpack:///./node_modules/smoke-node/buffer/ieee754.js","webpack:///./node_modules/smoke-node/buffer/base64.js","webpack:///./node_modules/smoke-node/streams/writable.js","webpack:///./node_modules/smoke-node/streams/readable.js","webpack:///./node_modules/smoke-node/queryable/queryable.js","webpack:///./node_modules/smoke-node/system/system.js","webpack:///./node_modules/smoke-node/database/database.js","webpack:///./node_modules/smoke-node/database/key.js","webpack:///./node_modules/smoke-node/bucket/index.js","webpack:///./node_modules/smoke-node/bucket/bucket.js","webpack:///./node_modules/smoke-node/bucket/reader.js","webpack:///./node_modules/smoke-node/bucket/writer.js","webpack:///./node_modules/smoke-node/hub/page/server.js","webpack:///./node_modules/smoke-node/hub/page/sockets/server.js","webpack:///./node_modules/smoke-node/hub/page/dhcp.js","webpack:///./node_modules/smoke-node/hub/page/client.js","webpack:///./node_modules/smoke-node/hub/network/index.js","webpack:///./node_modules/smoke-node/hub/network/client.js","webpack:///./node_modules/smoke-node/network/network.js","webpack:///./node_modules/smoke-node/sockets/sockets.js","webpack:///./node_modules/smoke-node/sockets/stream.js","webpack:///./node_modules/smoke-node/rest/rest.js","webpack:///./node_modules/smoke-node/rest/server/middleware.js","webpack:///./node_modules/smoke-node/rest/server/pattern.js","webpack:///./node_modules/smoke-node/rest/protocol/header.js","webpack:///./node_modules/smoke-node/rest/protocol/body.js","webpack:///./node_modules/smoke-node/rest/server/server.js","webpack:///./node_modules/smoke-node/rest/fetch/fetch.js","webpack:///./node_modules/smoke-node/node.js","webpack:///./node_modules/smoke-node/media/index.js","webpack:///./node_modules/smoke-node/media/media.js","webpack:///./node_modules/smoke-node/media/webrtc.js","webpack:///./node_modules/smoke-node/media/mse.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","events_1","Events","barrier_1","Barrier","semaphore_1","Semaphore","buffer_1","Buffer","writable_1","Writable","readable_1","Readable","header_1","HeaderProtocol","body_1","BodyProtocol","sockets_1","Sockets","server_1","SocketServer","socket_1","Socket","stream_1","NetworkStream","async_1","querystring_1","QueryString","path_1","Path","url_1","Url","streams_1","queryable_1","Queryable","system_1","System","database_1","Database","bucket_1","Bucket","hub_1","PageHub","NetworkHub","network_1","Network","rest_1","Rest","Fetch","FetchRequest","FetchResponse","Router","Route","RestServer","RestRequest","RestResponse","node_1","Node","FileStore","BlobStore","MAX_MESSAGE_SIZE","MAX_SEGMENT_SIZE","COMPLETE","PARTIAL","InvalidSocketMessage","Error","[object Object]","super","MessageSendSizeTooLarge","MessageReceiveSizeTooLarge","into","func","arguments","this","senders","buffers","event","once","on","track","mediastream","push","connection","addTrack","message","buffer","from","length","index","slice","channel","send","encode","sender","shift","removeTrack","close","type","data","alloc","concat","readInt8","addEventListener","emit","decode","reduce","acc","local","remote","binaryType","socket","setupEvents","net","port","async","peer","connect","error","router_1","request_1","response_1","driver_1","Reader","DBFactory","host","window","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","shimIndexedDB","awaiters","running","Promise","resolve","reject","dispatch","awaiter","setTimeout","ReaderAsyncIterator","reader","next","read","done","deferreds","values","ended","asyncIterator","deferred","record","promise","IDBDriver","database","semaphore","storeKeys","run","storeKey","version","stores","includes","open","additions","removals","objectStoreNames","recordKey","request","transaction","objectStore","result","count","write","openCursor","cursor","target","continue","records","update","updates","all","keys","map","transactUpdateRecordCursors","inserts","store","forEach","add","deletes","delete","transact","filter","indexOf","transactInsertRecords","transactUpdateRecords","transactDeleteRecords","databaseKey","options","updated","createObjectStore","keyPath","deleteObjectStore","deleteDatabase","FileNotFoundError","BlobNotFound","blobKey","page_1","PageHubServer","page_2","client_1","Server","createServer","Bus","bus_1","sendFunction","closeFunction","disposed","dispose","timeout","ch","clearTimeout","listening","toString","bindPort","onChannel","unbindPort","fromChannel","fetch_1","server_2","middleware_1","pattern_1","method","pattern","middleware","handler","response","url","parse","params","match","pathname","path","query","runStack","args","apply","endpoint","resolved","asMiddleware","use","Pattern","handle","protocol_1","InvalidRequestError","ReadRequestError","stream","header","headers","readReadable","readable","encoding","JSON","MediaStreamContext","streaming","transmit","ms","writable","delay","ResponseAlreadySentError","status","sent","writeResponseHeader","writeMediaStream","writeReadable","queryable","writeQueryable","queue","pull","controller","enqueue","stringify","body","writeRequestHeader","ignoreError","readResponseHeader","readQueryable","readMediaStream","__webpack_exports__","smoke_node__WEBPACK_IMPORTED_MODULE_0__","node0","node1","node2","rest","req","res","console","log","media","createTestPattern","listen","fetch","video","document","getElementById","srcObject","play","Event","handlers","messages","onces","listener","ons","events","Map","has","set","remove","paused","then","catch","concurrency","markers","charAt","segments","segment","split","assign","pair","pairs","undefined","array","parseQuerySegments","seg","parsePairs","flatMap","expanded","expandResult","collapseResult","ext","f","posixSplitPath","substr","root","dir","pathObject","TypeError","sep","base","paths","normalize","isAbsolute","trailingSlash","normalizeArray","join","parts","to","fromParts","trimArray","toParts","Math","min","samePartsLength","outputParts","resolvedPath","resolvedAbsolute","cwd","splitPathPattern","exec","allowAboveRoot","pop","lastIndex","start","end","delimiter","href","next0","next1","hostname","search","protocol","r0","parseProtocol","auth","r1","parseAuth","r2","parseHostname","r3","parseHost","r4","parsePort","r5","parsePath","r6","parsePathname","hash","r7","parseHash","r8","parseSearch","r9","parseQuery","ieee754","base64","MAX_ARGUMENTS_LENGTH","INVALID_BASE64_RE","INSPECT_MAX_BYTES","K_MAX_LENGTH","Uint8Array","buf","len","RangeError","swap","loweredCase","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","toLowerCase","slowToString","isBuffer","compare","str","max","replace","trim","isInstance","offset","byteLength","x","y","thisCopy","targetCopy","arr","val","byteOffset","indexSize","arrLength","valLength","String","readUInt16BE","foundIndex","found","j","numberIsNaN","arrayIndexOf","lastIndexOf","bidirectionalIndexOf","Array","_arr","fromByteArray","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","decodeCodePointsArray","codePoints","fromCharCode","ret","out","toHex","bytes","facade","subarray","__proto__","targetStart","copyWithin","isEncoding","code","charCodeAt","noAssert","checkOffset","mul","pow","string","Number","remaining","strLen","parsed","parseInt","blitBuffer","utf8ToBytes","asciiToBytes","asciiWrite","base64ToBytes","utf16leToBytes","isFinite","hexWrite","utf8Write","latin1Write","base64Write","ucs2Write","maxBytes","checkInt","limit","sub","littleEndian","checkIEEE754","writeFloat","writeDouble","size","assertSize","createBuffer","checked","fill","actual","obj","copy","fromArrayLike","isArray","fromString","ArrayBuffer","isView","fromArrayBuffer","valueOf","b","fromObject","toPrimitive","mustMatch","a","list","allocUnsafe","pos","units","Infinity","leadSurrogate","byteArray","hi","lo","toByteArray","base64clean","src","dst","constructor","isLE","mLen","nBytes","e","eLen","eMax","eBias","nBits","NaN","rt","abs","isNaN","floor","LN2","lookup","revLookup","Arr","getLens","b64","validLen","tripletToBase64","num","encodeChunk","uint8","tmp","output","lens","placeHoldersLen","_byteLength","curByte","extraBytes","len2","sink","abort","ReadableAsyncIterator","source","ReadableStream","getReader","cancel","iterable","element","generator","accu","toArray","direction","sorted","sort","left","right","ordering","element0","element1","initial","every","some","started","Date","getTime","now","loopback","transceivers","getTransceivers","getSenders","stats","getStats","info","peers","getPeers","stat","getNetStat","key_1","KeyRequiredError","barrier","driver","resume","creates","clear","Key","drop","random","constants_1","reader_1","writer_1","errors_1","dbname","exists","where","file","select","created","prefix","prepare","writer","Writer","contents","blobs","link","blob","Blob","commit","chunkSize","execute","readBuffer","FileReader","readAsArrayBuffer","ByteBuffer","total","consumed","unshift","highWaterMark","insert","flush","dhcp_1","configuration","sockets","dhcp","Dhcp","address","onMessage","onError","onClose","onForward","forward","server","onConnection","Uint32Array","async_2","binding","onBinding","pause","WebSocket","_","receive","eventName","removeEventListener","Loopback","loopbackSwitch","Receiver","Sender","NegotiateError","sdp","SignallingError","PortInUseError","hub","ports","createLoopback","getPeer","createDataChannel","race","callback","RTCPeerConnection","None","onNegotiationNeeded","onIceCandidate","onDataChannel","onCandidate","onAnswer","onOffer","resolveLoopbackTarget","setRemoteDescription","createAnswer","setLocalDescription","warn","addIceCandidate","candidate","createOffer","label","servers","createSocket","NEXT","CANCEL","DATA","ERROR","END","read_buffer","read_barrier","write_buffer","write_barrier","readInternal","stack","results","parsePattern","regex","buildRegex","buildParams","param","characters","current","expr","RegExp","ResponseHeaderNotReceivedError","ResponseHeaderInvalidError","RequestHeaderInvalidError","SEND_CHUNK_SIZE","empty","partition","json","getTracks","disposition","eof","read_disposition","streams","wait_for_stream","read_transmit","NETWORK_TIMEOUT","onSocket","readRequestHeader","text","FetchUrlError","FetchReadError","expected","createReadable","resolveBodyAsReadable","getResponse","media_1","network","system","Media","webrtc_1","mse_1","WebRTC","codec","MediaSourceExtensions","createMediaSource","canvas","createElement","width","height","context","getContext","setInterval","g","fillStyle","fillRect","appendBuffer","mediasource","MediaSource","addSourceBuffer","resolveCodec","writeSourceBuffer","endOfStream"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 30);\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar events_1 = require(\"./events\");\r\nexports.Events = events_1.Events;\r\nvar barrier_1 = require(\"./barrier\");\r\nexports.Barrier = barrier_1.Barrier;\r\nvar semaphore_1 = require(\"./semaphore\");\r\nexports.Semaphore = semaphore_1.Semaphore;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar buffer_1 = require(\"./buffer\");\r\nexports.Buffer = buffer_1.Buffer;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar writable_1 = require(\"./writable\");\r\nexports.Writable = writable_1.Writable;\r\nvar readable_1 = require(\"./readable\");\r\nexports.Readable = readable_1.Readable;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar header_1 = require(\"./header\");\r\nexports.HeaderProtocol = header_1.HeaderProtocol;\r\nvar body_1 = require(\"./body\");\r\nexports.BodyProtocol = body_1.BodyProtocol;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar sockets_1 = require(\"./sockets\");\r\nexports.Sockets = sockets_1.Sockets;\r\nvar server_1 = require(\"./server\");\r\nexports.SocketServer = server_1.SocketServer;\r\nvar socket_1 = require(\"./socket\");\r\nexports.Socket = socket_1.Socket;\r\nvar stream_1 = require(\"./stream\");\r\nexports.NetworkStream = stream_1.NetworkStream;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// -----------------------------------------------------------------------------\r\n//\r\n// Async Primitives\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar async_1 = require(\"./async\");\r\nexports.Barrier = async_1.Barrier;\r\nexports.Events = async_1.Events;\r\nexports.Semaphore = async_1.Semaphore;\r\n// -----------------------------------------------------------------------------\r\n//\r\n// Path QueryString Url\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar querystring_1 = require(\"./querystring\");\r\nexports.QueryString = querystring_1.QueryString;\r\nvar path_1 = require(\"./path\");\r\nexports.Path = path_1.Path;\r\nvar url_1 = require(\"./url\");\r\nexports.Url = url_1.Url;\r\n// -----------------------------------------------------------------------------\r\n//\r\n// Buffers, Streams and Queryable\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar buffer_1 = require(\"./buffer\");\r\nexports.Buffer = buffer_1.Buffer;\r\nvar streams_1 = require(\"./streams\");\r\nexports.Readable = streams_1.Readable;\r\nexports.Writable = streams_1.Writable;\r\nvar queryable_1 = require(\"./queryable\");\r\nexports.Queryable = queryable_1.Queryable;\r\n// -----------------------------------------------------------------------------\r\n//\r\n// System\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar system_1 = require(\"./system\");\r\nexports.System = system_1.System;\r\n// -----------------------------------------------------------------------------\r\n//\r\n// Database\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar database_1 = require(\"./database\");\r\nexports.Database = database_1.Database;\r\n// -----------------------------------------------------------------------------\r\n//\r\n// Bucket\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar bucket_1 = require(\"./bucket\");\r\nexports.Bucket = bucket_1.Bucket;\r\n// -----------------------------------------------------------------------------\r\n//\r\n// Network\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar hub_1 = require(\"./hub\");\r\nexports.PageHub = hub_1.PageHub;\r\nexports.NetworkHub = hub_1.NetworkHub;\r\nvar network_1 = require(\"./network\");\r\nexports.Network = network_1.Network;\r\nvar sockets_1 = require(\"./sockets\");\r\nexports.Sockets = sockets_1.Sockets;\r\nexports.SocketServer = sockets_1.SocketServer;\r\nexports.Socket = sockets_1.Socket;\r\nexports.NetworkStream = sockets_1.NetworkStream;\r\nvar rest_1 = require(\"./rest\");\r\nexports.Rest = rest_1.Rest;\r\nexports.Fetch = rest_1.Fetch;\r\nexports.FetchRequest = rest_1.FetchRequest;\r\nexports.FetchResponse = rest_1.FetchResponse;\r\nexports.Router = rest_1.Router;\r\nexports.Route = rest_1.Route;\r\nexports.RestServer = rest_1.RestServer;\r\nexports.RestRequest = rest_1.RestRequest;\r\nexports.RestResponse = rest_1.RestResponse;\r\n// -----------------------------------------------------------------------------\r\n//\r\n// Smoke\r\n//\r\n// -----------------------------------------------------------------------------\r\nvar node_1 = require(\"./node\");\r\nexports.Node = node_1.Node;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar url_1 = require(\"./url\");\r\nexports.Url = url_1.Url;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar queryable_1 = require(\"./queryable\");\r\nexports.Queryable = queryable_1.Queryable;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.FileStore = 'files';\r\nexports.BlobStore = 'blobs';\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../async\");\r\nconst buffer_1 = require(\"../buffer\");\r\nconst MAX_MESSAGE_SIZE = 1000000; // 1mb maximum message receive size.\r\nconst MAX_SEGMENT_SIZE = 32768; // 32k maximum message size.\r\nconst COMPLETE = 0;\r\nconst PARTIAL = 1;\r\nclass InvalidSocketMessage extends Error {\r\n    constructor() {\r\n        super('Received invalid socket message.');\r\n    }\r\n}\r\nexports.InvalidSocketMessage = InvalidSocketMessage;\r\nclass MessageSendSizeTooLarge extends Error {\r\n    constructor() {\r\n        super(`Message size exceeds ${MAX_MESSAGE_SIZE} bytes.`);\r\n    }\r\n}\r\nexports.MessageSendSizeTooLarge = MessageSendSizeTooLarge;\r\nclass MessageReceiveSizeTooLarge extends Error {\r\n    constructor() {\r\n        super(`Message received exceeded ${MAX_MESSAGE_SIZE} bytes.`);\r\n    }\r\n}\r\nexports.MessageReceiveSizeTooLarge = MessageReceiveSizeTooLarge;\r\nconst into = (func) => func();\r\n/**\r\n * A Web Socket like type built over RTCDataChannel. It supports\r\n * bi-directional messaging between peers within a network. This\r\n * socket type functions both as a Web Socket as well as a WebRTC\r\n * pass-through for sending and receiving MediaStream Tracks to\r\n * the sockets underlying RTCPeerConnection.\r\n */\r\nclass Socket extends async_1.Events {\r\n    constructor() {\r\n        super(...arguments);\r\n        /** RTCRTPSenders sending from this socket. */\r\n        this.senders = [];\r\n        /** A message receive buffer. */\r\n        this.buffers = [];\r\n    }\r\n    /** Subscribes once to events on this socket. */\r\n    once(event, func) {\r\n        super.once(event, func);\r\n    }\r\n    /** Subscribes to events on this socket. */\r\n    on(event, func) {\r\n        super.on(event, func);\r\n    }\r\n    /**\r\n     * Adds this mediastream track to this socket. Internally, this track\r\n     * is forwarded on to this sockets internal peer connection. Receiving\r\n     * sockets may listen for `onTrack` events negotiated somewhere outside\r\n     * of this implementation.\r\n     */\r\n    addTrack(track, mediastream) {\r\n        this.senders.push(this.connection.addTrack(track, mediastream));\r\n    }\r\n    /** Sends a message to this socket. */\r\n    send(message) {\r\n        const buffer = buffer_1.Buffer.from(message);\r\n        if (buffer.length > MAX_MESSAGE_SIZE) {\r\n            throw new MessageSendSizeTooLarge();\r\n        }\r\n        else {\r\n            let index = 0;\r\n            while (index !== buffer.length) {\r\n                const slice = buffer.slice(index, index + MAX_SEGMENT_SIZE);\r\n                index += slice.length;\r\n                if (index !== buffer.length) {\r\n                    this.channel.send(this.encode(PARTIAL, slice));\r\n                }\r\n                else {\r\n                    this.channel.send(this.encode(COMPLETE, slice));\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Closes this socket. Will also remove any RTCRtpSender tracks that were\r\n     * sent through this socket.\r\n     */\r\n    close() {\r\n        while (this.senders.length > 0) {\r\n            const sender = this.senders.shift();\r\n            this.connection.removeTrack(sender);\r\n        }\r\n        this.channel.close();\r\n    }\r\n    encode(type, data = buffer_1.Buffer.alloc(0)) {\r\n        return buffer_1.Buffer.concat([buffer_1.Buffer.from([type]), data]);\r\n    }\r\n    decode(data) {\r\n        const buffer = buffer_1.Buffer.from(data);\r\n        return [buffer.readInt8(0), buffer.slice(1)];\r\n    }\r\n    /**\r\n     * Sets up the events for this socket. Socket messages support partial sends\r\n     * of message payloads, the following logic buffers and emits only on\r\n     * receiving COMPLETE signals from the sender.\r\n     */\r\n    setupEvents() {\r\n        this.connection.addEventListener('track', event => this.emit('track', event));\r\n        this.channel.addEventListener('error', event => this.emit('error', event));\r\n        this.channel.addEventListener('close', event => this.emit('close', event));\r\n        this.channel.addEventListener('message', event => {\r\n            const [type, buffer] = this.decode(event.data);\r\n            this.buffers.push(buffer);\r\n            const buffered = this.buffers.reduce((acc, c) => acc + c.length, 0);\r\n            if (buffered > MAX_MESSAGE_SIZE) {\r\n                this.emit('error', new MessageReceiveSizeTooLarge());\r\n                this.close();\r\n            }\r\n            switch (type) {\r\n                case COMPLETE: {\r\n                    const data = buffer_1.Buffer.concat(this.buffers);\r\n                    this.emit('message', { data });\r\n                    this.buffers = [];\r\n                    break;\r\n                }\r\n                case PARTIAL: {\r\n                    break;\r\n                }\r\n                default: {\r\n                    this.emit('error', new InvalidSocketMessage());\r\n                    this.close();\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Creates a socket from a data channel sent from the network device. Used by\r\n     * the socket server to initialize new sockets on listen events.\r\n     */\r\n    static async fromChannel(connection, channel, local, remote) {\r\n        channel.binaryType = 'arraybuffer';\r\n        const socket = new Socket();\r\n        socket.connection = connection;\r\n        socket.channel = channel;\r\n        socket.remote = remote;\r\n        socket.local = local;\r\n        socket.buffers = [];\r\n        socket.setupEvents();\r\n        return socket;\r\n    }\r\n    /**\r\n     * Creates a web socket to the remote host and port. This function lazily\r\n     * initializes the underlying socket. Callers should wait for the open event\r\n     * to fire before interacting with this socket.\r\n     */\r\n    static createSocket(net, remote, port) {\r\n        const socket = new Socket();\r\n        into(async () => {\r\n            try {\r\n                const [peer, channel] = await net.connect(remote, port);\r\n                socket.connection = peer.connection;\r\n                socket.channel = channel;\r\n                socket.setupEvents();\r\n                socket.emit('open');\r\n            }\r\n            catch (error) {\r\n                socket.emit('error', error);\r\n                socket.emit('close');\r\n            }\r\n        });\r\n        return socket;\r\n    }\r\n}\r\nexports.Socket = Socket;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar router_1 = require(\"./router\");\r\nexports.Router = router_1.Router;\r\nexports.Route = router_1.Route;\r\nvar request_1 = require(\"./request\");\r\nexports.RestRequest = request_1.RestRequest;\r\nvar response_1 = require(\"./response\");\r\nexports.RestResponse = response_1.RestResponse;\r\nvar server_1 = require(\"./server\");\r\nexports.RestServer = server_1.RestServer;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar querystring_1 = require(\"./querystring\");\r\nexports.QueryString = querystring_1.QueryString;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar system_1 = require(\"./system\");\r\nexports.System = system_1.System;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar driver_1 = require(\"./driver\");\r\nexports.Reader = driver_1.Reader;\r\nvar database_1 = require(\"./database\");\r\nexports.Database = database_1.Database;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst DBFactory = () => {\r\n    const host = window;\r\n    return host.indexedDB\r\n        || host.mozIndexedDB\r\n        || host.webkitIndexedDB\r\n        || host.msIndexedDB\r\n        || host.shimIndexedDB;\r\n};\r\nclass Semaphore {\r\n    constructor() {\r\n        this.awaiters = [];\r\n        this.running = false;\r\n    }\r\n    /** Schedules this operation to run. */\r\n    run(func) {\r\n        return new Promise((resolve, reject) => {\r\n            this.awaiters.push({ func, resolve, reject });\r\n            this.dispatch();\r\n        });\r\n    }\r\n    /** (async-recursive) Dispatchs operations to the configured concurrency limit. */\r\n    async dispatch() {\r\n        if (this.running || this.awaiters.length === 0) {\r\n            return;\r\n        }\r\n        const awaiter = this.awaiters.shift();\r\n        this.running = true;\r\n        try {\r\n            awaiter.resolve(await awaiter.func());\r\n            setTimeout(() => {\r\n                this.running = false;\r\n                this.dispatch();\r\n            }, 0);\r\n        }\r\n        catch (error) {\r\n            awaiter.reject(error);\r\n            setTimeout(() => {\r\n                this.running = false;\r\n                this.dispatch();\r\n            }, 0);\r\n        }\r\n    }\r\n}\r\n// -------------------------------------------------------------------------\r\n//\r\n// ReaderAsyncIterator\r\n//\r\n// A specialized async iterator implementation specific to the Reader.\r\n// This iterator will iterator so long as the 'next' value given from\r\n// the Reader is not `null`.\r\n//\r\n// -------------------------------------------------------------------------\r\nclass ReaderAsyncIterator {\r\n    constructor(reader) {\r\n        this.reader = reader;\r\n    }\r\n    async next() {\r\n        const next = await this.reader.read();\r\n        if (next === null) {\r\n            const done = true;\r\n            const value = null;\r\n            return { done, value };\r\n        }\r\n        const done = false;\r\n        const value = next;\r\n        return { done, value };\r\n    }\r\n}\r\nexports.ReaderAsyncIterator = ReaderAsyncIterator;\r\nclass Reader {\r\n    constructor() {\r\n        this.deferreds = [];\r\n        this.values = [];\r\n        this.ended = false;\r\n    }\r\n    [Symbol.asyncIterator]() {\r\n        return new ReaderAsyncIterator(this);\r\n    }\r\n    resolve() {\r\n        if (this.values.length > 0 && this.deferreds.length > 0) {\r\n            const deferred = this.deferreds.shift();\r\n            const value = this.values.shift();\r\n            if (value !== null && value.record === null) {\r\n                this.ended = true;\r\n            }\r\n            return (value.error)\r\n                ? deferred.reject(value.error)\r\n                : deferred.resolve(value.record);\r\n        }\r\n    }\r\n    write(record) {\r\n        this.values.push({ record });\r\n        this.resolve();\r\n    }\r\n    error(error) {\r\n        this.values.push({ error });\r\n        this.resolve();\r\n    }\r\n    read() {\r\n        if (this.ended) {\r\n            return Promise.resolve(null);\r\n        }\r\n        const promise = new Promise((resolve, reject) => {\r\n            this.deferreds.push({ resolve, reject });\r\n        });\r\n        this.resolve();\r\n        return promise;\r\n    }\r\n}\r\nexports.Reader = Reader;\r\n/**\r\n* An IndexedDB database abstraction that provides a promise based read and\r\n* write interface over a IndexedDB database. Provides functionality to open and\r\n* close IDB stores, lookup store names, get and scan over object stores and run\r\n* transactional updates.\r\n*/\r\nclass IDBDriver {\r\n    constructor(database) {\r\n        this.database = database;\r\n        this.semaphore = new Semaphore();\r\n    }\r\n    // #region Version Increments\r\n    /** (mutable-database) Adds these stores to this database. Will increment the database on version change. */\r\n    add(storeKeys) {\r\n        return this.semaphore.run(async () => {\r\n            for (const storeKey of storeKeys) {\r\n                const name = this.database.name;\r\n                const version = this.database.version;\r\n                if (!this.stores().includes(storeKey)) {\r\n                    this.database.close();\r\n                    this.database = await IDBDriver.open(name, {\r\n                        version: version + 1,\r\n                        additions: [storeKey],\r\n                        removals: []\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /** (mutable-database) Removes these stores to this database. Will increment the database on version change. */\r\n    remove(storeKeys) {\r\n        return this.semaphore.run(async () => {\r\n            for (const storeKey of storeKeys) {\r\n                const name = this.database.name;\r\n                const version = this.database.version;\r\n                if (this.stores().includes(storeKey)) {\r\n                    this.database.close();\r\n                    this.database = await IDBDriver.open(name, {\r\n                        version: version + 1,\r\n                        additions: [],\r\n                        removals: [storeKey]\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n    // #region Get, Count and Read\r\n    /** Returns the name of this database. */\r\n    name() {\r\n        return this.database.name;\r\n    }\r\n    /** Returns the version of this database. */\r\n    version() {\r\n        return this.database.version;\r\n    }\r\n    /** Returns store names for this database. */\r\n    stores() {\r\n        const stores = [];\r\n        for (let i = 0; i < this.database.objectStoreNames.length; i++) {\r\n            stores.push(this.database.objectStoreNames[i]);\r\n        }\r\n        return stores;\r\n    }\r\n    /** Gets a store record with with the given recordKey. */\r\n    get(storeKey, recordKey) {\r\n        return this.semaphore.run(() => new Promise((resolve, reject) => {\r\n            const transaction = this.database.transaction([storeKey], 'readonly');\r\n            const store = transaction.objectStore(storeKey);\r\n            const request = store.get(recordKey);\r\n            request.addEventListener(\"success\", () => resolve(request.result));\r\n            request.addEventListener(\"error\", () => reject(request.error));\r\n        }));\r\n    }\r\n    /** Counts records in the given store. */\r\n    count(storeKey) {\r\n        return this.semaphore.run(() => new Promise((resolve, reject) => {\r\n            const transaction = this.database.transaction([storeKey], 'readonly');\r\n            const store = transaction.objectStore(storeKey);\r\n            const request = store.count();\r\n            request.addEventListener(\"success\", () => resolve(request.result));\r\n            request.addEventListener(\"error\", () => reject(request.error));\r\n        }));\r\n    }\r\n    /** Reads store records. The will read until 'null' as last record. */\r\n    read(storeKey) {\r\n        const reader = new Reader();\r\n        const transaction = this.database.transaction([storeKey], 'readonly');\r\n        transaction.addEventListener(\"error\", () => reader.error(transaction.error));\r\n        transaction.addEventListener(\"complete\", () => reader.write(null));\r\n        const store = transaction.objectStore(storeKey);\r\n        const request = store.openCursor();\r\n        request.addEventListener(\"error\", () => reader.error(request.error));\r\n        request.addEventListener(\"success\", (event) => {\r\n            const cursor = event.target.result;\r\n            if (cursor) {\r\n                reader.write(cursor.value);\r\n                cursor.continue();\r\n            }\r\n        });\r\n        return reader;\r\n    }\r\n    // #region Transactions\r\n    /** Applies an store update against the given transaction. */\r\n    transactUpdateRecordCursors(transaction, storeKey, records) {\r\n        return new Promise((resolve, reject) => {\r\n            const store = transaction.objectStore(storeKey);\r\n            const request = store.openCursor();\r\n            request.addEventListener(\"error\", () => reject(transaction.error));\r\n            request.addEventListener(\"success\", (event) => {\r\n                const cursor = event.target.result;\r\n                if (cursor === null) {\r\n                    resolve();\r\n                    return;\r\n                }\r\n                for (const record of records) {\r\n                    if (record.key === cursor.key) {\r\n                        cursor.update(record);\r\n                        cursor.continue();\r\n                        return;\r\n                    }\r\n                }\r\n                cursor.continue();\r\n            });\r\n        });\r\n    }\r\n    /** Updates records with the given transaction. */\r\n    transactUpdateRecords(transaction, updates) {\r\n        return Promise.all([...updates.keys()].map(storeKey => {\r\n            const records = updates.get(storeKey);\r\n            return this.transactUpdateRecordCursors(transaction, storeKey, records);\r\n        }));\r\n    }\r\n    /** Inserts the given records with the given transaction. */\r\n    transactInsertRecords(transaction, inserts) {\r\n        for (const storeKey of inserts.keys()) {\r\n            const store = transaction.objectStore(storeKey);\r\n            const records = inserts.get(storeKey);\r\n            records.forEach(record => store.add(record));\r\n        }\r\n    }\r\n    /** Deletes the given records with the given transaction. */\r\n    transactDeleteRecords(transaction, deletes) {\r\n        for (const storeKey of deletes.keys()) {\r\n            const store = transaction.objectStore(storeKey);\r\n            const records = deletes.get(storeKey);\r\n            records.forEach(record => store.delete(record.key));\r\n        }\r\n    }\r\n    /** Executes inserts | updates and deletes as a single operation. */\r\n    transact(transact) {\r\n        return this.semaphore.run(() => new Promise(async (resolve, reject) => {\r\n            // select storeKeys distinct\r\n            const storeKeys = [\r\n                ...transact.inserts.keys(),\r\n                ...transact.deletes.keys(),\r\n                ...transact.updates.keys()\r\n            ].filter((value, index, result) => result.indexOf(value) === index);\r\n            if (storeKeys.length === 0) {\r\n                resolve();\r\n                return;\r\n            }\r\n            // execute transaction across storeKeys\r\n            const transaction = this.database.transaction(storeKeys, 'readwrite');\r\n            transaction.addEventListener(\"error\", (error) => reject(error.target.error));\r\n            transaction.addEventListener(\"complete\", () => resolve());\r\n            if ([...transact.inserts.keys()].length > 0) {\r\n                this.transactInsertRecords(transaction, transact.inserts);\r\n            }\r\n            if ([...transact.updates.keys()].length > 0) {\r\n                await this.transactUpdateRecords(transaction, transact.updates);\r\n            }\r\n            if ([...transact.deletes.keys()].length > 0) {\r\n                this.transactDeleteRecords(transaction, transact.deletes);\r\n            }\r\n        }));\r\n    }\r\n    /** Closes this database. */\r\n    close() {\r\n        this.database.close();\r\n    }\r\n    // #region Statics\r\n    /** Opens this database */\r\n    static open(databaseKey, options = { additions: [], removals: [] }) {\r\n        return new Promise((resolve, reject) => {\r\n            const request = DBFactory().open(databaseKey, options.version);\r\n            request.addEventListener('error', () => reject(request.error));\r\n            request.addEventListener('success', () => resolve(request.result));\r\n            request.addEventListener(\"upgradeneeded\", () => {\r\n                const updated = request.result;\r\n                options.additions.forEach(storeKey => updated.createObjectStore(storeKey, { keyPath: 'key' }));\r\n                options.removals.forEach(storeKey => updated.deleteObjectStore(storeKey));\r\n            });\r\n        });\r\n    }\r\n    /** Connects to an IDB instance. */\r\n    static async connect(databaseKey) {\r\n        const database = await IDBDriver.open(databaseKey);\r\n        return new IDBDriver(database);\r\n    }\r\n    /** Drops this database. */\r\n    static drop(databaseKey) {\r\n        return new Promise((resolve, reject) => {\r\n            const request = DBFactory().deleteDatabase(databaseKey);\r\n            request.addEventListener(\"error\", () => reject(request.error));\r\n            request.addEventListener(\"success\", () => resolve());\r\n        });\r\n    }\r\n}\r\nexports.IDBDriver = IDBDriver;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass FileNotFoundError extends Error {\r\n    constructor(key) {\r\n        super(`File '${key}' not found`);\r\n    }\r\n}\r\nexports.FileNotFoundError = FileNotFoundError;\r\nclass BlobNotFound extends Error {\r\n    constructor(key, blobKey) {\r\n        super(`Blob '${blobKey}' not found for file '${key}'`);\r\n    }\r\n}\r\nexports.BlobNotFound = BlobNotFound;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar page_1 = require(\"./page\");\r\nexports.PageHubServer = page_1.PageHubServer;\r\nvar page_2 = require(\"./page\");\r\nexports.PageHub = page_2.PageHub;\r\nvar network_1 = require(\"./network\");\r\nexports.NetworkHub = network_1.NetworkHub;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-hub\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar server_1 = require(\"./server\");\r\nexports.PageHubServer = server_1.PageHubServer;\r\nvar client_1 = require(\"./client\");\r\nexports.PageHub = client_1.PageHub;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst server_1 = require(\"./server\");\r\nexports.Server = server_1.Server;\r\nconst socket_1 = require(\"./socket\");\r\nexports.Socket = socket_1.Socket;\r\n/** Creates a page socket server. */\r\nfunction createServer(func) {\r\n    return new server_1.Server(func);\r\n}\r\nexports.createServer = createServer;\r\n/** Connects to a page socket server. */\r\nfunction connect(port) {\r\n    return socket_1.Socket.connect(port);\r\n}\r\nexports.connect = connect;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../../../async\");\r\n// --------------------------------------------------------------------------\r\n//\r\n// Bus\r\n//\r\n// Simple messaging back-plane for in-memory socket servers and clients. \r\n// Subscribed on by both sides to faciliate messaging exchange with the\r\n// event 'topic' used as a subscription channel for either side.\r\n//\r\n// --------------------------------------------------------------------------\r\nexports.Bus = new async_1.Events();\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../../../async\");\r\nconst bus_1 = require(\"./bus\");\r\n// --------------------------------------------------------------------------\r\n//\r\n// Socket\r\n//\r\n// A virtual web socket.\r\n//\r\n// --------------------------------------------------------------------------\r\nclass Socket extends async_1.Events {\r\n    constructor(sendFunction, closeFunction) {\r\n        super();\r\n        this.sendFunction = sendFunction;\r\n        this.closeFunction = closeFunction;\r\n        this.disposed = false;\r\n    }\r\n    /** Subscribes to events on this socket once.  */\r\n    once(event, func) {\r\n        super.once(event, func);\r\n    }\r\n    /** Subscribes to events on this socket.  */\r\n    on(event, func) {\r\n        super.on(event, func);\r\n    }\r\n    /** Sends a message to this socket.  */\r\n    send(data) {\r\n        if (this.disposed) {\r\n            throw Error('cannot send to disposed socket.');\r\n        }\r\n        this.sendFunction(data);\r\n    }\r\n    /** Closes this socket. */\r\n    close() {\r\n        this.dispose();\r\n    }\r\n    /** Disposes of this socket. */\r\n    dispose() {\r\n        if (!this.disposed) {\r\n            this.disposed = true;\r\n            this.closeFunction();\r\n            super.dispose();\r\n        }\r\n    }\r\n    /** Connects to a virtualized socket server on the given port. */\r\n    static connect(port) {\r\n        let channel;\r\n        // Create outbound socket to server. Note that the\r\n        // `channel` will be `undefined` until such time as\r\n        // the client has successfully connected.\r\n        const socket = new Socket((message) => setTimeout(() => {\r\n            bus_1.Bus.emit(`${port}:${channel}:server:message`, message);\r\n        }, 0), () => setTimeout(() => {\r\n            bus_1.Bus.emit(`${port}:${channel}:server:close`);\r\n            socket.dispose();\r\n        }, 0));\r\n        // Sets up a timeout to handle connection attempts to\r\n        // non responding ports. This timeout is cleared on\r\n        // server response.\r\n        const timeout = setTimeout(() => {\r\n            socket.emit('error', new Error('socket connect timeout'));\r\n            socket.emit('close');\r\n            socket.dispose();\r\n        }, 100);\r\n        // Create outbound socket to server. Note that the\r\n        // `channel` will be `undefined` until such time as\r\n        // the client has successfully connected.\r\n        setTimeout(() => {\r\n            bus_1.Bus.emit(`${port}:server:connect`);\r\n            bus_1.Bus.once(`${port}:client:connect`, (ch) => {\r\n                channel = ch;\r\n                clearTimeout(timeout);\r\n                // Emit messages received over this bus channel to\r\n                // the socket. Closed messages result in the termination\r\n                // of this socket.\r\n                bus_1.Bus.on(`${port}:${channel}:client:message`, (data) => {\r\n                    socket.emit('message', { data });\r\n                });\r\n                bus_1.Bus.on(`${port}:${channel}:client:close`, () => {\r\n                    socket.emit('close');\r\n                    socket.dispose();\r\n                });\r\n                // Emit 'emit'\r\n                socket.emit('open');\r\n            });\r\n        });\r\n        return socket;\r\n    }\r\n}\r\nexports.Socket = Socket;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar network_1 = require(\"./network\");\r\nexports.Network = network_1.Network;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst socket_1 = require(\"./socket\");\r\n/**\r\n * A network socket server. Accepts incoming sockets from remote peers and\r\n * dispatches the incoming socket to a listen function. This server is\r\n * designed to function like a nodejs web socket server.\r\n */\r\nclass SocketServer {\r\n    constructor(net, func) {\r\n        this.net = net;\r\n        this.func = func;\r\n        this.listening = false;\r\n        this.disposed = false;\r\n    }\r\n    /** Starts this server listening on the given port.  */\r\n    listen(port) {\r\n        this.port = port.toString();\r\n        this.net.bindPort(this.port, channel => this.onChannel(channel));\r\n        this.listening = true;\r\n        return this;\r\n    }\r\n    /** Disposes of this server and unbinds its port. */\r\n    dispose() {\r\n        if (!this.disposed && this.listening) {\r\n            this.net.unbindPort(this.port);\r\n            this.disposed = true;\r\n        }\r\n    }\r\n    /** Accepts incoming channels sent from the network. */\r\n    async onChannel(event) {\r\n        const [peer, channel] = event;\r\n        return this.func(await socket_1.Socket.fromChannel(peer.connection, channel, peer.local, peer.remote));\r\n    }\r\n}\r\nexports.SocketServer = SocketServer;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar rest_1 = require(\"./rest\");\r\nexports.Rest = rest_1.Rest;\r\nvar fetch_1 = require(\"./fetch\");\r\nexports.Fetch = fetch_1.Fetch;\r\nexports.FetchRequest = fetch_1.FetchRequest;\r\nexports.FetchResponse = fetch_1.FetchResponse;\r\nvar server_1 = require(\"./server\");\r\nexports.Router = server_1.Router;\r\nexports.Route = server_1.Route;\r\nvar server_2 = require(\"./server\");\r\nexports.RestServer = server_2.RestServer;\r\nexports.RestRequest = server_2.RestRequest;\r\nexports.RestResponse = server_2.RestResponse;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst querystring_1 = require(\"../../querystring\");\r\nconst url_1 = require(\"../../url\");\r\nconst middleware_1 = require(\"./middleware\");\r\nconst pattern_1 = require(\"./pattern\");\r\n/**\r\n * A route type to service a single request endpoint.\r\n */\r\nclass Route {\r\n    constructor(method, pattern, middleware, handler) {\r\n        this.method = method;\r\n        this.pattern = pattern;\r\n        this.middleware = middleware;\r\n        this.handler = handler;\r\n    }\r\n    /** Runs this route. */\r\n    handle(request, response, next) {\r\n        const url = url_1.Url.parse(request.url);\r\n        const params = this.pattern.match(url.pathname);\r\n        if (params && request.method === this.method) {\r\n            request.params = params;\r\n            request.path = url.path;\r\n            request.query = querystring_1.QueryString.parse(request.url);\r\n            return middleware_1.runStack([...this.middleware], request, response, () => {\r\n                return this.handler(request, response);\r\n            });\r\n        }\r\n        next();\r\n    }\r\n}\r\nexports.Route = Route;\r\n/**\r\n * A REST router type. Allows for registering patterned REST endpoints. This\r\n * type is designed to mirror the functionality of the nodejs express router.\r\n * The RestServer is a subclass of this router.\r\n */\r\nclass Router {\r\n    constructor() {\r\n        this.middleware = [];\r\n    }\r\n    get(...args) {\r\n        return this.method.apply(this, ['get', ...args]);\r\n    }\r\n    post(...args) {\r\n        return this.method.apply(this, ['post', ...args]);\r\n    }\r\n    put(...args) {\r\n        return this.method.apply(this, ['put', ...args]);\r\n    }\r\n    patch(...args) {\r\n        return this.method.apply(this, ['patch', ...args]);\r\n    }\r\n    delete(...args) {\r\n        return this.method.apply(this, ['delete', ...args]);\r\n    }\r\n    method(...args) {\r\n        if (args.length === 4) {\r\n            const [method, endpoint, middleware, func] = args;\r\n            const resolved = middleware.map((m) => middleware_1.asMiddleware(m));\r\n            return this.use(new Route(method, new pattern_1.Pattern(endpoint), resolved, func));\r\n        }\r\n        else if (args.length === 3) {\r\n            const [method, endpoint, func] = args;\r\n            return this.use(new Route(method, new pattern_1.Pattern(endpoint), [], func));\r\n        }\r\n        throw Error('invalid argument');\r\n    }\r\n    /** Adds this middleware to this router.  */\r\n    use(middleware) {\r\n        if (typeof middleware === 'function') {\r\n            const handle = middleware;\r\n            this.middleware.push({ handle });\r\n        }\r\n        else {\r\n            this.middleware.push(middleware);\r\n        }\r\n        return this;\r\n    }\r\n    /** Runs this router as middleware. */\r\n    handle(request, response, next) {\r\n        middleware_1.runStack([...this.middleware], request, response, () => next());\r\n    }\r\n}\r\nexports.Router = Router;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst buffer_1 = require(\"../../buffer\");\r\nconst protocol_1 = require(\"../protocol\");\r\nclass InvalidRequestError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\nexports.InvalidRequestError = InvalidRequestError;\r\nclass ReadRequestError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\nexports.ReadRequestError = ReadRequestError;\r\n/**\r\n * The REST server request type.\r\n */\r\nclass RestRequest {\r\n    constructor(stream, header) {\r\n        this.stream = stream;\r\n        this.header = header;\r\n        this.local = this.stream.socket.local;\r\n        this.remote = this.stream.socket.remote;\r\n        this.url = header.url;\r\n        this.headers = header.headers;\r\n        this.method = header.method;\r\n        this.path = '';\r\n        this.query = {};\r\n        this.params = {};\r\n    }\r\n    /** Reads the body of this request as a readable stream. */\r\n    readable() {\r\n        return protocol_1.BodyProtocol.readReadable(this.stream);\r\n    }\r\n    /** Reads the body of this request as a buffer. */\r\n    async buffer() {\r\n        const buffers = [];\r\n        for await (const buffer of this.readable()) {\r\n            buffers.push(buffer);\r\n        }\r\n        return buffer_1.Buffer.concat(buffers);\r\n    }\r\n    /** Reads the body of this request as text. */\r\n    async text(encoding) {\r\n        const buffer = await this.buffer();\r\n        return buffer.toString(encoding);\r\n    }\r\n    /** Reads the body of this request as a JSON object. */\r\n    async json() {\r\n        const buffer = await this.buffer();\r\n        return JSON.parse(buffer.toString('utf-8'));\r\n    }\r\n}\r\nexports.RestRequest = RestRequest;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst buffer_1 = require(\"../../buffer\");\r\nconst streams_1 = require(\"../../streams\");\r\nconst protocol_1 = require(\"../protocol\");\r\n/**\r\n * A MediaStream context type given as a handle when sending mediastreams as\r\n * responses. It handles pulsing the messages down the receiver which keeps\r\n * the mediastream pipe open. Callers can call the dispose() method to terminate\r\n * outbound streams.\r\n */\r\nclass MediaStreamContext {\r\n    constructor(stream) {\r\n        this.stream = stream;\r\n        this.streaming = true;\r\n        this.transmit();\r\n    }\r\n    /** Disposes of this mediastream. */\r\n    dispose() {\r\n        this.streaming = false;\r\n    }\r\n    async delay(ms) {\r\n        return new Promise(resolve => setTimeout(resolve, ms));\r\n    }\r\n    async transmit() {\r\n        while (this.streaming) {\r\n            await this.stream.writable.write(buffer_1.Buffer.from([1]));\r\n            await this.delay(100);\r\n        }\r\n        await this.stream.writable.close();\r\n    }\r\n}\r\nexports.MediaStreamContext = MediaStreamContext;\r\nclass ResponseAlreadySentError extends Error {\r\n    constructor() {\r\n        super('Responses can only be sent once.');\r\n    }\r\n}\r\nexports.ResponseAlreadySentError = ResponseAlreadySentError;\r\n/**\r\n * The REST server response type.\r\n */\r\nclass RestResponse {\r\n    constructor(stream) {\r\n        this.stream = stream;\r\n        /** The headers sent with this request. */\r\n        this.headers = {};\r\n        /** The status code. Use standard HTTP status code. */\r\n        this.status = 200;\r\n        this.sent = false;\r\n    }\r\n    /**\r\n     * Transmits a mediastream on the response. This function returns a context\r\n     * object which can be used to dispose of the outbound mediastream.\r\n     */\r\n    async mediastream(mediastream, status) {\r\n        if (this.sent) {\r\n            throw new ResponseAlreadySentError();\r\n        }\r\n        this.sent = true;\r\n        this.status = status || this.status;\r\n        await protocol_1.HeaderProtocol.writeResponseHeader(this.stream, {\r\n            status: this.status,\r\n            headers: this.headers\r\n        });\r\n        await protocol_1.BodyProtocol.writeMediaStream(this.stream, mediastream);\r\n        return new MediaStreamContext(this.stream);\r\n    }\r\n    /** Streams a readable as the body of the response. */\r\n    async readable(readable, status) {\r\n        if (this.sent) {\r\n            throw new ResponseAlreadySentError();\r\n        }\r\n        this.sent = true;\r\n        this.status = status || this.status;\r\n        await protocol_1.HeaderProtocol.writeResponseHeader(this.stream, {\r\n            status: this.status,\r\n            headers: this.headers\r\n        });\r\n        await protocol_1.BodyProtocol.writeReadable(this.stream, readable);\r\n        await this.stream.writable.close();\r\n    }\r\n    /** Streams a queryable as the body of the response. */\r\n    async query(queryable, status) {\r\n        if (this.sent) {\r\n            throw new ResponseAlreadySentError();\r\n        }\r\n        this.sent = true;\r\n        this.status = status || this.status;\r\n        await protocol_1.HeaderProtocol.writeResponseHeader(this.stream, {\r\n            status: this.status,\r\n            headers: this.headers\r\n        });\r\n        await protocol_1.BodyProtocol.writeQueryable(this.stream, queryable);\r\n        await this.stream.writable.close();\r\n    }\r\n    /** Sends a buffer response. */\r\n    async buffer(buffer, status) {\r\n        const queue = [buffer];\r\n        return this.readable(new streams_1.Readable({\r\n            pull: async (controller) => {\r\n                if (queue.length > 0) {\r\n                    controller.enqueue(queue.shift());\r\n                }\r\n                else {\r\n                    controller.close();\r\n                }\r\n            }\r\n        }), status);\r\n    }\r\n    /** Sends a string or buffer data response. */\r\n    async send(data, status) {\r\n        return this.buffer(buffer_1.Buffer.from(data), status);\r\n    }\r\n    /** Sends a TEXT response with Content-Type 'text/plain' */\r\n    async text(data, status) {\r\n        this.headers['Content-Type'] = 'text/plain';\r\n        return this.buffer(buffer_1.Buffer.from(data), status);\r\n    }\r\n    /** Sends a JSON response with Content-Type 'application/json' */\r\n    async json(data, status) {\r\n        this.headers['Content-Type'] = 'application/json';\r\n        const buffer = buffer_1.Buffer.from(JSON.stringify(data));\r\n        return this.buffer(buffer, status);\r\n    }\r\n}\r\nexports.RestResponse = RestResponse;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar request_1 = require(\"./request\");\r\nexports.FetchRequest = request_1.FetchRequest;\r\nvar response_1 = require(\"./response\");\r\nexports.FetchResponse = response_1.FetchResponse;\r\nvar fetch_1 = require(\"./fetch\");\r\nexports.Fetch = fetch_1.Fetch;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst protocol_1 = require(\"../protocol\");\r\n/**\r\n * The Fetch request type.\r\n */\r\nclass FetchRequest {\r\n    constructor(stream, header, body) {\r\n        this.stream = stream;\r\n        this.header = header;\r\n        this.body = body;\r\n    }\r\n    async getResponse() {\r\n        await protocol_1.HeaderProtocol.writeRequestHeader(this.stream, this.header);\r\n        protocol_1.BodyProtocol.writeReadable(this.stream, this.body, { ignoreError: true });\r\n        return protocol_1.HeaderProtocol.readResponseHeader(this.stream);\r\n    }\r\n}\r\nexports.FetchRequest = FetchRequest;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst buffer_1 = require(\"../../buffer\");\r\nconst protocol_1 = require(\"../protocol\");\r\n/**\r\n * The Fetch response type.\r\n */\r\nclass FetchResponse {\r\n    constructor(stream, response) {\r\n        this.stream = stream;\r\n        this.response = response;\r\n        this.headers = this.response.headers;\r\n        this.status = this.response.status;\r\n    }\r\n    /** Reads the body of this response as a readable. */\r\n    readable() {\r\n        return protocol_1.BodyProtocol.readReadable(this.stream);\r\n    }\r\n    /** Reads the body of this response as a queryable. */\r\n    query() {\r\n        return protocol_1.BodyProtocol.readQueryable(this.stream);\r\n    }\r\n    /** Reads the body of this response as a mediastream. */\r\n    mediastream() {\r\n        return protocol_1.BodyProtocol.readMediaStream(this.stream);\r\n    }\r\n    /** Reads the body of this response as a buffer. */\r\n    async buffer() {\r\n        const buffers = [];\r\n        for await (const buffer of this.readable()) {\r\n            buffers.push(buffer);\r\n        }\r\n        return buffer_1.Buffer.concat(buffers);\r\n    }\r\n    /** Reads the body of this response as a string. */\r\n    async text(encoding) {\r\n        const buffer = await this.buffer();\r\n        return buffer.toString(encoding);\r\n    }\r\n    /** Reads the body of this response as a JSON object. */\r\n    async json() {\r\n        const buffer = await this.buffer();\r\n        return JSON.parse(buffer.toString('utf-8'));\r\n    }\r\n}\r\nexports.FetchResponse = FetchResponse;\r\n","import {Node} from 'smoke-node'\n\nconst node0 = new Node() // 0.0.0.1\n\nconst node1 = new Node() // 0.0.0.2\n\nconst node2 = new Node() // 0.0.0.3\n\n// node0 - The video source.\n\nnode0.rest.createServer().get('/mediastream', (req, res) => {\n\n  console.log('node0')\n  const mediastream = node0.media.createTestPattern()\n\n  res.mediastream(mediastream)\n\n}).listen(80)\n\n// node1 - The video proxy.\n\nconst app1 = node1.rest.createServer()\n\napp1.get('/mediastream', async (req, res) => {\n\n  console.log('node1')\n  const response = await node1.rest.fetch('rest://0.0.0.1/mediastream')\n\n  res.mediastream(await response.mediastream())\n\n}).listen(80)\n\n// node2 - the client\n\n;(async () => {\n\n  console.log('node2')\n  const response = await node2.rest.fetch('rest://0.0.0.2/mediastream')\n\n  const video = document.getElementById('video-0')\n\n  video.srcObject = await response.mediastream()\n\n  video.play()\n\n})()","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * A single channel event emitter. This type supports standard event\r\n * subscription functionality with the ability to queue messages when there are\r\n * no subscribers available to receive.\r\n */\r\nclass Event {\r\n    constructor() {\r\n        this.handlers = [];\r\n        this.messages = [];\r\n    }\r\n    /** Subscribes to an event once. */\r\n    once(func) {\r\n        this.handlers.push({ once: true, func });\r\n        this.dispatch();\r\n    }\r\n    /** Subscribes to an event. */\r\n    on(func) {\r\n        this.handlers.push({ once: false, func });\r\n        this.dispatch();\r\n    }\r\n    /** Unsubscribes this handler. */\r\n    remove(func) {\r\n        this.handlers = this.handlers.filter(handler => handler.func != func);\r\n    }\r\n    /** Emits a message to subscribers. */\r\n    emit(data) {\r\n        this.messages.push(data);\r\n        this.dispatch();\r\n    }\r\n    dispatch() {\r\n        while (this.messages.length > 0 && this.handlers.length > 0) {\r\n            const message = this.messages.shift();\r\n            const onces = this.handlers.filter(listener => listener.once);\r\n            const ons = this.handlers.filter(listener => !listener.once);\r\n            this.handlers = [...ons];\r\n            onces.forEach(listener => listener.func(message));\r\n            ons.forEach(listener => listener.func(message));\r\n        }\r\n    }\r\n    /** Disposes of this object.  */\r\n    dispose() {\r\n        while (this.handlers.length > 0) {\r\n            this.handlers.shift();\r\n        }\r\n        while (this.messages.length > 0) {\r\n            this.messages.shift();\r\n        }\r\n    }\r\n}\r\n/**\r\n * A multi channel event emitter. This type supports standard event\r\n * subscription functionality with the ability to queue messages when there are\r\n * no subscribers available to receive.\r\n */\r\nclass Events {\r\n    constructor() {\r\n        this.events = new Map();\r\n    }\r\n    /** Subscribes to an event once. */\r\n    once(event, func) {\r\n        if (!this.events.has(event)) {\r\n            this.events.set(event, new Event());\r\n        }\r\n        this.events.get(event).once(func);\r\n    }\r\n    /** Subscribes to an event. */\r\n    on(event, func) {\r\n        if (!this.events.has(event)) {\r\n            this.events.set(event, new Event());\r\n        }\r\n        this.events.get(event).on(func);\r\n    }\r\n    /** Removes this event handler. */\r\n    remove(event, func) {\r\n        if (!this.events.has(event)) {\r\n            this.events.set(event, new Event());\r\n        }\r\n        this.events.get(event).remove(func);\r\n    }\r\n    /** Emits an event to subscribers. */\r\n    emit(event, data) {\r\n        if (event === 'error' && !this.events.has(event)) {\r\n            throw data;\r\n        }\r\n        if (!this.events.has(event)) {\r\n            this.events.set(event, new Event());\r\n        }\r\n        this.events.get(event).emit(data);\r\n    }\r\n    /** Disposes of this object. */\r\n    dispose() {\r\n        for (const key of this.events.keys()) {\r\n            const event = this.events.get(key);\r\n            this.events.delete(key);\r\n            event.dispose();\r\n        }\r\n    }\r\n}\r\nexports.Events = Events;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * An asynchronous barrier used to defer operations until a condition is meet.\r\n * This type is primarily  used to allow callers to invoke operations on a\r\n * type without waiting for that type to initialize internally. This type\r\n * provides pause and resume functionality. New instances of this type will\r\n * start in a paused state.\r\n */\r\nclass Barrier {\r\n    constructor() {\r\n        this.awaiters = [];\r\n        this.paused = true;\r\n    }\r\n    /** Pauses this barrier causing operations to wait. */\r\n    pause() {\r\n        this.paused = true;\r\n    }\r\n    /** Resumes this barrier causing all operations to run. */\r\n    resume() {\r\n        this.paused = false;\r\n        this.dispatch();\r\n    }\r\n    /** Schedules the given operation to run when resumed. */\r\n    run(func) {\r\n        return (!this.paused)\r\n            ? Promise.resolve(func())\r\n            : new Promise((resolve, reject) => {\r\n                this.awaiters.push({\r\n                    func: func,\r\n                    resolve,\r\n                    reject\r\n                });\r\n            });\r\n    }\r\n    /** Dispatches all awaiters. Called exclusively by resume() */\r\n    async dispatch() {\r\n        while (this.awaiters.length > 0) {\r\n            const awaiter = this.awaiters.shift();\r\n            Promise.resolve(awaiter.func())\r\n                .then(result => awaiter.resolve(result))\r\n                .catch(error => awaiter.reject(error));\r\n        }\r\n    }\r\n}\r\nexports.Barrier = Barrier;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * An asynchronous semaphore. Provides functionality to limit and sequence\r\n * asynchonous access on a resource.\r\n */\r\nclass Semaphore {\r\n    /** Creates a Semaphore with the given concurrency limit. */\r\n    constructor(concurrency = 1) {\r\n        this.concurrency = concurrency;\r\n        this.awaiters = [];\r\n        this.running = 0;\r\n    }\r\n    /** Schedules this operation to run. */\r\n    run(func) {\r\n        return new Promise((resolve, reject) => {\r\n            this.awaiters.push({ func, resolve, reject });\r\n            this.dispatch();\r\n        });\r\n    }\r\n    /** (async-recursive) Dispatchs operations to the configured concurrency limit. */\r\n    async dispatch() {\r\n        if (this.awaiters.length === 0 || this.running >= this.concurrency) {\r\n            return;\r\n        }\r\n        const awaiter = this.awaiters.shift();\r\n        this.running += 1;\r\n        try {\r\n            awaiter.resolve(await awaiter.func());\r\n            setTimeout(() => {\r\n                this.running -= 1;\r\n                this.dispatch();\r\n            }, 1);\r\n        }\r\n        catch (error) {\r\n            awaiter.reject(error);\r\n            setTimeout(() => {\r\n                this.running -= 1;\r\n                this.dispatch();\r\n            }, 1);\r\n        }\r\n    }\r\n}\r\nexports.Semaphore = Semaphore;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Parses query string parameters from Uniform Resource Locator strings.\r\n */\r\nclass QueryString {\r\n    // Parses query segments from the given string. A segment\r\n    // is denoted as <path>?[a=10&b=20]?[c=10&d]#?e where the\r\n    // path is ignored and hashes terminate.\r\n    static parseQuerySegments(s) {\r\n        const markers = [];\r\n        for (let i = 0; i < s.length; i++) {\r\n            const next = s.charAt(i);\r\n            if (next === '#') {\r\n                break;\r\n            }\r\n            if (next === '?') {\r\n                markers.push(i);\r\n            }\r\n        }\r\n        const segments = [];\r\n        for (let i = 0; i < markers.length; i++) {\r\n            segments.push(s.slice(markers[i] + 1, markers[i + 1]));\r\n        }\r\n        return segments;\r\n    }\r\n    // Parses a segment and returns an array of KeyValue pairs.\r\n    // The 'key' is mandatory but the 'value' may be undefined.\r\n    // This function maps undefined into empty strings.\r\n    static parsePairs(segment) {\r\n        return segment\r\n            .split('&')\r\n            .map(assign => assign.split('='))\r\n            .filter(pair => pair[0] !== '')\r\n            .map(pair => {\r\n            const key = pair[0];\r\n            const value = pair[1] || '';\r\n            return [key, value];\r\n        });\r\n    }\r\n    // Builds an expanded QueryStringResult. This result includes\r\n    // all values found for a given property buffered in a string\r\n    // array. This is to be later collapsed into a reduced form.\r\n    // using various rules.\r\n    static expandResult(pairs) {\r\n        const result = {};\r\n        for (const [key, value] of pairs) {\r\n            if (result[key] === undefined) {\r\n                result[key] = [];\r\n            }\r\n            result[key] = [...result[key], value];\r\n        }\r\n        return result;\r\n    }\r\n    // Collapses an expaned QueryStringResult. This function will filter each\r\n    // keys values as distinct, then collapse the values down to a 'string'\r\n    // if the distinct array has only 1 element.\r\n    static collapseResult(result) {\r\n        for (const key of Object.keys(result)) {\r\n            let array = result[key];\r\n            array = array.filter((value, index, result) => result.indexOf(value) === index);\r\n            if (array.length > 1) {\r\n                array = array.filter(value => value.length > 0);\r\n            }\r\n            if (array.length === 1) {\r\n                result[key] = array[0];\r\n            }\r\n            else {\r\n                result[key] = array;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /** Parses the given url for its query paramters. */\r\n    static parse(url) {\r\n        const queries = this.parseQuerySegments(url);\r\n        const pairs = queries\r\n            .map(seg => this.parsePairs(seg))\r\n            .flatMap(pair => pair);\r\n        const expanded = this.expandResult(pairs);\r\n        return this.collapseResult(expanded);\r\n    }\r\n}\r\nexports.QueryString = QueryString;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar path_1 = require(\"./path\");\r\nexports.Path = path_1.Path;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nCopyright Joyent, Inc. and other Node contributors. (derived work)\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Provides nodejs path resolution services. This class was lifted from nodejs\r\n * to allow for path resolution primarily on smokes file system. Can be used\r\n * for general pathing.\r\n */\r\nclass Path {\r\n    /** Returns the basename of the given path. */\r\n    static basename(path, ext) {\r\n        var f = this.posixSplitPath(path)[2];\r\n        if (ext && f.substr(-1 * ext.length) === ext) {\r\n            f = f.substr(0, f.length - ext.length);\r\n        }\r\n        return f;\r\n    }\r\n    /** Returns the directory path of the given path. */\r\n    static dirname(path) {\r\n        const result = this.posixSplitPath(path);\r\n        const root = result[0];\r\n        let dir = result[1];\r\n        if (!root && !dir) {\r\n            return '.';\r\n        }\r\n        if (dir) {\r\n            dir = dir.substr(0, dir.length - 1);\r\n        }\r\n        return root + dir;\r\n    }\r\n    /** Returns the file extension of the the given path. */\r\n    static extname(path) {\r\n        return this.posixSplitPath(path)[3];\r\n    }\r\n    /** Formats the given PathObject into a path string. */\r\n    static format(pathObject) {\r\n        if (typeof pathObject !== 'object') {\r\n            throw new TypeError(`Parameter 'pathObject' must be an object, not ${typeof pathObject}`);\r\n        }\r\n        const root = pathObject.root || '';\r\n        if (typeof root !== 'string') {\r\n            throw new TypeError(`'pathObject.root' must be a string or undefined, not ${typeof pathObject.root}`);\r\n        }\r\n        const dir = pathObject.dir ? pathObject.dir + this.sep : '';\r\n        const base = pathObject.base || '';\r\n        return dir + base;\r\n    }\r\n    /** Tests if the given path is absolute. */\r\n    static isAbsolute(path) {\r\n        return path.charAt(0) === '/';\r\n    }\r\n    /** Joins the given path parameters. */\r\n    static join(...paths) {\r\n        let path = '';\r\n        for (let i = 0; i < paths.length; i++) {\r\n            const segment = paths[i];\r\n            if (typeof segment !== 'string') {\r\n                throw new TypeError('Arguments to path.join must be strings');\r\n            }\r\n            if (segment) {\r\n                if (!path) {\r\n                    path += segment;\r\n                }\r\n                else {\r\n                    path += '/' + segment;\r\n                }\r\n            }\r\n        }\r\n        return this.normalize(path);\r\n    }\r\n    /** Normalizes the given path. */\r\n    static normalize(path) {\r\n        const isAbsolute = this.isAbsolute(path);\r\n        const trailingSlash = path && path[path.length - 1] === '/';\r\n        path = this.normalizeArray(path.split('/'), !isAbsolute).join('/');\r\n        if (!path && !isAbsolute) {\r\n            path = '.';\r\n        }\r\n        if (path && trailingSlash) {\r\n            path += '/';\r\n        }\r\n        return (isAbsolute ? '/' : '') + path;\r\n    }\r\n    /** Parses the given path into a PathObject. */\r\n    static parse(path) {\r\n        if (typeof path !== 'string') {\r\n            throw new TypeError(`Parameter 'pathString' must be a string, not ${typeof path}`);\r\n        }\r\n        let parts = this.posixSplitPath(path);\r\n        if (!parts || parts.length !== 4) {\r\n            throw new TypeError(`Invalid path '${path}'`);\r\n        }\r\n        parts[1] = parts[1] || '';\r\n        parts[2] = parts[2] || '';\r\n        parts[3] = parts[3] || '';\r\n        return {\r\n            root: parts[0],\r\n            dir: parts[0] + parts[1].slice(0, -1),\r\n            base: parts[2],\r\n            ext: parts[3],\r\n            name: parts[2].slice(0, parts[2].length - parts[3].length)\r\n        };\r\n    }\r\n    /** Solves the relative path for the given 'from' and 'to' paths. */\r\n    static relative(from, to) {\r\n        from = this.resolve(from).substr(1);\r\n        to = this.resolve(to).substr(1);\r\n        const fromParts = this.trimArray(from.split('/'));\r\n        const toParts = this.trimArray(to.split('/'));\r\n        const length = Math.min(fromParts.length, toParts.length);\r\n        let samePartsLength = length;\r\n        for (let i = 0; i < length; i++) {\r\n            if (fromParts[i] !== toParts[i]) {\r\n                samePartsLength = i;\r\n                break;\r\n            }\r\n        }\r\n        let outputParts = [];\r\n        for (let i = samePartsLength; i < fromParts.length; i++) {\r\n            outputParts.push('..');\r\n        }\r\n        outputParts = outputParts.concat(toParts.slice(samePartsLength));\r\n        return outputParts.join('/');\r\n    }\r\n    /** Resolves the given paths. */\r\n    static resolve(...paths) {\r\n        let resolvedPath = '';\r\n        let resolvedAbsolute = false;\r\n        for (let i = paths.length - 1; i >= -1 && !resolvedAbsolute; i--) {\r\n            let path = i >= 0 ? paths[i] : this.cwd;\r\n            // Skip empty and invalid entries\r\n            if (typeof path !== 'string') {\r\n                throw new TypeError('Arguments to path.resolve must be strings');\r\n            }\r\n            else if (!path) {\r\n                continue;\r\n            }\r\n            resolvedPath = path + '/' + resolvedPath;\r\n            resolvedAbsolute = path[0] === '/';\r\n        }\r\n        // At this point the path should be resolved to a full absolute path, but\r\n        // handle relative paths to be safe (might happen when process.cwd() fails)\r\n        // Normalize the path\r\n        resolvedPath = this.normalizeArray(resolvedPath.split('/'), !resolvedAbsolute).join('/');\r\n        return (resolvedAbsolute ? '/' : '') + resolvedPath || '.';\r\n    }\r\n    // #region utility\r\n    /** Splits the given path. */\r\n    static posixSplitPath(path) {\r\n        return this.splitPathPattern.exec(path).slice(1);\r\n    }\r\n    // resolves . and .. elements in a path array with directory names there\r\n    // must be no slashes or device names (c:\\) in the array\r\n    // (so also no leading and trailing slashes - it does not distinguish\r\n    // relative and absolute paths)\r\n    static normalizeArray(parts, allowAboveRoot) {\r\n        const res = [];\r\n        for (let i = 0; i < parts.length; i++) {\r\n            const p = parts[i];\r\n            if (!p || p === '.') {\r\n                continue;\r\n            }\r\n            if (p === '..') {\r\n                if (res.length && res[res.length - 1] !== '..') {\r\n                    res.pop();\r\n                }\r\n                else if (allowAboveRoot) {\r\n                    res.push('..');\r\n                }\r\n            }\r\n            else {\r\n                res.push(p);\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n    // returns an array with empty elements removed from either end of the input\r\n    // array or the original array if no elements need to be removed\r\n    static trimArray(array) {\r\n        const lastIndex = array.length - 1;\r\n        let start = 0;\r\n        for (; start <= lastIndex; start++) {\r\n            if (array[start])\r\n                break;\r\n        }\r\n        let end = lastIndex;\r\n        for (; end >= 0; end--) {\r\n            if (array[end])\r\n                break;\r\n        }\r\n        if (start === 0 && end === lastIndex) {\r\n            return array;\r\n        }\r\n        if (start > end) {\r\n            return [];\r\n        }\r\n        return array.slice(start, end + 1);\r\n    }\r\n}\r\nPath.splitPathPattern = /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\r\n// #region node path API\r\n/** file path seperator. */\r\nPath.sep = '/';\r\n/** file path delimitor. */\r\nPath.delimiter = ':';\r\n/** The current working directory. */\r\nPath.cwd = '/';\r\nexports.Path = Path;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Url parsing utility. Allows for arbituary protocols to be\r\n * parsed into standard URLObject types.\r\n */\r\nclass Url {\r\n    /** Parses the `protocol` from this `href`. Throws if error. */\r\n    static parseProtocol(href) {\r\n        for (let i = 0; i < href.length; i++) {\r\n            if (href.charAt(i) === ':') {\r\n                const next0 = href.charAt(i + 1);\r\n                const next1 = href.charAt(i + 2);\r\n                if (next0 === '/' && next1 === '/') {\r\n                    return [href.slice(0, i + 1), href.slice(i + 3)];\r\n                }\r\n            }\r\n        }\r\n        return [null, href];\r\n    }\r\n    /** Parses the `auth` from `protocol` remainder. Returns `null` on not found. */\r\n    static parseAuth(s) {\r\n        for (let i = 0; i < s.length; i++) {\r\n            if (s.charAt(i) === '/') {\r\n                return [null, s];\r\n            }\r\n            if (s.charAt(i) === '@') {\r\n                return [s.slice(0, i), s.slice(i + 1)];\r\n            }\r\n        }\r\n        return [null, s];\r\n    }\r\n    /** Parses the `hostname`. Terminates at `/` | `?` | `#` */\r\n    static parseHostname(s) {\r\n        for (let i = 0; i < s.length; i++) {\r\n            const next = s.charAt(i);\r\n            if (next === '/' || next === '?' || next === '#') {\r\n                return [s.slice(0, i), s.slice(i)];\r\n            }\r\n        }\r\n        return [s, ''];\r\n    }\r\n    /** Parses the `host` form the `hostname`. */\r\n    static parseHost(hostname) {\r\n        for (let i = 0; i < hostname.length; i++) {\r\n            const next = hostname.charAt(i);\r\n            if (next === ':') {\r\n                return [hostname.slice(0, i), hostname.slice(i)];\r\n            }\r\n        }\r\n        return [hostname, ''];\r\n    }\r\n    /** Parses the `port` form the `hostname`. Returns `null` on not found. */\r\n    static parsePort(hostname) {\r\n        for (let i = 0; i < hostname.length; i++) {\r\n            if (hostname.charAt(i) === ':') {\r\n                return [hostname.slice(i + 1), ''];\r\n            }\r\n        }\r\n        return [null, hostname];\r\n    }\r\n    /** Parses the `path` component. Adds forward '/' on path if non found. */\r\n    static parsePath(s) {\r\n        if (s.length === 0) {\r\n            return ['/', ''];\r\n        }\r\n        return [s, ''];\r\n    }\r\n    /** Parses the `pathname` from the `path` component.*/\r\n    static parsePathname(path) {\r\n        for (let i = 0; i < path.length; i++) {\r\n            const next = path.charAt(i);\r\n            if (next === '?' || next === '#') {\r\n                return [path.slice(0, i), path.slice(i)];\r\n            }\r\n        }\r\n        return [path, ''];\r\n    }\r\n    /**\r\n     * Parses the `hash` from the `path` component. Returns left side as\r\n     * remainder as `hash` can only be at the end of the href and `hash`\r\n     * will consume all things to the right, including `search`\r\n     */\r\n    static parseHash(path) {\r\n        for (let i = 0; i < path.length; i++) {\r\n            const next = path.charAt(i);\r\n            if (next === '#') {\r\n                return [path.slice(i), path.slice(0, i)];\r\n            }\r\n        }\r\n        return [null, path];\r\n    }\r\n    /** Parses the `search` from this path. */\r\n    static parseSearch(path) {\r\n        for (let i = 0; i < path.length; i++) {\r\n            const next = path.charAt(i);\r\n            if (next === '?') {\r\n                return [path.slice(i), path.slice(0, i)];\r\n            }\r\n        }\r\n        return ['', path];\r\n    }\r\n    /** Parses the `query` from this `search`. */\r\n    static parseQuery(search) {\r\n        for (let i = 0; i < search.length; i++) {\r\n            const next = search.charAt(i);\r\n            if (next === '?') {\r\n                return [search.slice(i + 1), search.slice(0, i)];\r\n            }\r\n        }\r\n        return ['', search];\r\n    }\r\n    /** Parses this `href` as a UrlObject. Will throw on error. */\r\n    static parse(href) {\r\n        const [protocol, r0] = this.parseProtocol(href);\r\n        if (protocol) {\r\n            const [auth, r1] = this.parseAuth(r0);\r\n            const [hostname, r2] = this.parseHostname(r1);\r\n            const [host, r3] = this.parseHost(hostname);\r\n            const [port, r4] = this.parsePort(hostname);\r\n            const [path, r5] = this.parsePath(r2);\r\n            const [pathname, r6] = this.parsePathname(path);\r\n            const [hash, r7] = this.parseHash(path);\r\n            const [search, r8] = this.parseSearch(r7); // left side of hash\r\n            const [query, r9] = this.parseQuery(search);\r\n            return { protocol, auth, hash, host, hostname, href, path, pathname, port, query, search };\r\n        }\r\n        else {\r\n            const auth = null;\r\n            const hostname = null;\r\n            const host = null;\r\n            const port = null;\r\n            const [path, r5] = this.parsePath(r0);\r\n            const [pathname, r6] = this.parsePathname(path);\r\n            const [hash, r7] = this.parseHash(path);\r\n            const [search, r8] = this.parseSearch(r7); // left side of hash\r\n            const [query, r9] = this.parseQuery(search);\r\n            return { protocol, auth, hash, host, hostname, href, path, pathname, port, query, search };\r\n        }\r\n    }\r\n}\r\nexports.Url = Url;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019\r\n- Feross Aboukhadijeh <https://feross.org> - Original Work\r\n- Haydn Paterson (sinclair) <haydn.developer@gmail.com> - TypeScript Port\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst ieee754 = require(\"./ieee754\");\r\nconst base64 = require(\"./base64\");\r\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with the\r\n// lowest limit is Chrome, with 0x10000 args. We go 1 magnitude less, for\r\n// safety\r\nconst MAX_ARGUMENTS_LENGTH = 0x1000;\r\nconst INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g;\r\nconst INSPECT_MAX_BYTES = 50;\r\nconst K_MAX_LENGTH = 0x7fffffff;\r\n/**\r\n * A Buffer implementation mirrors the Buffer type from NodeJS. Provides buffer\r\n * read/write functionality for native numeric types, slicing and concat as\r\n * well as text encoding functionality. Ported from to TypeScript from\r\n * https://github.com/feross/buffer.\r\n */\r\nclass Buffer extends Uint8Array {\r\n    // #region swap\r\n    static swap(buf, n, m) {\r\n        const i = buf[n];\r\n        buf[n] = buf[m];\r\n        buf[m] = i;\r\n    }\r\n    swap16() {\r\n        const len = this.length;\r\n        if (len % 2 !== 0) {\r\n            throw new RangeError('Buffer size must be a multiple of 16-bits');\r\n        }\r\n        for (let i = 0; i < len; i += 2) {\r\n            Buffer.swap(this, i, i + 1);\r\n        }\r\n        return this;\r\n    }\r\n    swap32() {\r\n        const len = this.length;\r\n        if (len % 4 !== 0) {\r\n            throw new RangeError('Buffer size must be a multiple of 32-bits');\r\n        }\r\n        for (let i = 0; i < len; i += 4) {\r\n            Buffer.swap(this, i, i + 3);\r\n            Buffer.swap(this, i + 1, i + 2);\r\n        }\r\n        return this;\r\n    }\r\n    swap64() {\r\n        const len = this.length;\r\n        if (len % 8 !== 0) {\r\n            throw new RangeError('Buffer size must be a multiple of 64-bits');\r\n        }\r\n        for (let i = 0; i < len; i += 8) {\r\n            Buffer.swap(this, i, i + 7);\r\n            Buffer.swap(this, i + 1, i + 6);\r\n            Buffer.swap(this, i + 2, i + 5);\r\n            Buffer.swap(this, i + 3, i + 4);\r\n        }\r\n        return this;\r\n    }\r\n    // #region toString\r\n    slowToString(...args) {\r\n        let loweredCase = false;\r\n        // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\r\n        // property of a typed array.\r\n        // This behaves neither like String nor Uint8Array in that we set start/end\r\n        // to their upper/lower bounds if the value passed is out of range.\r\n        // undefined is handled specially as per ECMA-262 6th Edition,\r\n        // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\r\n        if (args[1] === undefined || args[1] < 0) {\r\n            args[1] = 0;\r\n        }\r\n        // Return early if start > this.length. Done here to prevent potential uint32\r\n        // coercion fail below.\r\n        if (args[1] > this.length) {\r\n            return '';\r\n        }\r\n        if (args[2] === undefined || args[2] > this.length) {\r\n            args[2] = this.length;\r\n        }\r\n        if (args[2] <= 0) {\r\n            return '';\r\n        }\r\n        // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\r\n        args[2] >>>= 0;\r\n        args[1] >>>= 0;\r\n        if (args[2] <= args[1]) {\r\n            return '';\r\n        }\r\n        if (!args[0]) {\r\n            args[0] = 'utf8';\r\n        }\r\n        while (true) {\r\n            switch (args[0]) {\r\n                case 'hex':\r\n                    return Buffer.hexSlice(this, args[1], args[2]);\r\n                case 'utf8':\r\n                case 'utf-8':\r\n                    return Buffer.utf8Slice(this, args[1], args[2]);\r\n                case 'ascii':\r\n                    return Buffer.asciiSlice(this, args[1], args[2]);\r\n                case 'latin1':\r\n                case 'binary':\r\n                    return Buffer.latin1Slice(this, args[1], args[2]);\r\n                case 'base64':\r\n                    return Buffer.base64Slice(this, args[1], args[2]);\r\n                case 'ucs2':\r\n                case 'ucs-2':\r\n                case 'utf16le':\r\n                case 'utf-16le':\r\n                    return Buffer.utf16leSlice(this, args[1], args[2]);\r\n                default:\r\n                    if (loweredCase) {\r\n                        throw new TypeError('Unknown encoding: ' + args[0]);\r\n                    }\r\n                    args[0] = (args[0] + '').toLowerCase();\r\n                    loweredCase = true;\r\n            }\r\n        }\r\n    }\r\n    toString(...args) {\r\n        const length = this.length;\r\n        if (length === 0) {\r\n            return '';\r\n        }\r\n        else if (args.length === 0) {\r\n            return Buffer.utf8Slice(this, 0, length);\r\n        }\r\n        else {\r\n            return this.slowToString(...args);\r\n        }\r\n    }\r\n    toLocaleString(...args) {\r\n        return this.toString(...args);\r\n    }\r\n    // #region equals\r\n    equals(buf) {\r\n        if (!Buffer.isBuffer(buf)) {\r\n            throw new TypeError('Argument must be a Buffer');\r\n        }\r\n        if (this === buf)\r\n            return true;\r\n        return Buffer.compare(this, buf) === 0;\r\n    }\r\n    // #region inspect\r\n    inspect() {\r\n        let str = '';\r\n        const max = INSPECT_MAX_BYTES;\r\n        str = this.toString('hex', 0, max)\r\n            .replace(/(.{2})/g, '$1 ')\r\n            .trim();\r\n        if (this.length > max)\r\n            str += ' ... ';\r\n        return '<Buffer ' + str + '>';\r\n    }\r\n    compare(...args) {\r\n        if (Buffer.isInstance(args[0], Uint8Array)) {\r\n            args[0] = Buffer.from(args[0], args[0].offset, args[0].byteLength);\r\n        }\r\n        if (!Buffer.isBuffer(args[0])) {\r\n            throw new TypeError('The \"target\" argument must be one of type Buffer or Uint8Array. ' +\r\n                'Received type ' +\r\n                typeof args[0]);\r\n        }\r\n        if (args[1] === undefined) {\r\n            args[1] = 0;\r\n        }\r\n        if (args[2] === undefined) {\r\n            args[2] = args[0] ? args[0].length : 0;\r\n        }\r\n        if (args[3] === undefined) {\r\n            args[3] = 0;\r\n        }\r\n        if (args[4] === undefined) {\r\n            args[4] = this.length;\r\n        }\r\n        if (args[1] < 0 ||\r\n            args[2] > args[0].length ||\r\n            args[3] < 0 ||\r\n            args[4] > this.length) {\r\n            throw new RangeError('out of range index');\r\n        }\r\n        if (args[3] >= args[4] && args[1] >= args[2]) {\r\n            return 0;\r\n        }\r\n        if (args[3] >= args[4]) {\r\n            return -1;\r\n        }\r\n        if (args[1] >= args[2]) {\r\n            return 1;\r\n        }\r\n        args[1] >>>= 0;\r\n        args[2] >>>= 0;\r\n        args[3] >>>= 0;\r\n        args[4] >>>= 0;\r\n        if (this === args[0]) {\r\n            return 0;\r\n        }\r\n        let x = args[4] - args[3];\r\n        let y = args[2] - args[1];\r\n        const len = Math.min(x, y);\r\n        const thisCopy = this.slice(args[3], args[4]);\r\n        const targetCopy = args[0].slice(args[1], args[2]);\r\n        for (let i = 0; i < len; ++i) {\r\n            if (thisCopy[i] !== targetCopy[i]) {\r\n                x = thisCopy[i];\r\n                y = targetCopy[i];\r\n                break;\r\n            }\r\n        }\r\n        if (x < y)\r\n            return -1;\r\n        if (y < x)\r\n            return 1;\r\n        return 0;\r\n    }\r\n    // #region indexOf\r\n    static arrayIndexOf(arr, val, byteOffset, encoding, dir) {\r\n        let indexSize = 1;\r\n        let arrLength = arr.length;\r\n        let valLength = val.length;\r\n        if (encoding !== undefined) {\r\n            encoding = String(encoding).toLowerCase();\r\n            if (encoding === 'ucs2' ||\r\n                encoding === 'ucs-2' ||\r\n                encoding === 'utf16le' ||\r\n                encoding === 'utf-16le') {\r\n                if (arr.length < 2 || val.length < 2) {\r\n                    return -1;\r\n                }\r\n                indexSize = 2;\r\n                arrLength /= 2;\r\n                valLength /= 2;\r\n                byteOffset /= 2;\r\n            }\r\n        }\r\n        function read(buf, i) {\r\n            if (indexSize === 1) {\r\n                return buf[i];\r\n            }\r\n            else {\r\n                return buf.readUInt16BE(i * indexSize);\r\n            }\r\n        }\r\n        let i;\r\n        if (dir) {\r\n            let foundIndex = -1;\r\n            for (i = byteOffset; i < arrLength; i++) {\r\n                if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\r\n                    if (foundIndex === -1)\r\n                        foundIndex = i;\r\n                    if (i - foundIndex + 1 === valLength)\r\n                        return foundIndex * indexSize;\r\n                }\r\n                else {\r\n                    if (foundIndex !== -1)\r\n                        i -= i - foundIndex;\r\n                    foundIndex = -1;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (byteOffset + valLength > arrLength)\r\n                byteOffset = arrLength - valLength;\r\n            for (i = byteOffset; i >= 0; i--) {\r\n                let found = true;\r\n                for (let j = 0; j < valLength; j++) {\r\n                    if (read(arr, i + j) !== read(val, j)) {\r\n                        found = false;\r\n                        break;\r\n                    }\r\n                }\r\n                if (found)\r\n                    return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    static bidirectionalIndexOf(...args) {\r\n        // Empty buffer means no match\r\n        if (args[0].length === 0)\r\n            return -1;\r\n        // Normalize byteOffset\r\n        if (typeof args[2] === 'string') {\r\n            args[3] = args[2];\r\n            args[2] = 0;\r\n        }\r\n        else if (args[2] > 0x7fffffff) {\r\n            args[2] = 0x7fffffff;\r\n        }\r\n        else if (args[2] < -0x80000000) {\r\n            args[2] = -0x80000000;\r\n        }\r\n        args[2] = +args[2]; // Coerce to Number.\r\n        if (Buffer.numberIsNaN(args[2])) {\r\n            // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\r\n            args[2] = args[4] ? 0 : args[0].length - 1;\r\n        }\r\n        // Normalize byteOffset: negative offsets start from the end of the buffer\r\n        if (args[2] < 0)\r\n            args[2] = args[0].length + args[2];\r\n        if (args[2] >= args[0].length) {\r\n            if (args[4])\r\n                return -1;\r\n            else\r\n                args[2] = args[0].length - 1;\r\n        }\r\n        else if (args[2] < 0) {\r\n            if (args[4])\r\n                args[2] = 0;\r\n            else\r\n                return -1;\r\n        }\r\n        // Normalize val\r\n        if (typeof args[1] === 'string') {\r\n            args[1] = Buffer.from(args[1], args[3]);\r\n        }\r\n        // Finally, search either indexOf (if dir is true) or lastIndexOf\r\n        if (Buffer.isBuffer(args[1])) {\r\n            // Special case: looking for empty string/buffer always fails\r\n            if (args[1].length === 0) {\r\n                return -1;\r\n            }\r\n            return Buffer.arrayIndexOf(args[0], args[1], args[2], args[3], args[4]);\r\n        }\r\n        else if (typeof args[1] === 'number') {\r\n            args[1] = args[1] & 0xff; // Search for a byte value [0-255]\r\n            if (typeof Uint8Array.prototype.indexOf === 'function') {\r\n                if (args[4]) {\r\n                    return Uint8Array.prototype.indexOf.call(args[0], args[1], args[2]);\r\n                }\r\n                else {\r\n                    return Uint8Array.prototype.lastIndexOf.call(args[0], args[1], args[2]);\r\n                }\r\n            }\r\n            return Buffer.arrayIndexOf(args[0], [args[1]], args[2], args[3], args[4]);\r\n        }\r\n        throw new TypeError('val must be string, number or Buffer');\r\n    }\r\n    indexOf(val, byteOffset, encoding) {\r\n        return Buffer.bidirectionalIndexOf(this, val, byteOffset, encoding, true);\r\n    }\r\n    lastIndexOf(val, byteOffset, encoding) {\r\n        return Buffer.bidirectionalIndexOf(this, val, byteOffset, encoding, false);\r\n    }\r\n    // #region includes\r\n    includes(val, byteOffset, encoding) {\r\n        return this.indexOf(val, byteOffset, encoding) !== -1;\r\n    }\r\n    // #region toJSON\r\n    toJSON() {\r\n        const facade = this;\r\n        return {\r\n            type: 'Buffer',\r\n            data: Array.prototype.slice.call(facade._arr || facade, 0)\r\n        };\r\n    }\r\n    // #region slice\r\n    static base64Slice(buf, start, end) {\r\n        if (start === 0 && end === buf.length) {\r\n            return base64.fromByteArray(buf);\r\n        }\r\n        else {\r\n            return base64.fromByteArray(buf.slice(start, end));\r\n        }\r\n    }\r\n    static utf8Slice(buf, start, end) {\r\n        end = Math.min(buf.length, end);\r\n        const res = [];\r\n        let i = start;\r\n        while (i < end) {\r\n            const firstByte = buf[i];\r\n            let codePoint = null;\r\n            let bytesPerSequence = firstByte > 0xef ? 4 : firstByte > 0xdf ? 3 : firstByte > 0xbf ? 2 : 1;\r\n            if (i + bytesPerSequence <= end) {\r\n                let secondByte, thirdByte, fourthByte, tempCodePoint;\r\n                switch (bytesPerSequence) {\r\n                    case 1:\r\n                        if (firstByte < 0x80) {\r\n                            codePoint = firstByte;\r\n                        }\r\n                        break;\r\n                    case 2:\r\n                        secondByte = buf[i + 1];\r\n                        if ((secondByte & 0xc0) === 0x80) {\r\n                            tempCodePoint = ((firstByte & 0x1f) << 0x6) | (secondByte & 0x3f);\r\n                            if (tempCodePoint > 0x7f) {\r\n                                codePoint = tempCodePoint;\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 3:\r\n                        secondByte = buf[i + 1];\r\n                        thirdByte = buf[i + 2];\r\n                        if ((secondByte & 0xc0) === 0x80 && (thirdByte & 0xc0) === 0x80) {\r\n                            tempCodePoint =\r\n                                ((firstByte & 0xf) << 0xc) |\r\n                                    ((secondByte & 0x3f) << 0x6) |\r\n                                    (thirdByte & 0x3f);\r\n                            if (tempCodePoint > 0x7ff &&\r\n                                (tempCodePoint < 0xd800 || tempCodePoint > 0xdfff)) {\r\n                                codePoint = tempCodePoint;\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 4:\r\n                        secondByte = buf[i + 1];\r\n                        thirdByte = buf[i + 2];\r\n                        fourthByte = buf[i + 3];\r\n                        if ((secondByte & 0xc0) === 0x80 &&\r\n                            (thirdByte & 0xc0) === 0x80 &&\r\n                            (fourthByte & 0xc0) === 0x80) {\r\n                            tempCodePoint =\r\n                                ((firstByte & 0xf) << 0x12) |\r\n                                    ((secondByte & 0x3f) << 0xc) |\r\n                                    ((thirdByte & 0x3f) << 0x6) |\r\n                                    (fourthByte & 0x3f);\r\n                            if (tempCodePoint > 0xffff && tempCodePoint < 0x110000) {\r\n                                codePoint = tempCodePoint;\r\n                            }\r\n                        }\r\n                }\r\n            }\r\n            if (codePoint === null) {\r\n                // we did not generate a valid codePoint so insert a\r\n                // replacement char (U+FFFD) and advance only 1 byte\r\n                codePoint = 0xfffd;\r\n                bytesPerSequence = 1;\r\n            }\r\n            else if (codePoint > 0xffff) {\r\n                // encode to utf16 (surrogate pair dance)\r\n                codePoint -= 0x10000;\r\n                res.push(((codePoint >>> 10) & 0x3ff) | 0xd800);\r\n                codePoint = 0xdc00 | (codePoint & 0x3ff);\r\n            }\r\n            res.push(codePoint);\r\n            i += bytesPerSequence;\r\n        }\r\n        return Buffer.decodeCodePointsArray(res);\r\n    }\r\n    static decodeCodePointsArray(codePoints) {\r\n        const len = codePoints.length;\r\n        if (len <= MAX_ARGUMENTS_LENGTH) {\r\n            return String.fromCharCode.apply(String, codePoints); // avoid extra slice()\r\n        }\r\n        // Decode in chunks to avoid \"call stack size exceeded\".\r\n        let res = '';\r\n        let i = 0;\r\n        while (i < len) {\r\n            res += String.fromCharCode.apply(String, codePoints.slice(i, (i += MAX_ARGUMENTS_LENGTH)));\r\n        }\r\n        return res;\r\n    }\r\n    static asciiSlice(buf, start, end) {\r\n        let ret = '';\r\n        end = Math.min(buf.length, end);\r\n        for (let i = start; i < end; ++i) {\r\n            ret += String.fromCharCode(buf[i] & 0x7f);\r\n        }\r\n        return ret;\r\n    }\r\n    static latin1Slice(buf, start, end) {\r\n        let ret = '';\r\n        end = Math.min(buf.length, end);\r\n        for (let i = start; i < end; ++i) {\r\n            ret += String.fromCharCode(buf[i]);\r\n        }\r\n        return ret;\r\n    }\r\n    static hexSlice(buf, start, end) {\r\n        const len = buf.length;\r\n        if (!start || start < 0)\r\n            start = 0;\r\n        if (!end || end < 0 || end > len)\r\n            end = len;\r\n        let out = '';\r\n        for (let i = start; i < end; ++i) {\r\n            out += Buffer.toHex(buf[i]);\r\n        }\r\n        return out;\r\n    }\r\n    static utf16leSlice(buf, start, end) {\r\n        const bytes = buf.slice(start, end);\r\n        let res = '';\r\n        for (let i = 0; i < bytes.length; i += 2) {\r\n            res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256);\r\n        }\r\n        return res;\r\n    }\r\n    slice(start, end) {\r\n        const len = this.length;\r\n        start = ~~start;\r\n        end = end === undefined ? len : ~~end;\r\n        if (start < 0) {\r\n            start += len;\r\n            if (start < 0)\r\n                start = 0;\r\n        }\r\n        else if (start > len) {\r\n            start = len;\r\n        }\r\n        if (end < 0) {\r\n            end += len;\r\n            if (end < 0)\r\n                end = 0;\r\n        }\r\n        else if (end > len) {\r\n            end = len;\r\n        }\r\n        if (end < start)\r\n            end = start;\r\n        // Return 'Uint8Array' augmented with 'Buffer' prototype.\r\n        let facade = this.subarray(start, end);\r\n        facade.__proto__ = Buffer.prototype;\r\n        return facade;\r\n    }\r\n    // #region copy\r\n    copy(target, targetStart, start, end) {\r\n        if (!Buffer.isBuffer(target))\r\n            throw new TypeError('argument should be a Buffer');\r\n        if (!start)\r\n            start = 0;\r\n        if (!end && end !== 0)\r\n            end = this.length;\r\n        if (targetStart >= target.length)\r\n            targetStart = target.length;\r\n        if (!targetStart)\r\n            targetStart = 0;\r\n        if (end > 0 && end < start)\r\n            end = start;\r\n        // Copy 0 bytes; we're done\r\n        if (end === start)\r\n            return 0;\r\n        if (target.length === 0 || this.length === 0)\r\n            return 0;\r\n        // Fatal error conditions\r\n        if (targetStart < 0) {\r\n            throw new RangeError('targetStart out of bounds');\r\n        }\r\n        if (start < 0 || start >= this.length)\r\n            throw new RangeError('Index out of range');\r\n        if (end < 0)\r\n            throw new RangeError('sourceEnd out of bounds');\r\n        // Are we oob?\r\n        if (end > this.length)\r\n            end = this.length;\r\n        if (target.length - targetStart < end - start) {\r\n            end = target.length - targetStart + start;\r\n        }\r\n        const len = end - start;\r\n        if (this === target &&\r\n            typeof Uint8Array.prototype.copyWithin === 'function') {\r\n            // Use built-in when available, missing from IE11\r\n            this.copyWithin(targetStart, start, end);\r\n        }\r\n        else if (this === target && start < targetStart && targetStart < end) {\r\n            // descending copy from end\r\n            for (let i = len - 1; i >= 0; --i) {\r\n                target[i + targetStart] = this[i + start];\r\n            }\r\n        }\r\n        else {\r\n            Uint8Array.prototype.set.call(target, this.subarray(start, end), targetStart);\r\n        }\r\n        return len;\r\n    }\r\n    fill(...args) {\r\n        // Handle string cases:\r\n        if (typeof args[0] === 'string') {\r\n            if (typeof args[1] === 'string') {\r\n                args[3] = args[1];\r\n                args[1] = 0;\r\n                args[2] = this.length;\r\n            }\r\n            else if (typeof args[2] === 'string') {\r\n                args[3] = args[2];\r\n                args[2] = this.length;\r\n            }\r\n            if (args[3] !== undefined && typeof args[3] !== 'string') {\r\n                throw new TypeError('encoding must be a string');\r\n            }\r\n            if (typeof args[3] === 'string' && !Buffer.isEncoding(args[3])) {\r\n                throw new TypeError('Unknown encoding: ' + args[3]);\r\n            }\r\n            if (args[0].length === 1) {\r\n                const code = args[0].charCodeAt(0);\r\n                if ((args[3] === 'utf8' && code < 128) || args[3] === 'latin1') {\r\n                    // Fast path: If `val` fits into a single byte, use that numeric value.\r\n                    args[0] = code;\r\n                }\r\n            }\r\n        }\r\n        else if (typeof args[0] === 'number') {\r\n            args[0] = args[0] & 255;\r\n        }\r\n        // Invalid ranges are not set to a default, so can range check early.\r\n        if (args[1] < 0 || this.length < args[1] || this.length < args[2]) {\r\n            throw new RangeError('Out of range index');\r\n        }\r\n        if (args[2] <= args[1]) {\r\n            return this;\r\n        }\r\n        args[1] = args[1] >>> 0;\r\n        args[2] = args[2] === undefined ? this.length : args[2] >>> 0;\r\n        if (!args[0])\r\n            args[0] = 0;\r\n        let i;\r\n        if (typeof args[0] === 'number') {\r\n            for (i = args[1]; i < args[2]; ++i) {\r\n                this[i] = args[0];\r\n            }\r\n        }\r\n        else {\r\n            const bytes = Buffer.isBuffer(args[0])\r\n                ? args[0]\r\n                : Buffer.from(args[0], args[3]);\r\n            const len = bytes.length;\r\n            if (len === 0) {\r\n                throw new TypeError('The value \"' + args[0] + '\" is invalid for argument \"value\"');\r\n            }\r\n            for (i = 0; i < args[2] - args[1]; ++i) {\r\n                this[i + args[1]] = bytes[i % len];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    // #region read: numerics\r\n    static checkOffset(offset, ext, length) {\r\n        if (offset % 1 !== 0 || offset < 0)\r\n            throw new RangeError('offset is not uint');\r\n        if (offset + ext > length)\r\n            throw new RangeError('Trying to access beyond Buffer length');\r\n    }\r\n    readUIntLE(offset, byteLength, noAssert) {\r\n        offset = offset >>> 0;\r\n        byteLength = byteLength >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, byteLength, this.length);\r\n        }\r\n        let val = this[offset];\r\n        let mul = 1;\r\n        let i = 0;\r\n        while (++i < byteLength && (mul *= 0x100)) {\r\n            val += this[offset + i] * mul;\r\n        }\r\n        return val;\r\n    }\r\n    readUIntBE(offset, byteLength, noAssert) {\r\n        offset = offset >>> 0;\r\n        byteLength = byteLength >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, byteLength, this.length);\r\n        }\r\n        let val = this[offset + --byteLength];\r\n        let mul = 1;\r\n        while (byteLength > 0 && (mul *= 0x100)) {\r\n            val += this[offset + --byteLength] * mul;\r\n        }\r\n        return val;\r\n    }\r\n    readUInt8(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 1, this.length);\r\n        }\r\n        return this[offset];\r\n    }\r\n    readUInt16LE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 2, this.length);\r\n        }\r\n        return this[offset] | (this[offset + 1] << 8);\r\n    }\r\n    readUInt16BE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 2, this.length);\r\n        }\r\n        return (this[offset] << 8) | this[offset + 1];\r\n    }\r\n    readUInt32LE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 4, this.length);\r\n        }\r\n        return ((this[offset] | (this[offset + 1] << 8) | (this[offset + 2] << 16)) +\r\n            this[offset + 3] * 0x1000000);\r\n    }\r\n    readUInt32BE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 4, this.length);\r\n        }\r\n        return (this[offset] * 0x1000000 +\r\n            ((this[offset + 1] << 16) | (this[offset + 2] << 8) | this[offset + 3]));\r\n    }\r\n    readIntLE(offset, byteLength, noAssert) {\r\n        offset = offset >>> 0;\r\n        byteLength = byteLength >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, byteLength, this.length);\r\n        }\r\n        let val = this[offset];\r\n        let mul = 1;\r\n        let i = 0;\r\n        while (++i < byteLength && (mul *= 0x100)) {\r\n            val += this[offset + i] * mul;\r\n        }\r\n        mul *= 0x80;\r\n        if (val >= mul) {\r\n            val -= Math.pow(2, 8 * byteLength);\r\n        }\r\n        return val;\r\n    }\r\n    readIntBE(offset, byteLength, noAssert) {\r\n        offset = offset >>> 0;\r\n        byteLength = byteLength >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, byteLength, this.length);\r\n        }\r\n        let i = byteLength;\r\n        let mul = 1;\r\n        let val = this[offset + --i];\r\n        while (i > 0 && (mul *= 0x100)) {\r\n            val += this[offset + --i] * mul;\r\n        }\r\n        mul *= 0x80;\r\n        if (val >= mul) {\r\n            val -= Math.pow(2, 8 * byteLength);\r\n        }\r\n        return val;\r\n    }\r\n    readInt8(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 1, this.length);\r\n        }\r\n        if (!(this[offset] & 0x80)) {\r\n            return this[offset];\r\n        }\r\n        return (0xff - this[offset] + 1) * -1;\r\n    }\r\n    readInt16LE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 2, this.length);\r\n        }\r\n        const val = this[offset] | (this[offset + 1] << 8);\r\n        return val & 0x8000 ? val | 0xffff0000 : val;\r\n    }\r\n    readInt16BE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 2, this.length);\r\n        }\r\n        const val = this[offset + 1] | (this[offset] << 8);\r\n        return val & 0x8000 ? val | 0xffff0000 : val;\r\n    }\r\n    readInt32LE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 4, this.length);\r\n        }\r\n        return (this[offset] |\r\n            (this[offset + 1] << 8) |\r\n            (this[offset + 2] << 16) |\r\n            (this[offset + 3] << 24));\r\n    }\r\n    readInt32BE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 4, this.length);\r\n        }\r\n        return ((this[offset] << 24) |\r\n            (this[offset + 1] << 16) |\r\n            (this[offset + 2] << 8) |\r\n            this[offset + 3]);\r\n    }\r\n    readFloatLE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 4, this.length);\r\n        }\r\n        const facade = this;\r\n        return ieee754.read(facade, offset, true, 23, 4);\r\n    }\r\n    readFloatBE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 4, this.length);\r\n        }\r\n        const facade = this;\r\n        return ieee754.read(facade, offset, false, 23, 4);\r\n    }\r\n    readDoubleLE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 8, this.length);\r\n        }\r\n        const facade = this;\r\n        return ieee754.read(facade, offset, true, 52, 8);\r\n    }\r\n    readDoubleBE(offset, noAssert) {\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkOffset(offset, 8, this.length);\r\n        }\r\n        const facade = this;\r\n        return ieee754.read(facade, offset, false, 52, 8);\r\n    }\r\n    // #region write: string\r\n    static hexWrite(buf, string, offset, length) {\r\n        offset = Number(offset) || 0;\r\n        const remaining = buf.length - offset;\r\n        if (!length) {\r\n            length = remaining;\r\n        }\r\n        else {\r\n            length = Number(length);\r\n            if (length > remaining) {\r\n                length = remaining;\r\n            }\r\n        }\r\n        const strLen = string.length;\r\n        if (length > strLen / 2) {\r\n            length = strLen / 2;\r\n        }\r\n        for (var i = 0; i < length; ++i) {\r\n            const parsed = parseInt(string.substr(i * 2, 2), 16);\r\n            if (Buffer.numberIsNaN(parsed))\r\n                return i;\r\n            buf[offset + i] = parsed;\r\n        }\r\n        return i;\r\n    }\r\n    static utf8Write(buf, str, offset, length) {\r\n        return Buffer.blitBuffer(Buffer.utf8ToBytes(str, buf.length - offset), buf, offset, length);\r\n    }\r\n    static asciiWrite(buf, str, offset, length) {\r\n        return Buffer.blitBuffer(Buffer.asciiToBytes(str), buf, offset, length);\r\n    }\r\n    static latin1Write(buf, str, offset, length) {\r\n        return Buffer.asciiWrite(buf, str, offset, length);\r\n    }\r\n    static base64Write(buf, str, offset, length) {\r\n        return Buffer.blitBuffer(Buffer.base64ToBytes(str), buf, offset, length);\r\n    }\r\n    static ucs2Write(buf, str, offset, length) {\r\n        return Buffer.blitBuffer(Buffer.utf16leToBytes(str, buf.length - offset), buf, offset, length);\r\n    }\r\n    write(...args) {\r\n        // Buffer#write(string)\r\n        if (args[1] === undefined) {\r\n            args[3] = 'utf8';\r\n            args[2] = this.length;\r\n            args[1] = 0;\r\n            // Buffer#write(string, encoding)\r\n        }\r\n        else if (args[2] === undefined && typeof args[1] === 'string') {\r\n            args[3] = args[1];\r\n            args[2] = this.length;\r\n            args[1] = 0;\r\n            // Buffer#write(string, offset[, length][, encoding])\r\n        }\r\n        else if (isFinite(args[1])) {\r\n            args[1] = args[1] >>> 0;\r\n            if (isFinite(args[2])) {\r\n                args[2] = args[2] >>> 0;\r\n                if (args[3] === undefined)\r\n                    args[3] = 'utf8';\r\n            }\r\n            else {\r\n                args[3] = args[2];\r\n                args[2] = undefined;\r\n            }\r\n        }\r\n        else {\r\n            throw new Error('Buffer.write(string, encoding, offset[, length]) is no longer supported');\r\n        }\r\n        const remaining = this.length - args[1];\r\n        if (args[2] === undefined || args[2] > remaining)\r\n            args[2] = remaining;\r\n        if ((args[0].length > 0 && (args[2] < 0 || args[1] < 0)) ||\r\n            args[1] > this.length) {\r\n            throw new RangeError('Attempt to write outside Buffer bounds');\r\n        }\r\n        if (!args[3]) {\r\n            args[3] = 'utf8';\r\n        }\r\n        let loweredCase = false;\r\n        for (;;) {\r\n            switch (args[3]) {\r\n                case 'hex':\r\n                    return Buffer.hexWrite(this, args[0], args[1], args[2]);\r\n                case 'utf8':\r\n                case 'utf-8':\r\n                    return Buffer.utf8Write(this, args[0], args[1], args[2]);\r\n                case 'ascii':\r\n                    return Buffer.asciiWrite(this, args[0], args[1], args[2]);\r\n                case 'latin1':\r\n                case 'binary':\r\n                    return Buffer.latin1Write(this, args[0], args[1], args[2]);\r\n                case 'base64':\r\n                    // Warning: maxLength not taken into account in base64Write\r\n                    return Buffer.base64Write(this, args[0], args[1], args[2]);\r\n                case 'ucs2':\r\n                case 'ucs-2':\r\n                case 'utf16le':\r\n                case 'utf-16le':\r\n                    return Buffer.ucs2Write(this, args[0], args[1], args[2]);\r\n                default:\r\n                    if (loweredCase) {\r\n                        throw new TypeError('Unknown encoding: ' + args[3]);\r\n                    }\r\n                    args[3] = ('' + args[3]).toLowerCase();\r\n                    loweredCase = true;\r\n            }\r\n        }\r\n    }\r\n    // #region write: numerics\r\n    static checkInt(buf, value, offset, ext, max, min) {\r\n        if (!Buffer.isBuffer(buf))\r\n            throw new TypeError('\"Buffer\" argument must be a Buffer instance');\r\n        if (value > max || value < min)\r\n            throw new RangeError('\"value\" argument is out of bounds');\r\n        if (offset + ext > buf.length)\r\n            throw new RangeError('Index out of range');\r\n    }\r\n    writeUIntLE(value, offset, byteLength, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        byteLength = byteLength >>> 0;\r\n        if (!noAssert) {\r\n            const maxBytes = Math.pow(2, 8 * byteLength) - 1;\r\n            Buffer.checkInt(this, value, offset, byteLength, maxBytes, 0);\r\n        }\r\n        let mul = 1;\r\n        let i = 0;\r\n        this[offset] = value & 0xff;\r\n        while (++i < byteLength && (mul *= 0x100)) {\r\n            this[offset + i] = (value / mul) & 0xff;\r\n        }\r\n        return offset + byteLength;\r\n    }\r\n    writeUIntBE(value, offset, byteLength, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        byteLength = byteLength >>> 0;\r\n        if (!noAssert) {\r\n            const maxBytes = Math.pow(2, 8 * byteLength) - 1;\r\n            Buffer.checkInt(this, value, offset, byteLength, maxBytes, 0);\r\n        }\r\n        let i = byteLength - 1;\r\n        let mul = 1;\r\n        this[offset + i] = value & 0xff;\r\n        while (--i >= 0 && (mul *= 0x100)) {\r\n            this[offset + i] = (value / mul) & 0xff;\r\n        }\r\n        return offset + byteLength;\r\n    }\r\n    writeUInt8(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 1, 0xff, 0);\r\n        }\r\n        this[offset] = value & 0xff;\r\n        return offset + 1;\r\n    }\r\n    writeUInt16LE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 2, 0xffff, 0);\r\n        }\r\n        this[offset] = value & 0xff;\r\n        this[offset + 1] = value >>> 8;\r\n        return offset + 2;\r\n    }\r\n    writeUInt16BE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 2, 0xffff, 0);\r\n        }\r\n        this[offset] = value >>> 8;\r\n        this[offset + 1] = value & 0xff;\r\n        return offset + 2;\r\n    }\r\n    writeUInt32LE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 4, 0xffffffff, 0);\r\n        }\r\n        this[offset + 3] = value >>> 24;\r\n        this[offset + 2] = value >>> 16;\r\n        this[offset + 1] = value >>> 8;\r\n        this[offset] = value & 0xff;\r\n        return offset + 4;\r\n    }\r\n    writeUInt32BE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 4, 0xffffffff, 0);\r\n        }\r\n        this[offset] = value >>> 24;\r\n        this[offset + 1] = value >>> 16;\r\n        this[offset + 2] = value >>> 8;\r\n        this[offset + 3] = value & 0xff;\r\n        return offset + 4;\r\n    }\r\n    writeIntLE(value, offset, byteLength, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            const limit = Math.pow(2, 8 * byteLength - 1);\r\n            Buffer.checkInt(this, value, offset, byteLength, limit - 1, -limit);\r\n        }\r\n        let i = 0;\r\n        let mul = 1;\r\n        let sub = 0;\r\n        this[offset] = value & 0xff;\r\n        while (++i < byteLength && (mul *= 0x100)) {\r\n            if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\r\n                sub = 1;\r\n            }\r\n            this[offset + i] = (((value / mul) >> 0) - sub) & 0xff;\r\n        }\r\n        return offset + byteLength;\r\n    }\r\n    writeIntBE(value, offset, byteLength, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            const limit = Math.pow(2, 8 * byteLength - 1);\r\n            Buffer.checkInt(this, value, offset, byteLength, limit - 1, -limit);\r\n        }\r\n        let i = byteLength - 1;\r\n        let mul = 1;\r\n        let sub = 0;\r\n        this[offset + i] = value & 0xff;\r\n        while (--i >= 0 && (mul *= 0x100)) {\r\n            if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\r\n                sub = 1;\r\n            }\r\n            this[offset + i] = (((value / mul) >> 0) - sub) & 0xff;\r\n        }\r\n        return offset + byteLength;\r\n    }\r\n    writeInt8(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 1, 0x7f, -0x80);\r\n        }\r\n        if (value < 0)\r\n            value = 0xff + value + 1;\r\n        this[offset] = value & 0xff;\r\n        return offset + 1;\r\n    }\r\n    writeInt16LE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 2, 0x7fff, -0x8000);\r\n        }\r\n        this[offset] = value & 0xff;\r\n        this[offset + 1] = value >>> 8;\r\n        return offset + 2;\r\n    }\r\n    writeInt16BE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 2, 0x7fff, -0x8000);\r\n        }\r\n        this[offset] = value >>> 8;\r\n        this[offset + 1] = value & 0xff;\r\n        return offset + 2;\r\n    }\r\n    writeInt32LE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000);\r\n        }\r\n        this[offset] = value & 0xff;\r\n        this[offset + 1] = value >>> 8;\r\n        this[offset + 2] = value >>> 16;\r\n        this[offset + 3] = value >>> 24;\r\n        return offset + 4;\r\n    }\r\n    writeInt32BE(value, offset, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000);\r\n        }\r\n        if (value < 0)\r\n            value = 0xffffffff + value + 1;\r\n        this[offset] = value >>> 24;\r\n        this[offset + 1] = value >>> 16;\r\n        this[offset + 2] = value >>> 8;\r\n        this[offset + 3] = value & 0xff;\r\n        return offset + 4;\r\n    }\r\n    static checkIEEE754(buf, value, offset, ext, max, min) {\r\n        if (offset + ext > buf.length)\r\n            throw new RangeError('Index out of range');\r\n        if (offset < 0)\r\n            throw new RangeError('Index out of range');\r\n    }\r\n    static writeFloat(buf, value, offset, littleEndian, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkIEEE754(buf, value, offset, 4, 3.4028234663852886e38, -3.4028234663852886e38);\r\n        }\r\n        ieee754.write(buf, value, offset, littleEndian, 23, 4);\r\n        return offset + 4;\r\n    }\r\n    writeFloatLE(value, offset, noAssert) {\r\n        return Buffer.writeFloat(this, value, offset, true, noAssert);\r\n    }\r\n    writeFloatBE(value, offset, noAssert) {\r\n        return Buffer.writeFloat(this, value, offset, false, noAssert);\r\n    }\r\n    static writeDouble(buf, value, offset, littleEndian, noAssert) {\r\n        value = +value;\r\n        offset = offset >>> 0;\r\n        if (!noAssert) {\r\n            Buffer.checkIEEE754(buf, value, offset, 8, 1.7976931348623157e308, -1.7976931348623157e308);\r\n        }\r\n        ieee754.write(buf, value, offset, littleEndian, 52, 8);\r\n        return offset + 8;\r\n    }\r\n    writeDoubleLE(value, offset, noAssert) {\r\n        return Buffer.writeDouble(this, value, offset, true, noAssert);\r\n    }\r\n    writeDoubleBE(value, offset, noAssert) {\r\n        return Buffer.writeDouble(this, value, offset, false, noAssert);\r\n    }\r\n    // #region static: alloc\r\n    static allocUnsafe(size) {\r\n        Buffer.assertSize(size);\r\n        return Buffer.createBuffer(size < 0 ? 0 : Buffer.checked(size) | 0);\r\n    }\r\n    static alloc(size, fill, encoding) {\r\n        Buffer.assertSize(size);\r\n        if (size <= 0) {\r\n            return Buffer.createBuffer(size);\r\n        }\r\n        if (fill !== undefined) {\r\n            // Only pay attention to encoding if it's a string. This\r\n            // prevents accidentally sending in a number that would\r\n            // be interpretted as a start offset.\r\n            return typeof encoding === 'string'\r\n                ? Buffer.createBuffer(size).fill(fill, encoding)\r\n                : Buffer.createBuffer(size).fill(fill);\r\n        }\r\n        return Buffer.createBuffer(size);\r\n    }\r\n    // #region static: from\r\n    static fromString(str, encoding) {\r\n        if (typeof encoding !== 'string' || encoding === '') {\r\n            encoding = 'utf8';\r\n        }\r\n        if (!Buffer.isEncoding(encoding)) {\r\n            throw new TypeError('Unknown encoding: ' + encoding);\r\n        }\r\n        const length = Buffer.byteLength(str, encoding) | 0;\r\n        let buf = Buffer.createBuffer(length);\r\n        const actual = buf.write(str, encoding);\r\n        if (actual !== length) {\r\n            // Writing a hex string, for example, that contains invalid characters will\r\n            // cause everything after the first invalid character to be ignored. (e.g.\r\n            // 'abxxcd' will be treated as 'ab')\r\n            buf = buf.slice(0, actual);\r\n        }\r\n        return buf;\r\n    }\r\n    static fromArrayLike(array) {\r\n        const length = array.length < 0 ? 0 : Buffer.checked(array.length) | 0;\r\n        const buf = Buffer.createBuffer(length);\r\n        for (let i = 0; i < length; i += 1) {\r\n            buf[i] = array[i] & 255;\r\n        }\r\n        return buf;\r\n    }\r\n    static fromArrayBuffer(array, byteOffset, length) {\r\n        if (byteOffset < 0 || array.byteLength < byteOffset) {\r\n            throw new RangeError('\"offset\" is outside of buffer bounds');\r\n        }\r\n        if (array.byteLength < byteOffset + (length || 0)) {\r\n            throw new RangeError('\"length\" is outside of buffer bounds');\r\n        }\r\n        let buf;\r\n        if (byteOffset === undefined && length === undefined) {\r\n            buf = new Uint8Array(array);\r\n        }\r\n        else if (length === undefined) {\r\n            buf = new Uint8Array(array, byteOffset);\r\n        }\r\n        else {\r\n            buf = new Uint8Array(array, byteOffset, length);\r\n        }\r\n        // Return an augmented `Uint8Array` instance\r\n        const facade = buf;\r\n        facade.__proto__ = Buffer.prototype;\r\n        return facade;\r\n    }\r\n    static fromObject(obj) {\r\n        if (Buffer.isBuffer(obj)) {\r\n            const len = Buffer.checked(obj.length) | 0;\r\n            const buf = Buffer.createBuffer(len);\r\n            if (buf.length === 0) {\r\n                return buf;\r\n            }\r\n            obj.copy(buf, 0, 0, len);\r\n            return buf;\r\n        }\r\n        if (obj.length !== undefined) {\r\n            if (typeof obj.length !== 'number' || Buffer.numberIsNaN(obj.length)) {\r\n                return Buffer.createBuffer(0);\r\n            }\r\n            return Buffer.fromArrayLike(obj);\r\n        }\r\n        if (obj.type === 'Buffer' && Array.isArray(obj.data)) {\r\n            return Buffer.fromArrayLike(obj.data);\r\n        }\r\n        throw TypeError('Unable create buffer from given object.');\r\n    }\r\n    static from(...args) {\r\n        if (typeof args[0] === 'string') {\r\n            return Buffer.fromString(args[0], args[1]);\r\n        }\r\n        if (ArrayBuffer.isView(args[0])) {\r\n            return Buffer.fromArrayLike(args[0]);\r\n        }\r\n        if (args[0] == null) {\r\n            throw TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\r\n                'or Array-like Object. Received type ' +\r\n                typeof args[0]);\r\n        }\r\n        if (Buffer.isInstance(args[0], ArrayBuffer) ||\r\n            (args[0] && Buffer.isInstance(args[0].buffer, ArrayBuffer))) {\r\n            return Buffer.fromArrayBuffer(args[0], args[1], args[2]);\r\n        }\r\n        if (typeof args[0] === 'number') {\r\n            throw new TypeError('The \"value\" argument must not be of type number. Received type number');\r\n        }\r\n        const valueOf = args[0].valueOf && args[0].valueOf();\r\n        if (valueOf != null && valueOf !== args[0]) {\r\n            return Buffer.from(args[0], args[1], args[2]);\r\n        }\r\n        const b = Buffer.fromObject(args[0]);\r\n        if (b)\r\n            return b;\r\n        if (typeof Symbol !== 'undefined' &&\r\n            Symbol.toPrimitive != null &&\r\n            typeof args[0][Symbol.toPrimitive] === 'function') {\r\n            return Buffer.from(args[0][Symbol.toPrimitive]('string'), args[1], args[2]);\r\n        }\r\n        throw new TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\r\n            'or Array-like Object. Received type ' +\r\n            typeof args[0]);\r\n    }\r\n    static isBuffer(b) {\r\n        return b instanceof Buffer;\r\n    }\r\n    static byteLength(...args) {\r\n        if (Buffer.isBuffer(args[0])) {\r\n            return args[0].length;\r\n        }\r\n        if (ArrayBuffer.isView(args[0]) ||\r\n            Buffer.isInstance(args[0], ArrayBuffer)) {\r\n            return args[0].byteLength;\r\n        }\r\n        if (typeof args[0] !== 'string') {\r\n            throw new TypeError('The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. ' +\r\n                'Received type ' +\r\n                typeof args[0]);\r\n        }\r\n        const len = args[0].length;\r\n        const mustMatch = args.length > 2 && args[2] === true;\r\n        if (!mustMatch && len === 0)\r\n            return 0;\r\n        // Use a for loop to avoid recursion\r\n        let loweredCase = false;\r\n        for (;;) {\r\n            switch (args[1]) {\r\n                case 'ascii':\r\n                case 'latin1':\r\n                case 'binary':\r\n                    return len;\r\n                case 'utf8':\r\n                case 'utf-8':\r\n                    return Buffer.utf8ToBytes(args[0]).length;\r\n                case 'ucs2':\r\n                case 'ucs-2':\r\n                case 'utf16le':\r\n                case 'utf-16le':\r\n                    return len * 2;\r\n                case 'hex':\r\n                    return len >>> 1;\r\n                case 'base64':\r\n                    return Buffer.base64ToBytes(args[0]).length;\r\n                default:\r\n                    if (loweredCase) {\r\n                        return mustMatch ? -1 : Buffer.utf8ToBytes(args[0]).length; // assume utf8\r\n                    }\r\n                    args[1] = ('' + args[1]).toLowerCase();\r\n                    loweredCase = true;\r\n            }\r\n        }\r\n    }\r\n    // #region static: compare\r\n    static compare(a, b) {\r\n        if (Buffer.isInstance(a, Uint8Array)) {\r\n            a = Buffer.from(a, a.byteOffset, a.byteLength);\r\n        }\r\n        if (Buffer.isInstance(b, Uint8Array)) {\r\n            b = Buffer.from(b, b.byteOffset, b.byteLength);\r\n        }\r\n        if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\r\n            throw new TypeError('The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array');\r\n        }\r\n        if (a === b)\r\n            return 0;\r\n        let x = a.length;\r\n        let y = b.length;\r\n        for (let i = 0, len = Math.min(x, y); i < len; ++i) {\r\n            if (a[i] !== b[i]) {\r\n                x = a[i];\r\n                y = b[i];\r\n                break;\r\n            }\r\n        }\r\n        if (x < y)\r\n            return -1;\r\n        if (y < x)\r\n            return 1;\r\n        return 0;\r\n    }\r\n    // #region static: isEncoding\r\n    static isEncoding(encoding) {\r\n        switch (String(encoding).toLowerCase()) {\r\n            case 'hex':\r\n            case 'utf8':\r\n            case 'utf-8':\r\n            case 'ascii':\r\n            case 'latin1':\r\n            case 'binary':\r\n            case 'base64':\r\n            case 'ucs2':\r\n            case 'ucs-2':\r\n            case 'utf16le':\r\n            case 'utf-16le':\r\n                return true;\r\n            default:\r\n                return false;\r\n        }\r\n    }\r\n    // #region static: concat\r\n    static concat(list, length) {\r\n        if (!Array.isArray(list)) {\r\n            throw new TypeError('\"list\" argument must be an Array of Buffers');\r\n        }\r\n        if (list.length === 0) {\r\n            return Buffer.alloc(0);\r\n        }\r\n        let i;\r\n        if (length === undefined) {\r\n            length = 0;\r\n            for (i = 0; i < list.length; ++i) {\r\n                length += list[i].length;\r\n            }\r\n        }\r\n        const buffer = Buffer.allocUnsafe(length);\r\n        let pos = 0;\r\n        for (i = 0; i < list.length; ++i) {\r\n            let buf = list[i];\r\n            if (Buffer.isInstance(buf, Uint8Array)) {\r\n                buf = Buffer.from(buf);\r\n            }\r\n            if (!Buffer.isBuffer(buf)) {\r\n                throw new TypeError('\"list\" argument must be an Array of Buffers');\r\n            }\r\n            buf.copy(buffer, pos);\r\n            pos += buf.length;\r\n        }\r\n        return buffer;\r\n    }\r\n    // #region private-static: helpers\r\n    static assertSize(size) {\r\n        if (typeof size !== 'number') {\r\n            throw new TypeError(`'size' argument must be of type number`);\r\n        }\r\n        else if (size < 0) {\r\n            throw new RangeError(`The value '${size}' is invalid for option \"size\"`);\r\n        }\r\n    }\r\n    static createBuffer(length) {\r\n        if (length > K_MAX_LENGTH) {\r\n            throw new RangeError('The value \"' + length + '\" is invalid for option \"size\"');\r\n        }\r\n        // Return an augmented `Uint8Array` instance\r\n        return new Buffer(length);\r\n    }\r\n    static checked(length) {\r\n        // Note: cannot use `length < K_MAX_LENGTH` here because that fails when\r\n        // length is NaN (which is otherwise coerced to zero.)\r\n        if (length >= K_MAX_LENGTH) {\r\n            throw new RangeError(`Attempt to allocate Buffer larger than maximum ` +\r\n                `size: 0x${K_MAX_LENGTH.toString(16)} bytes`);\r\n        }\r\n        return length | 0;\r\n    }\r\n    static base64clean(str) {\r\n        // Node takes equal signs as end of the Base64 encoding\r\n        str = str.split('=')[0];\r\n        // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\r\n        str = str.trim().replace(INVALID_BASE64_RE, '');\r\n        // Node converts strings with length < 2 to ''\r\n        if (str.length < 2)\r\n            return '';\r\n        // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\r\n        while (str.length % 4 !== 0) {\r\n            str = str + '=';\r\n        }\r\n        return str;\r\n    }\r\n    static toHex(n) {\r\n        if (n < 16)\r\n            return '0' + n.toString(16);\r\n        return n.toString(16);\r\n    }\r\n    static utf8ToBytes(str, units) {\r\n        units = units || Infinity;\r\n        let codePoint;\r\n        const length = str.length;\r\n        let leadSurrogate = null;\r\n        const bytes = [];\r\n        for (let i = 0; i < length; ++i) {\r\n            codePoint = str.charCodeAt(i);\r\n            // is surrogate component\r\n            if (codePoint > 0xd7ff && codePoint < 0xe000) {\r\n                // last char was a lead\r\n                if (!leadSurrogate) {\r\n                    // no lead yet\r\n                    if (codePoint > 0xdbff) {\r\n                        // unexpected trail\r\n                        if ((units -= 3) > -1)\r\n                            bytes.push(0xef, 0xbf, 0xbd);\r\n                        continue;\r\n                    }\r\n                    else if (i + 1 === length) {\r\n                        // unpaired lead\r\n                        if ((units -= 3) > -1)\r\n                            bytes.push(0xef, 0xbf, 0xbd);\r\n                        continue;\r\n                    }\r\n                    // valid lead\r\n                    leadSurrogate = codePoint;\r\n                    continue;\r\n                }\r\n                // 2 leads in a row\r\n                if (codePoint < 0xdc00) {\r\n                    if ((units -= 3) > -1)\r\n                        bytes.push(0xef, 0xbf, 0xbd);\r\n                    leadSurrogate = codePoint;\r\n                    continue;\r\n                }\r\n                // valid surrogate pair\r\n                codePoint =\r\n                    (((leadSurrogate - 0xd800) << 10) | (codePoint - 0xdc00)) + 0x10000;\r\n            }\r\n            else if (leadSurrogate) {\r\n                // valid bmp char, but last char was a lead\r\n                if ((units -= 3) > -1)\r\n                    bytes.push(0xef, 0xbf, 0xbd);\r\n            }\r\n            leadSurrogate = null;\r\n            // encode utf8\r\n            if (codePoint < 0x80) {\r\n                if ((units -= 1) < 0)\r\n                    break;\r\n                bytes.push(codePoint);\r\n            }\r\n            else if (codePoint < 0x800) {\r\n                if ((units -= 2) < 0)\r\n                    break;\r\n                bytes.push((codePoint >> 0x6) | 0xc0, (codePoint & 0x3f) | 0x80);\r\n            }\r\n            else if (codePoint < 0x10000) {\r\n                if ((units -= 3) < 0)\r\n                    break;\r\n                bytes.push((codePoint >> 0xc) | 0xe0, ((codePoint >> 0x6) & 0x3f) | 0x80, (codePoint & 0x3f) | 0x80);\r\n            }\r\n            else if (codePoint < 0x110000) {\r\n                if ((units -= 4) < 0)\r\n                    break;\r\n                bytes.push((codePoint >> 0x12) | 0xf0, ((codePoint >> 0xc) & 0x3f) | 0x80, ((codePoint >> 0x6) & 0x3f) | 0x80, (codePoint & 0x3f) | 0x80);\r\n            }\r\n            else {\r\n                throw new Error('Invalid code point');\r\n            }\r\n        }\r\n        return bytes;\r\n    }\r\n    static asciiToBytes(str) {\r\n        const byteArray = [];\r\n        for (let i = 0; i < str.length; ++i) {\r\n            // Node's code seems to be doing this and not & 0x7F..\r\n            byteArray.push(str.charCodeAt(i) & 0xff);\r\n        }\r\n        return byteArray;\r\n    }\r\n    static utf16leToBytes(str, units) {\r\n        let c, hi, lo;\r\n        const byteArray = [];\r\n        for (let i = 0; i < str.length; ++i) {\r\n            if ((units -= 2) < 0) {\r\n                break;\r\n            }\r\n            c = str.charCodeAt(i);\r\n            hi = c >> 8;\r\n            lo = c % 256;\r\n            byteArray.push(lo);\r\n            byteArray.push(hi);\r\n        }\r\n        return byteArray;\r\n    }\r\n    static base64ToBytes(str) {\r\n        return base64.toByteArray(Buffer.base64clean(str));\r\n    }\r\n    static blitBuffer(src, dst, offset, length) {\r\n        for (var i = 0; i < length; ++i) {\r\n            if (i + offset >= dst.length || i >= src.length)\r\n                break;\r\n            dst[i + offset] = src[i];\r\n        }\r\n        return i;\r\n    }\r\n    // ArrayBuffer or Uint8Array objects from other contexts (i.e. iframes) do not pass\r\n    // the `instanceof` check but they should be treated as of that type.\r\n    // See: https://github.com/feross/Buffer/issues/166\r\n    static isInstance(obj, type) {\r\n        return (obj instanceof type ||\r\n            (obj != null &&\r\n                obj.constructor != null &&\r\n                obj.constructor.name != null &&\r\n                obj.constructor.name === type.name));\r\n    }\r\n    static numberIsNaN(obj) {\r\n        // For IE11 support\r\n        return obj !== obj; // eslint-disable-line no-self-compare\r\n    }\r\n}\r\nexports.Buffer = Buffer;\r\n","\"use strict\";\r\n/** -------------------------------------------------------------------------------\r\n\r\n  Copyright (c) 2008, Fair Oaks Labs, Inc.\r\n  All rights reserved.\r\n\r\n  Redistribution and use in source and binary forms, with or without\r\n  modification, are permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice,\r\n    this list of conditions and the following disclaimer.\r\n\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation\r\n    and/or other materials provided with the distribution.\r\n\r\n  * Neither the name of Fair Oaks Labs, Inc. nor the names of its contributors\r\n    may be used to endorse or promote products derived from this software\r\n    without specific prior written permission.\r\n\r\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\r\n  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\r\n  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\r\n  ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\r\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\r\n  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\r\n  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\r\n  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n  POSSIBILITY OF SUCH DAMAGE.\r\n\r\n -----------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction read(buffer, offset, isLE, mLen, nBytes) {\r\n    let e, m;\r\n    const eLen = nBytes * 8 - mLen - 1;\r\n    const eMax = (1 << eLen) - 1;\r\n    const eBias = eMax >> 1;\r\n    let nBits = -7;\r\n    let i = isLE ? nBytes - 1 : 0;\r\n    const d = isLE ? -1 : 1;\r\n    let s = buffer[offset + i];\r\n    i += d;\r\n    e = s & ((1 << -nBits) - 1);\r\n    s >>= -nBits;\r\n    nBits += eLen;\r\n    for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) { }\r\n    m = e & ((1 << -nBits) - 1);\r\n    e >>= -nBits;\r\n    nBits += mLen;\r\n    for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) { }\r\n    if (e === 0) {\r\n        e = 1 - eBias;\r\n    }\r\n    else if (e === eMax) {\r\n        return m ? NaN : (s ? -1 : 1) * Infinity;\r\n    }\r\n    else {\r\n        m = m + Math.pow(2, mLen);\r\n        e = e - eBias;\r\n    }\r\n    return (s ? -1 : 1) * m * Math.pow(2, e - mLen);\r\n}\r\nexports.read = read;\r\nfunction write(buffer, value, offset, isLE, mLen, nBytes) {\r\n    let e, m, c;\r\n    let eLen = nBytes * 8 - mLen - 1;\r\n    const eMax = (1 << eLen) - 1;\r\n    const eBias = eMax >> 1;\r\n    const rt = mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0;\r\n    let i = isLE ? 0 : nBytes - 1;\r\n    const d = isLE ? 1 : -1;\r\n    const s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0;\r\n    value = Math.abs(value);\r\n    if (isNaN(value) || value === Infinity) {\r\n        m = isNaN(value) ? 1 : 0;\r\n        e = eMax;\r\n    }\r\n    else {\r\n        e = Math.floor(Math.log(value) / Math.LN2);\r\n        if (value * (c = Math.pow(2, -e)) < 1) {\r\n            e--;\r\n            c *= 2;\r\n        }\r\n        if (e + eBias >= 1) {\r\n            value += rt / c;\r\n        }\r\n        else {\r\n            value += rt * Math.pow(2, 1 - eBias);\r\n        }\r\n        if (value * c >= 2) {\r\n            e++;\r\n            c /= 2;\r\n        }\r\n        if (e + eBias >= eMax) {\r\n            m = 0;\r\n            e = eMax;\r\n        }\r\n        else if (e + eBias >= 1) {\r\n            m = (value * c - 1) * Math.pow(2, mLen);\r\n            e = e + eBias;\r\n        }\r\n        else {\r\n            m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);\r\n            e = 0;\r\n        }\r\n    }\r\n    for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) { }\r\n    e = (e << mLen) | m;\r\n    eLen += mLen;\r\n    for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) { }\r\n    buffer[offset + i - d] |= s * 128;\r\n}\r\nexports.write = write;\r\n","\"use strict\";\r\n/* ---------------------------------------------------------------------------\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2014\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n--------------------------------------------------------------------------- */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst lookup = [];\r\nconst revLookup = [];\r\nconst Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array;\r\nconst code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\nfor (let i = 0, len = code.length; i < len; ++i) {\r\n    lookup[i] = code[i];\r\n    revLookup[code.charCodeAt(i)] = i;\r\n}\r\n// Support decoding URL-safe base64 strings, as Node.js does.\r\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\r\nrevLookup['-'.charCodeAt(0)] = 62;\r\nrevLookup['_'.charCodeAt(0)] = 63;\r\nfunction getLens(b64) {\r\n    const len = b64.length;\r\n    if (len % 4 > 0) {\r\n        throw new Error('Invalid string. Length must be a multiple of 4');\r\n    }\r\n    // Trim off extra bytes after placeholder bytes are found\r\n    // See: https://github.com/beatgammit/base64-js/issues/42\r\n    let validLen = b64.indexOf('=');\r\n    if (validLen === -1)\r\n        validLen = len;\r\n    const placeHoldersLen = validLen === len ? 0 : 4 - (validLen % 4);\r\n    return [validLen, placeHoldersLen];\r\n}\r\n// base64 is 4/3 + up to two characters of the original data\r\nfunction byteLength(b64) {\r\n    const lens = getLens(b64);\r\n    const validLen = lens[0];\r\n    const placeHoldersLen = lens[1];\r\n    return ((validLen + placeHoldersLen) * 3) / 4 - placeHoldersLen;\r\n}\r\nexports.byteLength = byteLength;\r\nfunction _byteLength(validLen, placeHoldersLen) {\r\n    return ((validLen + placeHoldersLen) * 3) / 4 - placeHoldersLen;\r\n}\r\nfunction toByteArray(b64) {\r\n    const lens = getLens(b64);\r\n    const validLen = lens[0];\r\n    const placeHoldersLen = lens[1];\r\n    const arr = new Arr(_byteLength(validLen, placeHoldersLen));\r\n    let tmp;\r\n    let curByte = 0;\r\n    // if there are placeholders, only get up to the last complete 4 chars\r\n    const len = placeHoldersLen > 0 ? validLen - 4 : validLen;\r\n    for (var i = 0; i < len; i += 4) {\r\n        tmp = (revLookup[b64.charCodeAt(i)] << 18) |\r\n            (revLookup[b64.charCodeAt(i + 1)] << 12) |\r\n            (revLookup[b64.charCodeAt(i + 2)] << 6) |\r\n            revLookup[b64.charCodeAt(i + 3)];\r\n        arr[curByte++] = (tmp >> 16) & 0xff;\r\n        arr[curByte++] = (tmp >> 8) & 0xff;\r\n        arr[curByte++] = tmp & 0xff;\r\n    }\r\n    if (placeHoldersLen === 2) {\r\n        tmp = (revLookup[b64.charCodeAt(i)] << 2) |\r\n            (revLookup[b64.charCodeAt(i + 1)] >> 4);\r\n        arr[curByte++] = tmp & 0xff;\r\n    }\r\n    if (placeHoldersLen === 1) {\r\n        tmp = (revLookup[b64.charCodeAt(i)] << 10) |\r\n            (revLookup[b64.charCodeAt(i + 1)] << 4) |\r\n            (revLookup[b64.charCodeAt(i + 2)] >> 2);\r\n        arr[curByte++] = (tmp >> 8) & 0xff;\r\n        arr[curByte++] = tmp & 0xff;\r\n    }\r\n    return arr;\r\n}\r\nexports.toByteArray = toByteArray;\r\nfunction tripletToBase64(num) {\r\n    return (lookup[(num >> 18) & 0x3f] +\r\n        lookup[(num >> 12) & 0x3f] +\r\n        lookup[(num >> 6) & 0x3f] +\r\n        lookup[num & 0x3f]);\r\n}\r\nexports.tripletToBase64 = tripletToBase64;\r\nfunction encodeChunk(uint8, start, end) {\r\n    let tmp;\r\n    const output = [];\r\n    for (let i = start; i < end; i += 3) {\r\n        tmp =\r\n            ((uint8[i] << 16) & 0xff0000) +\r\n                ((uint8[i + 1] << 8) & 0xff00) +\r\n                (uint8[i + 2] & 0xff);\r\n        output.push(tripletToBase64(tmp));\r\n    }\r\n    return output.join('');\r\n}\r\nexports.encodeChunk = encodeChunk;\r\nfunction fromByteArray(uint8) {\r\n    let tmp;\r\n    const len = uint8.length;\r\n    const extraBytes = len % 3; // if we have 1 byte left, pad 2 bytes\r\n    const parts = [];\r\n    const maxChunkLength = 16383; // must be multiple of 3\r\n    // go through the array every three bytes, we'll deal with trailing stuff later\r\n    for (let i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\r\n        parts.push(encodeChunk(uint8, i, i + maxChunkLength > len2 ? len2 : i + maxChunkLength));\r\n    }\r\n    // pad the end with zeros, but make sure to not forget the extra bytes\r\n    if (extraBytes === 1) {\r\n        tmp = uint8[len - 1];\r\n        parts.push(lookup[tmp >> 2] + lookup[(tmp << 4) & 0x3f] + '==');\r\n    }\r\n    else if (extraBytes === 2) {\r\n        tmp = (uint8[len - 2] << 8) + uint8[len - 1];\r\n        parts.push(lookup[tmp >> 10] +\r\n            lookup[(tmp >> 4) & 0x3f] +\r\n            lookup[(tmp << 2) & 0x3f] +\r\n            '=');\r\n    }\r\n    return parts.join('');\r\n}\r\nexports.fromByteArray = fromByteArray;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../async\");\r\n/**\r\n * Provides an asynchronous Writable abstraction over streams. This type is\r\n * used as a sender for Readable<T> and also provides hooks for the\r\n * WritableStream<T> type that is currently pending implementation in\r\n * Firefox.\r\n */\r\nclass Writable {\r\n    constructor(sink) {\r\n        this.sink = sink;\r\n        this.controller = {};\r\n        this.semaphore = new async_1.Semaphore(1);\r\n        this.start();\r\n    }\r\n    /** Starts this writable. */\r\n    async start() {\r\n        if (this.sink.start) {\r\n            try {\r\n                await this.semaphore.run(() => this.sink.start(this.controller));\r\n            }\r\n            catch (error) {\r\n                this.error = error;\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n    /** Writes this value to the stream. */\r\n    async write(data) {\r\n        if (this.error !== undefined) {\r\n            throw this.error;\r\n        }\r\n        if (this.sink.write) {\r\n            try {\r\n                await this.semaphore.run(() => this.sink.write(data, this.controller));\r\n            }\r\n            catch (error) {\r\n                this.error = error;\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n    /** Aborts this stream with an error.. */\r\n    async abort(error = new Error('abort')) {\r\n        if (this.error !== undefined) {\r\n            throw this.error;\r\n        }\r\n        if (this.sink.abort) {\r\n            try {\r\n                await this.semaphore.run(() => this.sink.abort(error));\r\n            }\r\n            catch (error) {\r\n                this.error = error;\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n    /** Closes this stream. */\r\n    async close() {\r\n        if (this.error !== undefined) {\r\n            throw this.error;\r\n        }\r\n        if (this.sink.close) {\r\n            try {\r\n                await this.semaphore.run(() => this.sink.close());\r\n            }\r\n            catch (error) {\r\n                this.error = error;\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.Writable = Writable;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass ReadableAsyncIterator {\r\n    constructor(readable) {\r\n        this.readable = readable;\r\n    }\r\n    async next() {\r\n        return this.readable.read();\r\n    }\r\n}\r\nexports.ReadableAsyncIterator = ReadableAsyncIterator;\r\n/**\r\n * An asynchronous pull based readable stream with asyncIterator support.\r\n */\r\nclass Readable {\r\n    /** Creates a new Readable from the given UnderlyingSource<T>. */\r\n    constructor(source) {\r\n        this.stream = new ReadableStream(source);\r\n        this.reader = this.stream.getReader();\r\n    }\r\n    /** Implements the IAsyncIterator protocol. */\r\n    [Symbol.asyncIterator]() {\r\n        return new ReadableAsyncIterator(this);\r\n    }\r\n    /** Reads the next 'result' from the underlying stream. */\r\n    async read() {\r\n        return this.reader.read();\r\n    }\r\n    /** Cancels reading from this readable. */\r\n    cancel() {\r\n        return this.reader.cancel();\r\n    }\r\n    /**\r\n     * Pipes from this reading into the given writable target. This\r\n     * function does not support chaining pipe operations.\r\n     */\r\n    async pipe(writable) {\r\n        while (true) {\r\n            const { done, value } = await this.read();\r\n            if (done) {\r\n                return writable.close();\r\n            }\r\n            try {\r\n                await writable.write(value);\r\n            }\r\n            catch (error) {\r\n                await writable.abort(error);\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.Readable = Readable;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Provides an asynchronous query interface over AsyncIterable<T>. This class\r\n * is modelled on C#'s Queryable<T> type allowing expressions to be built and\r\n * evaluated either via enumeration, or via eager collection.\r\n */\r\nclass Queryable {\r\n    constructor(iterable) {\r\n        this.iterable = iterable;\r\n    }\r\n    [Symbol.asyncIterator]() {\r\n        async function* generator(iterable) {\r\n            for await (const element of iterable) {\r\n                yield element;\r\n            }\r\n        }\r\n        return generator(this.iterable);\r\n    }\r\n    // #region lazy evaluators\r\n    /**  Concatenates two query sequences returning a new query that enumerates the first, then the second. */\r\n    concat(queryable) {\r\n        async function* generator(iterable) {\r\n            for await (const element of iterable) {\r\n                yield element;\r\n            }\r\n            for await (const element of queryable.iterable) {\r\n                yield element;\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Returns distinct elements from a sequence by using the default equality comparer to compare values.  */\r\n    distinct(func) {\r\n        func = func || ((value) => value);\r\n        const accu = [];\r\n        async function* generator(iterable) {\r\n            for await (const element of iterable) {\r\n                const key = func(element);\r\n                if (accu.indexOf(key) === -1) {\r\n                    accu.push(key);\r\n                    yield element;\r\n                }\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Returns the element at the specified index, if no element exists, reject. */\r\n    async elementAt(index) {\r\n        const array = await this.toArray();\r\n        return array[index];\r\n    }\r\n    /** Returns the first element. if no element exists, reject. */\r\n    async first() {\r\n        const array = await this.toArray();\r\n        return array[0];\r\n    }\r\n    /** Returns the last element in this sequence. if empty, reject. */\r\n    async last() {\r\n        const array = await this.toArray();\r\n        return array[array.length - 1];\r\n    }\r\n    /** (internal) provides ordering for the orderBy() and orderByDescending() operators. */\r\n    ordering(direction, func) {\r\n        async function* generator(iterable) {\r\n            const array = [];\r\n            for await (const element of iterable) {\r\n                array.push(element);\r\n            }\r\n            const sorted = array.sort((a, b) => {\r\n                const left = func(a);\r\n                const right = func(b);\r\n                return (direction === \"asc\")\r\n                    ? +(left > right) || +(left === right) - 1\r\n                    : +(left < right) || +(left === right) - 1;\r\n            });\r\n            for (const element of sorted) {\r\n                yield element;\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Sorts the elements of a sequence in ascending order according to a key. This method requires an internal collect(). */\r\n    orderBy(func) {\r\n        return this.ordering(\"asc\", func);\r\n    }\r\n    /** Sorts the elements of a sequence in descending order according to a key. This method requires an internal collect(). */\r\n    orderByDescending(func) {\r\n        return this.ordering(\"desc\", func);\r\n    }\r\n    /** Inverts the order of the elements in a sequence. This method requires an internal collect. */\r\n    reverse() {\r\n        async function* generator(iterable) {\r\n            const array = [];\r\n            for await (const element of iterable) {\r\n                array.push(element);\r\n            }\r\n            for (let i = array.length - 1; i !== 0; i--) {\r\n                yield array[i];\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Projects each element of a sequence into a new form. */\r\n    select(func) {\r\n        async function* generator(iterable) {\r\n            let index = 0;\r\n            for await (const element of iterable) {\r\n                yield func(element, index++);\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Projects each element of a sequence to an IEnumerable<T> and combines the resulting sequences into one sequence. */\r\n    selectMany(func) {\r\n        async function* generator(iterable) {\r\n            let index = 0;\r\n            for await (const element0 of iterable) {\r\n                for await (const element1 of func(element0, index++)) {\r\n                    yield element1;\r\n                }\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Bypasses a specified number of elements in a sequence and then returns the remaining elements. */\r\n    skip(count) {\r\n        async function* generator(iterable) {\r\n            let index = 0;\r\n            for await (const element of iterable) {\r\n                if (index >= count) {\r\n                    yield element;\r\n                }\r\n                index += 1;\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Returns a specified number of contiguous elements from the start of a sequence. */\r\n    take(count) {\r\n        async function* generator(iterable) {\r\n            let index = 0;\r\n            for await (const element of iterable) {\r\n                if (index < count) {\r\n                    yield element;\r\n                }\r\n                index += 1;\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    /** Filters a sequence of values based on a predicate. */\r\n    where(func) {\r\n        async function* generator(iterable) {\r\n            let index = 0;\r\n            for await (const element of iterable) {\r\n                if (func(element, index++)) {\r\n                    yield element;\r\n                }\r\n            }\r\n        }\r\n        return new Queryable(generator(this.iterable));\r\n    }\r\n    // #region eager aggregators\r\n    /** Applies an accumulator function over a sequence. */\r\n    async aggregate(func, initial) {\r\n        const array = await this.toArray();\r\n        return array.reduce(func, initial);\r\n    }\r\n    /** Determines whether all the elements of a sequence satisfy a condition. */\r\n    async all(func) {\r\n        const array = await this.toArray();\r\n        return array.every(func);\r\n    }\r\n    /** Computes the average of a sequence of numeric values. */\r\n    async average(func) {\r\n        const array = await this.toArray();\r\n        const sum = array.map(func).reduce((acc, c) => acc + c, 0);\r\n        return sum / array.length;\r\n    }\r\n    /** Determines whether a sequence contains any elements that meet this criteria. */\r\n    async any(func) {\r\n        const array = await this.toArray();\r\n        return array.some(func);\r\n    }\r\n    /**\r\n     * Returns the number of elements in a sequence. Note, this function\r\n     * enumerates all elements for this queryable. For the fast path, use\r\n     * the .count() function on the `Database` type.\r\n     */\r\n    async count() {\r\n        let count = 0;\r\n        for await (const value of this.iterable) {\r\n            count += 1;\r\n        }\r\n        return count;\r\n    }\r\n    /** Computes the sum of the sequence of numeric values. */\r\n    async sum(func) {\r\n        const array = await this.toArray();\r\n        return array.reduce((acc, c, index) => acc + func(c, index), 0);\r\n    }\r\n    /** Returns this queryable as an array. */\r\n    async toArray() {\r\n        const buffer = [];\r\n        for await (const element of this.iterable) {\r\n            buffer.push(element);\r\n        }\r\n        return buffer;\r\n    }\r\n}\r\nexports.Queryable = Queryable;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * This type provides high level system information the user agent, storage\r\n * capabilities and network stats. Information given by this type may vary\r\n * on user agent basis.\r\n */\r\nclass System {\r\n    constructor(net) {\r\n        this.net = net;\r\n        this.started = new Date();\r\n    }\r\n    /** Returns the system uptime in milliseconds. */\r\n    uptime() {\r\n        const started = this.started.getTime();\r\n        const now = Date.now();\r\n        return now - started;\r\n    }\r\n    /** Returns a single netstat object from the given peer. */\r\n    async getNetStat(peer) {\r\n        const local = peer.local;\r\n        const remote = peer.remote;\r\n        const loopback = peer.loopback;\r\n        const transceivers = peer.connection.getTransceivers().length;\r\n        const senders = peer.connection.getSenders().length;\r\n        const stats = await peer.connection.getStats();\r\n        const info = {};\r\n        stats.forEach(value => {\r\n            Object.keys(value).forEach(key => { info[key] = value[key]; });\r\n        });\r\n        return { local, remote, loopback, transceivers, senders, ...info };\r\n    }\r\n    /** Returns network statistics. */\r\n    async netstat() {\r\n        const peers = this.net.getPeers();\r\n        const stats = [];\r\n        for (const key of peers.keys()) {\r\n            const peer = peers.get(key);\r\n            const stat = await this.getNetStat(peer);\r\n            stats.push(stat);\r\n        }\r\n        return stats;\r\n    }\r\n}\r\nexports.System = System;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../async\");\r\nconst queryable_1 = require(\"../queryable\");\r\nconst driver_1 = require(\"./driver\");\r\nconst streams_1 = require(\"../streams\");\r\nconst key_1 = require(\"./key\");\r\nclass KeyRequiredError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\nexports.KeyRequiredError = KeyRequiredError;\r\n/**\r\n * An IndexedDB database abstraction that supports transactional write and\r\n * as well as an expression based query interface for reading. This type is\r\n * designed as local database for nodes, but also to service as a networked\r\n * database served over the network via smokes REST stream protocol.\r\n */\r\nclass Database {\r\n    constructor(name) {\r\n        this.barrier = new async_1.Barrier();\r\n        this.transact = {\r\n            inserts: new Map(),\r\n            updates: new Map(),\r\n            deletes: new Map()\r\n        };\r\n        this.connect(name);\r\n    }\r\n    /** Internally connects to the IDB database. */\r\n    async connect(name) {\r\n        this.driver = await driver_1.IDBDriver.connect(name);\r\n        this.barrier.resume();\r\n    }\r\n    /** Gets the name of this database. */\r\n    name() {\r\n        return this.barrier.run(() => this.driver.name());\r\n    }\r\n    /** Gets the version of this database. */\r\n    version() {\r\n        return this.barrier.run(() => this.driver.version());\r\n    }\r\n    /** Gets the store names for this database. */\r\n    stores() {\r\n        return this.barrier.run(() => this.driver.stores());\r\n    }\r\n    /** Returns the number of records in the given store. */\r\n    count(storeKey) {\r\n        return this.barrier.run(() => {\r\n            return this.driver.stores().includes(storeKey)\r\n                ? this.driver.count(storeKey)\r\n                : 0;\r\n        });\r\n    }\r\n    /** Returns true if the given recordKey exists in the given store. */\r\n    exists(storeKey, recordKey) {\r\n        return this.barrier.run(async () => {\r\n            if (this.driver.stores().includes(storeKey)) {\r\n                const record = await this.driver.get(storeKey, recordKey);\r\n                return record !== undefined;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    /** Returns a record from a store with the given RecordKey. */\r\n    get(storeKey, recordKey) {\r\n        return this.barrier.run(() => {\r\n            return this.driver.stores().includes(storeKey)\r\n                ? this.driver.get(storeKey, recordKey)\r\n                : undefined;\r\n        });\r\n    }\r\n    /** Inserts a record into the given store. */\r\n    insert(storeKey, record) {\r\n        if (!this.transact.inserts.has(storeKey)) {\r\n            this.transact.inserts.set(storeKey, []);\r\n        }\r\n        this.transact.inserts.get(storeKey).push(record);\r\n    }\r\n    /** Updates a record with the given store. */\r\n    update(storeKey, record) {\r\n        if (!this.transact.updates.has(storeKey)) {\r\n            this.transact.updates.set(storeKey, []);\r\n        }\r\n        this.transact.updates.get(storeKey).push(record);\r\n    }\r\n    /** Deletes a record in the store. */\r\n    delete(...args) {\r\n        const storeKey = args[0];\r\n        const record = (typeof args[1] === 'string') ? ({ key: args[1] }) : args[1];\r\n        if (record.key === undefined) {\r\n            throw new KeyRequiredError(`Cannot delete record without \"key\" property.`);\r\n        }\r\n        if (!this.transact.deletes.has(storeKey)) {\r\n            this.transact.deletes.set(storeKey, []);\r\n        }\r\n        this.transact.deletes.get(storeKey).push(record);\r\n    }\r\n    /** Deletes a store from this database. */\r\n    drop(storeKey) {\r\n        return this.barrier.run(() => this.driver.remove([storeKey]));\r\n    }\r\n    /** Commits any inserts, updates or deletes made to this database. */\r\n    async commit() {\r\n        return this.barrier.run(async () => {\r\n            const creates = [\r\n                ...this.transact.inserts.keys(),\r\n                ...this.transact.updates.keys(),\r\n                ...this.transact.deletes.keys()\r\n            ];\r\n            await this.driver.add(creates);\r\n            await this.driver.transact(this.transact);\r\n            this.transact.inserts.clear();\r\n            this.transact.updates.clear();\r\n            this.transact.deletes.clear();\r\n        });\r\n    }\r\n    /** Creates a query for the given storeKey. */\r\n    query(storeKey) {\r\n        return new queryable_1.Queryable(this.readable(storeKey));\r\n    }\r\n    /** Generates a new key. */\r\n    key() {\r\n        return key_1.Key.create();\r\n    }\r\n    /** Returns a readable to this store key. */\r\n    readable(storeKey) {\r\n        let reader;\r\n        return new streams_1.Readable({\r\n            start: async (controller) => this.barrier.run(async () => {\r\n                if (!this.driver.stores().includes(storeKey)) {\r\n                    controller.close();\r\n                }\r\n                reader = this.driver.read(storeKey);\r\n            }),\r\n            pull: async (controller) => {\r\n                const record = await reader.read();\r\n                if (record !== null) {\r\n                    controller.enqueue(record);\r\n                }\r\n                else {\r\n                    controller.close();\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /** Disposes of this object. */\r\n    dispose() {\r\n        return this.barrier.run(() => this.driver.close());\r\n    }\r\n    /** Drops the database with the given key. */\r\n    static async drop(databaseKey) {\r\n        await driver_1.IDBDriver.drop(databaseKey);\r\n    }\r\n}\r\nexports.Database = Database;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Provides key generation for database records.\r\n */\r\nclass Key {\r\n    /** Creates a new unique key of the uuidv4 form. */\r\n    static create() {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n            const r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    }\r\n}\r\nexports.Key = Key;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar bucket_1 = require(\"./bucket\");\r\nexports.Bucket = bucket_1.Bucket;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst buffer_1 = require(\"../buffer\");\r\nconst streams_1 = require(\"../streams\");\r\nconst async_1 = require(\"../async\");\r\nconst database_1 = require(\"../database\");\r\nconst constants_1 = require(\"./constants\");\r\nconst reader_1 = require(\"./reader\");\r\nconst writer_1 = require(\"./writer\");\r\nconst errors_1 = require(\"./errors\");\r\n/**\r\n * Bucket\r\n *\r\n * Provides a file storage mechanism. Allows files to be streamed in and out of\r\n * IndexedDB with files named via simple key. This type provides a similar storage\r\n * medium to that of AmazonS3 storage where files are persisted via simple key.\r\n */\r\nclass Bucket {\r\n    /** Creates a new bucket with the given IDB database instance. */\r\n    constructor(dbname) {\r\n        this.dbname = dbname;\r\n        this.database = new database_1.Database(this.dbname);\r\n        this.semaphore = new async_1.Semaphore(1);\r\n    }\r\n    /** Returns true if the given file key exists within this bucket. */\r\n    exists(key) {\r\n        return this.database.exists(constants_1.FileStore, key);\r\n    }\r\n    /**\r\n     * Returns meta information for the given file keys. If any of the keys are\r\n     * missing, then those keys will be omitted from the result.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     *\r\n     * // returns info for 'file.txt'\r\n     * bucket.info(['file.txt'])\r\n     *\r\n     * // returns information for all keys\r\n     * bucket.info(await bucket.list())\r\n     *\r\n     * ```\r\n     */\r\n    info(keys) {\r\n        return this.semaphore.run(async () => {\r\n            return this.database.query(constants_1.FileStore)\r\n                .where(file => file !== undefined)\r\n                .where(file => keys.includes(file.key))\r\n                .select(file => {\r\n                return {\r\n                    key: file.key,\r\n                    created: file.created,\r\n                    updated: file.updated,\r\n                    size: file.size\r\n                };\r\n            }).toArray();\r\n        });\r\n    }\r\n    /**\r\n     * Returns a list of file keys that have the given prefix. The delimiter\r\n     * parameter is used to limit sub-directories in the list based on the\r\n     * key scheme used by the calling application. If underfined, this function\r\n     * will list all keys in all directories and sub-directories sharing the\r\n     * common prefix. If defined, this function will filter keys only up the\r\n     * the given delimiter.\r\n     *\r\n     * @example\r\n     *\r\n     * ```typescript\r\n     * // any keys that share this prefix (including sub directories)\r\n     * await bucket.list('folder/')\r\n     *\r\n     * // only keys that share the 'folder/' prefix. (excluding sub directories)\r\n     * await bucket.list('folder/', '/')\r\n     * ```\r\n     */\r\n    list(prefix = '', delimiter) {\r\n        return this.semaphore.run(() => this.database\r\n            .query(constants_1.FileStore)\r\n            .where(file => file.key.indexOf(prefix) === 0)\r\n            .where(file => !file.key.replace(prefix, '').includes(delimiter))\r\n            .select(file => file.key)\r\n            .toArray());\r\n    }\r\n    /**\r\n     * Returns a readable stream to the given file key. If the file does not\r\n     * exist, a FileNotFound error will be thrown on first attempt to read\r\n     * from the file. The start and end parameters will read a portion of the\r\n     * file and act similar to slice() arguments.\r\n     */\r\n    readable(key, start, end) {\r\n        const reader = new reader_1.Reader({\r\n            database: this.database,\r\n            semaphore: this.semaphore,\r\n            key,\r\n            start,\r\n            end\r\n        });\r\n        return new streams_1.Readable({\r\n            start: () => reader.prepare(),\r\n            pull: async (controller) => {\r\n                try {\r\n                    const buffer = await reader.read();\r\n                    if (buffer.byteLength > 0) {\r\n                        controller.enqueue(buffer);\r\n                    }\r\n                    else {\r\n                        controller.close();\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    controller.error(error);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Returns a writable stream to a file with the given key. If the file does\r\n     * not exist it will be created. Otherwise, the file will be appended.\r\n     */\r\n    writable(key) {\r\n        const writer = new writer_1.Writer({\r\n            database: this.database,\r\n            semaphore: this.semaphore,\r\n            key\r\n        });\r\n        return new streams_1.Writable({\r\n            start: () => writer.prepare(),\r\n            write: buffer => writer.write(buffer),\r\n            close: () => writer.close()\r\n        });\r\n    }\r\n    async read(...args) {\r\n        const key = args[0];\r\n        const encoding = args[1];\r\n        const readable = this.readable(key);\r\n        const contents = [];\r\n        for await (const buffer of readable) {\r\n            contents.push(buffer);\r\n        }\r\n        return encoding\r\n            ? buffer_1.Buffer.concat(contents).toString(encoding)\r\n            : buffer_1.Buffer.concat(contents);\r\n    }\r\n    /**\r\n     * Returns a Blob handle to this files data. This function can be used\r\n     * in conjunction with URL.createObjectURL(blob) and URL.revokeObjectURL(blob)\r\n     * to create browser accessible URL's to the files housed within this bucket.\r\n     */\r\n    async readBlob(key) {\r\n        return this.semaphore.run(async () => {\r\n            if (!(await this.database.exists(constants_1.FileStore, key))) {\r\n                throw new errors_1.FileNotFoundError(key);\r\n            }\r\n            const file = await this.database.get(constants_1.FileStore, key);\r\n            const blobs = file.blobs.map(async (link) => {\r\n                const blob = await this.database.get(constants_1.BlobStore, link);\r\n                if (!blob)\r\n                    throw new errors_1.BlobNotFound(key, link);\r\n                return blob.blob;\r\n            });\r\n            return new Blob(await Promise.all(blobs));\r\n        });\r\n    }\r\n    async append(...args) {\r\n        const key = args[0];\r\n        const data = args[1];\r\n        const encoding = args[2];\r\n        const buffer = encoding\r\n            ? buffer_1.Buffer.from(data, encoding)\r\n            : buffer_1.Buffer.from(data);\r\n        const writable = this.writable(key);\r\n        await writable.write(buffer);\r\n        await writable.close();\r\n    }\r\n    async write(...args) {\r\n        const key = args[0];\r\n        const data = args[1];\r\n        const encoding = args[2];\r\n        const buffer = encoding\r\n            ? buffer_1.Buffer.from(data, encoding)\r\n            : buffer_1.Buffer.from(data);\r\n        await this.delete(key);\r\n        const writable = this.writable(key);\r\n        await writable.write(buffer);\r\n        await writable.close();\r\n    }\r\n    /** Deletes a file with the given key. If no file exists, no action is taken. */\r\n    async delete(key) {\r\n        const exists = await this.database.exists(constants_1.FileStore, key);\r\n        if (exists) {\r\n            const file = await this.database.get(constants_1.FileStore, key);\r\n            this.database.delete(constants_1.FileStore, key);\r\n            for (const link of file.blobs) {\r\n                this.database.delete(constants_1.BlobStore, link);\r\n            }\r\n            await this.database.commit();\r\n        }\r\n    }\r\n    /** Disposes of this object. */\r\n    async dispose() {\r\n        return this.semaphore.run(() => this.database.dispose());\r\n    }\r\n}\r\nexports.Bucket = Bucket;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../async\");\r\nconst buffer_1 = require(\"../buffer\");\r\nconst errors_1 = require(\"./errors\");\r\nconst constants_1 = require(\"./constants\");\r\n/**\r\n * Reader\r\n *\r\n * Internal reader type. Used to read buffer streams from IDB storage. This type\r\n * is used by the buckets readable() method to construct a Readable<Buffer> type\r\n * for streaming files.\r\n */\r\nclass Reader {\r\n    /** Creates a new reader with the given options. */\r\n    constructor(options) {\r\n        this.database = options.database;\r\n        this.semaphore = options.semaphore;\r\n        this.key = options.key;\r\n        this.barrier = new async_1.Barrier();\r\n        this.blob = new Blob([]);\r\n        this.chunkSize = 65536;\r\n        this.start = options.start || 0;\r\n        this.end = options.end || Infinity;\r\n        this.offset = this.start;\r\n    }\r\n    /** Prepares this reader for reading. */\r\n    async prepare() {\r\n        return this.semaphore.run(async () => {\r\n            if (!(await this.database.exists(constants_1.FileStore, this.key))) {\r\n                throw new errors_1.FileNotFoundError(this.key);\r\n            }\r\n            const file = await this.database.get(constants_1.FileStore, this.key);\r\n            const blobs = file.blobs.map(async (link) => {\r\n                const blob = await this.database.get(constants_1.BlobStore, link);\r\n                if (!blob)\r\n                    throw new errors_1.BlobNotFound(this.key, link);\r\n                return blob.blob;\r\n            });\r\n            this.blob = new Blob(await Promise.all(blobs));\r\n            return this.barrier.resume();\r\n        });\r\n    }\r\n    /** Reads bytes from the underlying source. */\r\n    read() {\r\n        return this.execute(async () => {\r\n            let start = this.offset;\r\n            let end = start + this.chunkSize;\r\n            if (start >= this.end) {\r\n                start = this.end;\r\n            }\r\n            if (end >= this.end) {\r\n                end = this.end;\r\n            }\r\n            const buffer = await this.readBuffer(start, end);\r\n            this.offset += this.chunkSize;\r\n            return buffer;\r\n        });\r\n    }\r\n    readBuffer(start, end) {\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.addEventListener('progress', (event) => { });\r\n            reader.addEventListener('loadend', (event) => resolve(buffer_1.Buffer.from(event.target.result)));\r\n            reader.addEventListener('error', (event) => reject(event));\r\n            reader.readAsArrayBuffer(this.blob.slice(start, end));\r\n        });\r\n    }\r\n    execute(func) {\r\n        return this.barrier.run(() => func());\r\n    }\r\n}\r\nexports.Reader = Reader;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../async\");\r\nconst buffer_1 = require(\"../buffer\");\r\nconst constants_1 = require(\"./constants\");\r\n/**\r\n * Internal buffering queue.\r\n */\r\nclass ByteBuffer {\r\n    constructor() {\r\n        this.buffers = [];\r\n    }\r\n    /** Returns the number of buffered bytes. */\r\n    size() {\r\n        return this.buffers.reduce((acc, c) => acc + c.byteLength, 0);\r\n    }\r\n    /** Appends this buffer. */\r\n    write(buffer) {\r\n        this.buffers.push(buffer);\r\n    }\r\n    /** Consumes the given number of bytes. */\r\n    read(count) {\r\n        let total = 0;\r\n        const buffers = [];\r\n        while (this.buffers.length > 0 && total <= count) {\r\n            let next = this.buffers.shift();\r\n            total += next.length;\r\n            buffers.push(next);\r\n        }\r\n        const concat = buffer_1.Buffer.concat(buffers);\r\n        const consumed = concat.slice(0, count);\r\n        const remaining = concat.slice(count);\r\n        if (remaining.length > 0) {\r\n            this.buffers.unshift(remaining);\r\n        }\r\n        return consumed;\r\n    }\r\n}\r\n/**\r\n * Writer\r\n *\r\n * Internal writer type used to write buffered streams of data to IDB. This type\r\n * will buffer data in memory until it exceeds the writers watermark, at which\r\n * point it is flushed to disk. Used by the buckets writable() method to\r\n * constructor Writable<Buffer> streams to IDB.\r\n */\r\nclass Writer {\r\n    constructor(options) {\r\n        const key = options.key;\r\n        const created = new Date();\r\n        const updated = new Date();\r\n        const links = [];\r\n        const size = 0;\r\n        this.file = { key, blobs: links, created, updated, size };\r\n        this.database = options.database;\r\n        this.semaphore = options.semaphore;\r\n        this.highWaterMark = 8000000;\r\n        this.buffer = new ByteBuffer();\r\n        this.barrier = new async_1.Barrier();\r\n    }\r\n    /** Prepares this writer for writing. */\r\n    prepare() {\r\n        return this.semaphore.run(async () => {\r\n            const exists = await this.database.exists(constants_1.FileStore, this.file.key);\r\n            if (exists) {\r\n                this.file = await this.database.get(constants_1.FileStore, this.file.key);\r\n            }\r\n            else {\r\n                this.database.insert(constants_1.FileStore, this.file);\r\n                await this.database.commit();\r\n            }\r\n            this.barrier.resume();\r\n        });\r\n    }\r\n    /** Writes the given buffer to disk. */\r\n    write(buffer) {\r\n        return this.execute(async () => {\r\n            this.buffer.write(buffer);\r\n            if (this.buffer.size() < this.highWaterMark) {\r\n                return;\r\n            }\r\n            while (this.buffer.size() > this.highWaterMark) {\r\n                const buffer = this.buffer.read(this.highWaterMark);\r\n                const key = this.database.key();\r\n                const blob = new Blob([buffer]);\r\n                this.file.size += buffer.byteLength;\r\n                this.file.updated = new Date();\r\n                this.file.blobs = [...this.file.blobs, key];\r\n                this.database.insert(constants_1.BlobStore, { key, blob });\r\n                this.database.update(constants_1.FileStore, this.file);\r\n            }\r\n            await this.database.commit();\r\n        });\r\n    }\r\n    /** Flushes any buffered data to disk. */\r\n    flush() {\r\n        return this.execute(async () => {\r\n            if (this.buffer.size() === 0) {\r\n                return;\r\n            }\r\n            while (this.buffer.size() > 0) {\r\n                const buffer = this.buffer.read(this.highWaterMark);\r\n                const key = this.database.key();\r\n                const blob = new Blob([buffer]);\r\n                this.file.size += buffer.byteLength;\r\n                this.file.updated = new Date();\r\n                this.file.blobs = [...this.file.blobs, key];\r\n                this.database.insert(constants_1.BlobStore, { key, blob });\r\n                this.database.update(constants_1.FileStore, this.file);\r\n            }\r\n            await this.database.commit();\r\n        });\r\n    }\r\n    /** Closes this writer, flushing any data before closing. */\r\n    async close() {\r\n        await this.flush();\r\n    }\r\n    /** Executes the given function using this writers scheduling scheme. */\r\n    execute(func) {\r\n        return this.barrier.run(() => this.semaphore.run(() => func()));\r\n    }\r\n}\r\nexports.Writer = Writer;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst sockets_1 = require(\"./sockets\");\r\nconst dhcp_1 = require(\"./dhcp\");\r\n/**\r\n * An in page signalling hub used to facilicate multiple nodes being creating\r\n * in a page without the need to reach out to a wider network. This type is\r\n * used when not specifying a web socket endpoint for the smoke node to connect\r\n * to. It is also used for examples and interactive tests in page.\r\n */\r\nclass PageHubServer {\r\n    constructor(configuration) {\r\n        this.configuration = configuration;\r\n        this.sockets = new Map();\r\n        this.dhcp = new dhcp_1.Dhcp();\r\n    }\r\n    /** Handles incoming connections */\r\n    onConnection(socket) {\r\n        const configuration = this.configuration;\r\n        const address = this.dhcp.next();\r\n        const type = 'binding';\r\n        socket.on('message', message => this.onMessage(address, message));\r\n        socket.on('error', error => this.onError(address, error));\r\n        socket.on('close', () => this.onClose(address));\r\n        socket.send(JSON.stringify({ type, address, configuration }));\r\n        this.sockets.set(address, socket);\r\n    }\r\n    /** Handles an incoming message from the given address. */\r\n    onMessage(address, data) {\r\n        try {\r\n            const message = JSON.parse(data.data);\r\n            switch (message.type) {\r\n                case 'forward': return this.onForward(address, message);\r\n            }\r\n        }\r\n        catch {\r\n            const socket = this.sockets.get(address);\r\n            socket.close();\r\n            this.sockets.delete(address);\r\n        }\r\n    }\r\n    /** Handles an incoming forward request. */\r\n    onForward(address, forward) {\r\n        if (this.sockets.has(forward.to)) {\r\n            const socket = this.sockets.get(forward.to);\r\n            const type = 'forward';\r\n            const from = address;\r\n            const to = forward.to;\r\n            const data = forward.data;\r\n            socket.send(JSON.stringify({ type, from, to, data }));\r\n        }\r\n    }\r\n    /** Handles socket on error events. */\r\n    onError(address, error) {\r\n        console.error(address, error);\r\n    }\r\n    /** Handles socket on close events. */\r\n    onClose(address) {\r\n        this.sockets.delete(address);\r\n    }\r\n    /** Starts this server listening on the given port. */\r\n    listen(port) {\r\n        this.server = sockets_1.createServer(socket => {\r\n            this.onConnection(socket);\r\n        }).listen(port);\r\n    }\r\n    /** Disposes of this object. */\r\n    dispose() {\r\n        this.server.dispose();\r\n    }\r\n}\r\nexports.PageHubServer = PageHubServer;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst bus_1 = require(\"./bus\");\r\nconst socket_1 = require(\"./socket\");\r\n// --------------------------------------------------------------------------\r\n//\r\n// Server\r\n//\r\n// A virtual web socket server designed to run in page. Used to emulate\r\n// a actual network socket connection for nodes that need to run in page\r\n// without connecting to a wider network.\r\n//\r\n// --------------------------------------------------------------------------\r\nclass Server {\r\n    /** Creates a new server. */\r\n    constructor(func) {\r\n        this.func = func;\r\n        this.channel = 0;\r\n        this.sockets = new Map();\r\n    }\r\n    /** Starts this server listening on the given port. */\r\n    listen(port) {\r\n        // Subscribe to 'connect' messages on on the given\r\n        // bus channel. Messages received over here are\r\n        // incoming socket connections.\r\n        bus_1.Bus.on(`${port}:server:connect`, data => {\r\n            const channel = this.channel;\r\n            // Setup socket with the sockets `write` and `close`\r\n            // function used to transmit an event message\r\n            // back out over the bus.\r\n            const socket = new socket_1.Socket(data => setTimeout(() => {\r\n                bus_1.Bus.emit(`${port}:${channel}:client:message`, data);\r\n            }, 0), () => setTimeout(() => {\r\n                bus_1.Bus.emit(`${port}:${channel}:client:close`);\r\n                socket.dispose();\r\n            }, 0));\r\n            // Setup listeners for events received from clients\r\n            // over the bus. Note: The `channel` is made known\r\n            // to the client following sending an `connect`\r\n            // message below.\r\n            bus_1.Bus.on(`${port}:${channel}:server:message`, (data) => {\r\n                socket.emit('message', { data });\r\n            });\r\n            bus_1.Bus.on(`${port}:${channel}:server:close`, () => {\r\n                this.sockets.delete(channel);\r\n                socket.emit('close');\r\n                socket.dispose();\r\n            });\r\n            // Add the socket to a pool of sockets, this\r\n            // allows this server to disconnect connected\r\n            // sockets on `dispose`.\r\n            this.sockets.set(channel, socket);\r\n            // Emit socket to server listener, send connect\r\n            // to client, increment the channel index.\r\n            bus_1.Bus.emit(`${port}:client:connect`, channel);\r\n            this.func(socket);\r\n            this.channel += 1;\r\n        });\r\n        return this;\r\n    }\r\n    /** Disposes of this object. */\r\n    dispose() {\r\n        for (const channel of this.sockets.keys()) {\r\n            const socket = this.sockets.get(channel);\r\n            socket.emit('close');\r\n            socket.dispose();\r\n            this.sockets.delete(channel);\r\n        }\r\n    }\r\n}\r\nexports.Server = Server;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-hub\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Dhcp\r\n *\r\n * Allocates IPv4 like addresses on behalf of connecting nodes.\r\n */\r\nclass Dhcp {\r\n    constructor() {\r\n        this.element = new Uint32Array(1);\r\n        this.element[0] = 0;\r\n    }\r\n    /** Gets the next address. */\r\n    next() {\r\n        const buffer = new Uint8Array(this.element.buffer);\r\n        const result = [...buffer].join('.');\r\n        this.element[0] += 1;\r\n        return result;\r\n    }\r\n}\r\nexports.Dhcp = Dhcp;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../../async\");\r\nconst async_2 = require(\"../../async\");\r\nconst sockets_1 = require(\"./sockets\");\r\n/**\r\n * An in page signalling hub client. Used to communicate with the in-page\r\n * signalling hub. Used as a default hub when smoke nodes are not given\r\n * smoke-hub endpoints to connect to.\r\n */\r\nclass PageHub extends async_1.Events {\r\n    /** Connects to a PageServerHub on the given port. */\r\n    constructor(port) {\r\n        super();\r\n        this.port = port;\r\n        this.barrier = new async_2.Barrier();\r\n        this.socket = sockets_1.connect(this.port);\r\n        this.socket.on('message', (message) => this.onMessage(message));\r\n        this.socket.on('error', error => this.onError(error));\r\n        this.socket.on('close', () => this.onClose());\r\n    }\r\n    on(event, func) {\r\n        super.on(event, func);\r\n    }\r\n    /** Returns the RTC configuration for this hub. */\r\n    configuration() {\r\n        return this.barrier.run(() => this.binding.configuration);\r\n    }\r\n    /** Returns the address of this hub. */\r\n    address() {\r\n        return this.barrier.run(() => this.binding.address);\r\n    }\r\n    /** Forwards the given message to the given 'to' address. */\r\n    forward(to, data) {\r\n        return this.barrier.run(() => {\r\n            const type = 'forward';\r\n            const from = this.binding.address;\r\n            this.socket.send(JSON.stringify({ to, from, type, data }));\r\n        });\r\n    }\r\n    /** Handles 'message' events. (note: event is synthetic in page sockets) */\r\n    onMessage(event) {\r\n        const message = JSON.parse(event.data);\r\n        switch (message.type) {\r\n            case 'binding':\r\n                this.onBinding(message);\r\n                break;\r\n            case 'forward':\r\n                this.onForward(message);\r\n                break;\r\n        }\r\n    }\r\n    /** Handles `binding` messages. */\r\n    onBinding(message) {\r\n        this.binding = message;\r\n        this.barrier.resume();\r\n    }\r\n    /** Handles `forward` messages. */\r\n    onForward(message) {\r\n        super.emit('forward', message);\r\n    }\r\n    /** Handles socket 'close' events. */\r\n    onClose() {\r\n        // todo: consider reconnection here.\r\n        this.barrier.pause();\r\n    }\r\n    /** Handles close events. */\r\n    onError(error) {\r\n        super.emit('error', error);\r\n    }\r\n    /** Disposes of this object. */\r\n    dispose() {\r\n        this.socket.dispose();\r\n        super.dispose();\r\n    }\r\n}\r\nexports.PageHub = PageHub;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar client_1 = require(\"./client\");\r\nexports.NetworkHub = client_1.NetworkHub;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst async_1 = require(\"../../async\");\r\nconst async_2 = require(\"../../async\");\r\n/**\r\n * A network hub client. This type connects to a remote web socket running the\r\n * smoke signalling protocol.\r\n */\r\nclass NetworkHub extends async_1.Events {\r\n    constructor(endpoint) {\r\n        super();\r\n        this.endpoint = endpoint;\r\n        this.barrier = new async_2.Barrier();\r\n        this.socket = new WebSocket(this.endpoint);\r\n        this.socket.addEventListener('message', message => this.onMessage(message));\r\n        this.socket.addEventListener('error', error => this.onError(error));\r\n        this.socket.addEventListener('close', () => this.onClose());\r\n    }\r\n    on(event, func) {\r\n        super.on(event, func);\r\n    }\r\n    /** Returns the RTC configuration for this hub. */\r\n    configuration() {\r\n        return this.barrier.run(() => this.binding.configuration);\r\n    }\r\n    /** Returns the address of this hub. */\r\n    address() {\r\n        return this.barrier.run(() => this.binding.address);\r\n    }\r\n    /** Forwards the given message to the given 'to' address. */\r\n    forward(to, data) {\r\n        return this.barrier.run(() => {\r\n            const type = 'forward';\r\n            const from = this.binding.address;\r\n            this.socket.send(JSON.stringify({ to, from, type, data }));\r\n        });\r\n    }\r\n    /** Handles incoming message. */\r\n    onMessage(event) {\r\n        const message = JSON.parse(event.data);\r\n        switch (message.type) {\r\n            case 'binding':\r\n                this.onBinding(message);\r\n                break;\r\n            case 'forward':\r\n                this.onForward(message);\r\n                break;\r\n        }\r\n    }\r\n    /** Handles 'binding' messages. */\r\n    onBinding(message) {\r\n        this.binding = message;\r\n        this.barrier.resume();\r\n    }\r\n    /** Handles 'forward' messages. */\r\n    onForward(message) {\r\n        super.emit('forward', message);\r\n    }\r\n    /** Handles 'close' events. */\r\n    onClose() {\r\n        this.barrier.pause();\r\n    }\r\n    /** Handles 'close' events. */\r\n    onError(error) {\r\n        super.emit('error', error);\r\n    }\r\n    dispose() {\r\n        this.socket.close();\r\n    }\r\n}\r\nexports.NetworkHub = NetworkHub;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/** Creates a timeout that throws with the given error message. */\r\nfunction timeout(ms, message = 'timeout') {\r\n    return new Promise((_, reject) => {\r\n        setTimeout(() => reject(new Error(message)), ms);\r\n    });\r\n}\r\n/** Receives exactly one message from this data channel. */\r\nfunction receive(channel, eventName) {\r\n    return new Promise(resolve => {\r\n        channel.addEventListener(eventName, function handler(event) {\r\n            channel.removeEventListener(eventName, handler);\r\n            resolve(event);\r\n        });\r\n    });\r\n}\r\nvar Loopback;\r\n(function (Loopback) {\r\n    Loopback[Loopback[\"None\"] = 0] = \"None\";\r\n    Loopback[Loopback[\"Sender\"] = 1] = \"Sender\";\r\n    Loopback[Loopback[\"Receiver\"] = 2] = \"Receiver\";\r\n})(Loopback || (Loopback = {}));\r\nconst loopbackSwitch = (loopback) => loopback === Loopback.Receiver ? Loopback.Sender :\r\n    loopback === Loopback.Sender ? Loopback.Receiver :\r\n        loopback;\r\nclass NegotiateError extends Error {\r\n    constructor(local, remote, error, sdp) {\r\n        super(`local: ${local} remote: ${remote} error: ${error.message}`);\r\n        this.local = local;\r\n        this.remote = remote;\r\n        this.error = error;\r\n        this.sdp = sdp;\r\n    }\r\n}\r\nexports.NegotiateError = NegotiateError;\r\nclass SignallingError extends Error {\r\n    constructor(remote, error) {\r\n        super(`remote: ${remote} error: ${error.message}`);\r\n        this.remote = remote;\r\n        this.error = error;\r\n    }\r\n}\r\nexports.SignallingError = SignallingError;\r\nclass PortInUseError extends Error {\r\n    constructor(port) {\r\n        super(`The port '${port}' is already in use.`);\r\n        this.port = port;\r\n    }\r\n}\r\nexports.PortInUseError = PortInUseError;\r\n/**\r\n * A webrtc peer connection and negotiation layer. This type is intended\r\n * to handle the details of peers, peer signalling, port binding and\r\n * client loopback. This type is used by RTC consumers to interact with\r\n * peer connections without dealing with the details of ICE.\r\n */\r\nclass Network {\r\n    constructor(hub) {\r\n        this.hub = hub;\r\n        this.hub.on('forward', forward => this.onForward(forward));\r\n        this.ports = new Map();\r\n        this.peers = new Map();\r\n        this.createLoopback();\r\n    }\r\n    /** Gets the address of this peer on the network. */\r\n    address() {\r\n        return this.hub.address();\r\n    }\r\n    /** Gets all peers managed by this driver. */\r\n    getPeers() {\r\n        return this.peers;\r\n    }\r\n    /**\r\n     * Connects to a remote endpoint and returns a Peer and RTCDataChannel. This\r\n     * function handles connection negotiate with the remote peer as well as\r\n     * handling network timeouts and remote port reject. The data channel\r\n     * returned from this function is given in an 'open' state ready for use.\r\n     */\r\n    async connect(remote, port) {\r\n        remote = (remote === await this.hub.address() || remote === 'localhost') ? 'localhost:1' : remote;\r\n        const peer = await this.getPeer(remote);\r\n        const channel = peer.connection.createDataChannel(port);\r\n        channel.binaryType = 'arraybuffer';\r\n        // wait for connection\r\n        await Promise.race([\r\n            timeout(4000, `Connection to host '${peer.remote}' timed out.`),\r\n            receive(channel, 'open')\r\n        ]);\r\n        // wait for accept | reject\r\n        const response = await Promise.race([\r\n            timeout(4000, `${peer.remote}' is not responding.`),\r\n            receive(channel, 'message')\r\n        ]).then(response => new Uint8Array(response.data));\r\n        // resolve or reject\r\n        if (response[0] === 1) {\r\n            channel.close();\r\n            throw Error(`'${peer.remote}' forcefully closed this connection.`);\r\n        }\r\n        else {\r\n            return [peer, channel];\r\n        }\r\n    }\r\n    /**\r\n     * Binds the given port to accept remote peer connections on. Data channels\r\n     * passed on this callback passed in an 'open' state ready for immediate use.\r\n     */\r\n    bindPort(port, callback) {\r\n        if (this.ports.has(port)) {\r\n            throw new PortInUseError(port);\r\n        }\r\n        this.ports.set(port, callback);\r\n    }\r\n    /**\r\n     * Unbinds the given port preventing further connections to be received on\r\n     * this port. This function does not close existing connections on the port,\r\n     * so callers will need to explicitly terminate all active connections\r\n     * manually.\r\n     */\r\n    unbindPort(port) {\r\n        this.ports.delete(port);\r\n    }\r\n    /** Disposes of this object. */\r\n    dispose() {\r\n        for (const key of this.peers.keys()) {\r\n            const peer = this.peers.get(key);\r\n            peer.connection.close();\r\n            this.peers.delete(key);\r\n        }\r\n    }\r\n    // #region Peer resolver\r\n    /** Gets or creates a peer to the remote endpoint. */\r\n    async getPeer(remote) {\r\n        const configuration = await this.hub.configuration();\r\n        const local = await this.hub.address();\r\n        if (!this.peers.has(remote)) {\r\n            const connection = new RTCPeerConnection(configuration);\r\n            const loopback = Loopback.None;\r\n            const peer = { connection, local, remote, loopback };\r\n            connection.addEventListener('negotiationneeded', event => this.onNegotiationNeeded(peer, event));\r\n            connection.addEventListener('icecandidate', event => this.onIceCandidate(peer, event));\r\n            connection.addEventListener('datachannel', event => this.onDataChannel(peer, event));\r\n            this.peers.set(remote, peer);\r\n        }\r\n        return this.peers.get(remote);\r\n    }\r\n    // #region Signalling\r\n    /**\r\n     * Forwards a signalling message over to a remote host. This function tries\r\n     * to optimize here by detecting forwards on localhost. These are intercepted\r\n     * before making to the signalling hub.\r\n     */\r\n    async forward(remote, data) {\r\n        if (remote === 'localhost') {\r\n            const type = 'forward';\r\n            const from = 'localhost';\r\n            const to = 'localhost';\r\n            return this.onForward({ type, to, from, data });\r\n        }\r\n        this.hub.forward(remote, data);\r\n    }\r\n    /**\r\n     * Dispatches incoming forwarded messages out to their respective handlers.\r\n     */\r\n    onForward(request) {\r\n        switch (request.data.type) {\r\n            case 'candidate':\r\n                this.onCandidate(request);\r\n                break;\r\n            case 'answer':\r\n                this.onAnswer(request);\r\n                break;\r\n            case 'offer':\r\n                this.onOffer(request);\r\n                break;\r\n        }\r\n    }\r\n    /**\r\n     * Handles incoming offers from remote peers\r\n     */\r\n    async onOffer(request) {\r\n        try {\r\n            const peer = await this.getPeer(this.resolveLoopbackTarget(request));\r\n            await peer.connection.setRemoteDescription(request.data.sdp);\r\n            const sdp = await peer.connection.createAnswer();\r\n            const loopback = loopbackSwitch(request.data.loopback);\r\n            await peer.connection.setLocalDescription(sdp);\r\n            await this.forward(request.from, { type: 'answer', sdp, loopback });\r\n        }\r\n        catch (error) {\r\n            const local = request.to;\r\n            const remote = request.from;\r\n            console.warn(new NegotiateError(local, remote, error, request.data.sdp));\r\n        }\r\n    }\r\n    /**\r\n     * Handles incoming answers from remote peers\r\n     */\r\n    async onAnswer(request) {\r\n        try {\r\n            const peer = await this.getPeer(this.resolveLoopbackTarget(request));\r\n            await peer.connection.setRemoteDescription(request.data.sdp);\r\n        }\r\n        catch (error) {\r\n            console.warn(new NegotiateError(request.to, request.from, error, request.data.sdp));\r\n        }\r\n    }\r\n    /**\r\n     * Handles incoming candidates from remote peers\r\n     */\r\n    async onCandidate(request) {\r\n        try {\r\n            const peer = await this.getPeer(this.resolveLoopbackTarget(request));\r\n            await peer.connection.addIceCandidate(request.data.candidate);\r\n        }\r\n        catch (error) {\r\n            console.warn(new NegotiateError(request.to, request.from, error, request.data.candidate));\r\n        }\r\n    }\r\n    // #region RTCPeerConnection events\r\n    async onNegotiationNeeded(peer, event) {\r\n        try {\r\n            const sdp = await peer.connection.createOffer();\r\n            const loopback = peer.loopback;\r\n            await peer.connection.setLocalDescription(sdp);\r\n            await this.forward(peer.remote, { type: 'offer', sdp, loopback });\r\n        }\r\n        catch (error) {\r\n            const local = peer.local;\r\n            const remote = peer.remote;\r\n            console.warn(new NegotiateError(local, remote, error));\r\n        }\r\n    }\r\n    onIceCandidate(peer, event) {\r\n        if (event.candidate === null) {\r\n            return;\r\n        }\r\n        try {\r\n            const candidate = event.candidate;\r\n            const loopback = peer.loopback;\r\n            this.forward(peer.remote, { type: 'candidate', candidate, loopback });\r\n        }\r\n        catch (error) {\r\n            console.error(new NegotiateError(peer.local, peer.remote, error));\r\n        }\r\n    }\r\n    /**\r\n     * Receives an incoming data channel from a remote peer. This function will\r\n     * tests that this peer is listening on the given port, and if so, emits\r\n     * to that ports listener, otherwise, the socket is sent a rejection signal\r\n     * and closed.\r\n     */\r\n    async onDataChannel(peer, event) {\r\n        const port = event.channel.label;\r\n        const channel = event.channel;\r\n        channel.binaryType = 'arraybuffer';\r\n        try {\r\n            await Promise.race([\r\n                timeout(2000, `Received connection from ${peer.remote} failed to open.`),\r\n                receive(channel, 'open')\r\n            ]);\r\n            if (!this.ports.has(port)) {\r\n                channel.send(new Uint8Array([1]));\r\n                channel.close();\r\n            }\r\n            else {\r\n                channel.send(new Uint8Array([0]));\r\n                const callback = this.ports.get(port);\r\n                callback([peer, channel]);\r\n            }\r\n        }\r\n        catch {\r\n            /** ignore */\r\n        }\r\n    }\r\n    // #region Loopback and Routing\r\n    /**\r\n     * Sets up the peer connections for localhost. localhost:0 is for outbound\r\n     * connections, localhost:1 is for inbound. Therefore when connections are\r\n     * created on localhost, they are always connecting to the localhost:1\r\n     * connection.\r\n     */\r\n    createLoopback() {\r\n        {\r\n            const connection = new RTCPeerConnection();\r\n            const loopback = Loopback.Sender;\r\n            const local = 'localhost';\r\n            const remote = 'localhost';\r\n            const peer = { connection, local, remote, loopback };\r\n            connection.addEventListener('negotiationneeded', event => this.onNegotiationNeeded(peer, event));\r\n            connection.addEventListener('icecandidate', event => this.onIceCandidate(peer, event));\r\n            connection.addEventListener('datachannel', event => this.onDataChannel(peer, event));\r\n            this.peers.set('localhost:0', peer);\r\n        }\r\n        {\r\n            const connection = new RTCPeerConnection();\r\n            const loopback = Loopback.Receiver;\r\n            const local = 'localhost';\r\n            const remote = 'localhost';\r\n            const peer = { connection, local, remote, loopback };\r\n            connection.addEventListener('negotiationneeded', event => this.onNegotiationNeeded(peer, event));\r\n            connection.addEventListener('icecandidate', event => this.onIceCandidate(peer, event));\r\n            connection.addEventListener('datachannel', event => this.onDataChannel(peer, event));\r\n            this.peers.set('localhost:1', peer);\r\n        }\r\n    }\r\n    /**\r\n     * Resolves the loopback target. This function acts as a switch which flips\r\n     * between localhost:0 and localhost:1 if the loopback happens to be on\r\n     * localhost. Used during connection negotiate.\r\n     */\r\n    resolveLoopbackTarget(request) {\r\n        return request.data.loopback === Loopback.Sender ? 'localhost:1' :\r\n            request.data.loopback === Loopback.Receiver ? 'localhost:0' :\r\n                request.from;\r\n    }\r\n}\r\nexports.Network = Network;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst socket_1 = require(\"./socket\");\r\nconst server_1 = require(\"./server\");\r\n/**\r\n * A Web Socket emulation context. Allows one to create\r\n * Rtc socket hosts and functionality to connect to them\r\n * across a peer network. Sockets created by this type\r\n * are fully duplex and mirror the same functionality\r\n * as standard Web Sockets.\r\n */\r\nclass Sockets {\r\n    constructor(net) {\r\n        this.net = net;\r\n        this.servers = [];\r\n    }\r\n    /** Creates Rtc socket server for remote sockets to connect to. */\r\n    createServer(func) {\r\n        const server = new server_1.SocketServer(this.net, func);\r\n        this.servers.push(server);\r\n        return server;\r\n    }\r\n    /** Connects to a remote Rtc socket host.*/\r\n    connect(remote, port) {\r\n        return socket_1.Socket.createSocket(this.net, remote, port.toString());\r\n    }\r\n    /** Disposes of this Rtc context */\r\n    dispose() {\r\n        while (this.servers.length > 0) {\r\n            const server = this.servers.shift();\r\n            server.dispose();\r\n        }\r\n    }\r\n}\r\nexports.Sockets = Sockets;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst buffer_1 = require(\"../buffer\");\r\nconst async_1 = require(\"../async\");\r\nconst streams_1 = require(\"../streams\");\r\nconst NEXT = 0;\r\nconst CANCEL = 1;\r\nconst DATA = 2;\r\nconst ERROR = 3;\r\nconst END = 4;\r\n/**\r\n * An asynchronous network stream. This type layers a Socket and splits it into\r\n * a readable and writable pair. The NetworkStream internally implements\r\n * bi-directional PULL semantics over the socket via a messaging protocol so\r\n * both sender and receiver sockets should be wrapped as NetworkStream to enable\r\n * protocol read/write for the socket. The readable side of this network stream\r\n * is async iterable over the network using these PULL semantics. The\r\n * NetworkStream will manage timeouts over the network which may occur on both\r\n * read and writing ends of the stream.\r\n */\r\nclass NetworkStream {\r\n    /** Creates a NetworkStream from the given Socket. */\r\n    constructor(socket, timeout = 8000) {\r\n        this.socket = socket;\r\n        this.timeout = timeout;\r\n        // readable\r\n        this.read_buffer = [];\r\n        this.read_barrier = new async_1.Barrier();\r\n        this.readable = new streams_1.Readable({\r\n            cancel: () => this.push(CANCEL),\r\n            pull: async (controller) => {\r\n                this.push(NEXT);\r\n                await this.read_barrier.run(() => {\r\n                    this.read_barrier.pause();\r\n                    const [type, buffer] = this.read_buffer.shift();\r\n                    try {\r\n                        switch (type) {\r\n                            case DATA: return controller.enqueue(buffer);\r\n                            case END: return controller.close();\r\n                            case ERROR: throw new Error(buffer.toString());\r\n                            default: throw new Error(`Readable receive invalid header. ${type}`);\r\n                        }\r\n                    }\r\n                    catch (error) {\r\n                        return controller.error(error);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        // setup writable\r\n        this.write_buffer = [];\r\n        this.write_barrier = new async_1.Barrier();\r\n        this.writable = new streams_1.Writable({\r\n            write: async (buffer) => {\r\n                const [type] = await this.next();\r\n                switch (type) {\r\n                    case CANCEL: throw Error('Readable cancelled');\r\n                    case NEXT: return this.push(DATA, buffer);\r\n                }\r\n            },\r\n            abort: async (error) => {\r\n                const [type] = await this.next();\r\n                switch (type) {\r\n                    case CANCEL: throw Error('Readable cancelled');\r\n                    case NEXT: return this.push(ERROR, buffer_1.Buffer.from(error.message));\r\n                }\r\n            },\r\n            close: async () => {\r\n                const [type] = await this.next();\r\n                switch (type) {\r\n                    case CANCEL: throw Error('Readable cancelled');\r\n                    case NEXT: return this.push(END);\r\n                }\r\n            }\r\n        });\r\n        // start message loop\r\n        this.readInternal();\r\n    }\r\n    /** Waits for the NEXT or CANCEL signal from remote. */\r\n    next() {\r\n        return new Promise((resolve, reject) => {\r\n            const handle = setTimeout(() => {\r\n                reject(new Error('Network send timeout.'));\r\n                this.socket.close();\r\n            }, this.timeout);\r\n            return this.write_barrier.run(() => {\r\n                clearTimeout(handle);\r\n                this.write_barrier.pause();\r\n                const next = this.write_buffer.shift();\r\n                resolve(next);\r\n            });\r\n        });\r\n    }\r\n    /** Pushes data to the network. */\r\n    push(type, data = buffer_1.Buffer.alloc(0)) {\r\n        this.socket.send(buffer_1.Buffer.concat([\r\n            buffer_1.Buffer.from([type]),\r\n            buffer_1.Buffer.from(data)\r\n        ]));\r\n    }\r\n    /**\r\n     * Pulls data from the network. This function always resolves with a 'Read'\r\n     * tuple indicating the result of that read. The result given here is used\r\n     * by the 'readInternal()' function to unlock read / write barriers for\r\n     * processing, and for loop termination.\r\n     */\r\n    pull() {\r\n        return new Promise(resolve => {\r\n            setTimeout(() => resolve([ERROR, buffer_1.Buffer.from('Network receive timeout.')]), this.timeout);\r\n            this.socket.once('error', () => resolve([ERROR, buffer_1.Buffer.from('NetworkStream Socket encounted error.')]));\r\n            this.socket.once('close', () => resolve([END, buffer_1.Buffer.alloc(0)]));\r\n            this.socket.once('message', message => {\r\n                const buffer = buffer_1.Buffer.from(message.data);\r\n                const type = buffer.readInt8(0);\r\n                const data = buffer.slice(1);\r\n                switch (type) {\r\n                    case NEXT: return resolve([NEXT, buffer_1.Buffer.alloc(0)]);\r\n                    case CANCEL: return resolve([CANCEL, buffer_1.Buffer.alloc(0)]);\r\n                    case DATA: return resolve([DATA, data]);\r\n                    case ERROR: return resolve([ERROR, data]);\r\n                    case END: return resolve([END, buffer_1.Buffer.alloc(0)]);\r\n                    default: return resolve([ERROR, buffer_1.Buffer.from('NetworkStream Socket sent unknown message header.')]);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * An internal event loop that reads messages from the network, and unlocks\r\n     * read / write barriers. This function is the main driving logic for the\r\n     * readable and writable instances of this stream, where operations are\r\n     * locked until a network message unlocks them (via resume). This function\r\n     * is also responsible for closing the underlying connection.\r\n     */\r\n    async readInternal() {\r\n        let running = true;\r\n        while (running) {\r\n            const next = await this.pull();\r\n            switch (next[0]) {\r\n                // from: readable\r\n                case NEXT: {\r\n                    this.write_buffer.push(next);\r\n                    this.write_barrier.resume();\r\n                    break;\r\n                }\r\n                case CANCEL: {\r\n                    this.write_buffer.push(next);\r\n                    this.write_barrier.resume();\r\n                    running = false;\r\n                    break;\r\n                }\r\n                // from: writable\r\n                case DATA: {\r\n                    this.read_buffer.push(next);\r\n                    this.read_barrier.resume();\r\n                    break;\r\n                }\r\n                case END: {\r\n                    this.read_buffer.push(next);\r\n                    this.read_barrier.resume();\r\n                    running = false;\r\n                    break;\r\n                }\r\n                case ERROR: {\r\n                    this.read_buffer.push(next);\r\n                    this.read_barrier.resume();\r\n                    running = false;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        this.socket.close();\r\n    }\r\n}\r\nexports.NetworkStream = NetworkStream;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst server_1 = require(\"./server\");\r\nconst fetch_1 = require(\"./fetch\");\r\n/**\r\n * A HTTP emulation context. Allows one to create HTTP like web hosts and fetch\r\n * remote resources across a peer network using request response semantics.\r\n */\r\nclass Rest {\r\n    constructor(sockets) {\r\n        this.sockets = sockets;\r\n        this.servers = [];\r\n    }\r\n    /** Creates a new Rest server. */\r\n    createServer(options) {\r\n        const server = new server_1.RestServer(this.sockets, options);\r\n        this.servers.push(server);\r\n        return server;\r\n    }\r\n    /** Fetches a request from a remote host. */\r\n    async fetch(endpoint, options = { method: 'get', headers: {} }) {\r\n        return new fetch_1.Fetch(this.sockets).fetch(endpoint, options);\r\n    }\r\n    /** Disposes of this object. */\r\n    dispose() {\r\n        while (this.servers.length > 0) {\r\n            const server = this.servers.shift();\r\n            server.dispose();\r\n        }\r\n    }\r\n}\r\nexports.Rest = Rest;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/** Resolves middleware functions as interfaced middleware objects. */\r\nfunction asMiddleware(middleware) {\r\n    if (typeof middleware === 'function') {\r\n        const handle = middleware;\r\n        return { handle };\r\n    }\r\n    else {\r\n        return middleware;\r\n    }\r\n}\r\nexports.asMiddleware = asMiddleware;\r\n/** Common function for executing a middleware stack. Excepts a cloned stack on each invocation. */\r\nfunction runStack(stack, request, response, next) {\r\n    return (stack.length > 0)\r\n        ? stack.shift().handle(request, response, () => runStack(stack, request, response, next))\r\n        : next();\r\n}\r\nexports.runStack = runStack;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Pattern {\r\n    /** Creates a pattern matcher object. */\r\n    constructor(pattern) {\r\n        this.pattern = pattern;\r\n        this.results = Pattern.parsePattern(this.pattern);\r\n        this.regex = Pattern.buildRegex(this.results);\r\n        this.params = Pattern.buildParams(this.results);\r\n    }\r\n    /** Matches for the given url. If match returns Params otherwise undefined.  */\r\n    match(url) {\r\n        const match = url.match(this.regex);\r\n        if (match) {\r\n            return this.params.reduce((acc, param, index) => {\r\n                acc[param] = match[index + 1];\r\n                return acc;\r\n            }, {});\r\n        }\r\n        return undefined;\r\n    }\r\n    /** Parses the pattern, resolving an array of parse tokens used to build params regex expressions. */\r\n    static parsePattern(pattern) {\r\n        const characters = pattern.split('');\r\n        const results = [];\r\n        let mode = 'literal';\r\n        let buffer = [];\r\n        while (characters.length > 0) {\r\n            const current = characters.shift();\r\n            if (current === '?' || current === '&') {\r\n                throw Error(`Illegal character '${current}' in pattern '${pattern}'`);\r\n            }\r\n            if (mode === 'literal' && current !== ':') {\r\n                buffer.push(current);\r\n                continue;\r\n            }\r\n            if (current === ':') {\r\n                const type = 'literal';\r\n                const value = buffer.join('');\r\n                results.push({ type, value });\r\n                mode = 'param';\r\n                buffer = [];\r\n                continue;\r\n            }\r\n            if (mode === 'param' && (current === '/' || current === '-')) {\r\n                const type = 'param';\r\n                const value = buffer.join('');\r\n                results.push({ type, value });\r\n                mode = 'literal';\r\n                buffer = [];\r\n                buffer.push(current);\r\n                continue;\r\n            }\r\n            buffer.push(current);\r\n        }\r\n        if (buffer.length > 0) {\r\n            const type = mode;\r\n            const value = buffer.join('');\r\n            results.push({ type, value });\r\n        }\r\n        return results;\r\n    }\r\n    /** Builds the patterns regular expression from parser results. */\r\n    static buildRegex(results) {\r\n        const expr = results\r\n            .map(result => (result.type === 'param' ? '([\\\\w-_$]*)' : result.value))\r\n            .join('');\r\n        return new RegExp(`^${expr}$`);\r\n    }\r\n    /** Builds the patterns param names from parser results. */\r\n    static buildParams(results) {\r\n        return results\r\n            .filter(result => result.type === 'param')\r\n            .map(result => result.value);\r\n    }\r\n}\r\nexports.Pattern = Pattern;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst buffer_1 = require(\"../../buffer\");\r\nclass ResponseHeaderNotReceivedError extends Error {\r\n    constructor() {\r\n        super('Server closed without sending a header.');\r\n    }\r\n}\r\nexports.ResponseHeaderNotReceivedError = ResponseHeaderNotReceivedError;\r\nclass ResponseHeaderInvalidError extends Error {\r\n    constructor() {\r\n        super('Server sent an invalid request header.');\r\n    }\r\n}\r\nexports.ResponseHeaderInvalidError = ResponseHeaderInvalidError;\r\nclass RequestHeaderInvalidError extends Error {\r\n    constructor() {\r\n        super('Client sent an invalid request header.');\r\n    }\r\n}\r\nexports.RequestHeaderInvalidError = RequestHeaderInvalidError;\r\nclass HeaderProtocol {\r\n    /** Sends the client request header. */\r\n    static async writeRequestHeader(stream, header) {\r\n        await stream.writable.write(buffer_1.Buffer.from(JSON.stringify(header)));\r\n    }\r\n    /** Reads the client request header. */\r\n    static async readRequestHeader(stream) {\r\n        const read = await stream.readable.read();\r\n        if (read.done) {\r\n            throw new RequestHeaderInvalidError();\r\n        }\r\n        const header = JSON.parse(read.value.toString());\r\n        if (header.url === undefined || typeof header.url !== 'string') {\r\n            throw new RequestHeaderInvalidError();\r\n        }\r\n        if (header.method === undefined || typeof header.method !== 'string') {\r\n            throw new RequestHeaderInvalidError();\r\n        }\r\n        if (header.headers === undefined || typeof header.headers !== 'object') {\r\n            throw new RequestHeaderInvalidError();\r\n        }\r\n        // Wait for mediastream track to appear.\r\n        return header;\r\n    }\r\n    /** Sends the server response header. */\r\n    static async writeResponseHeader(stream, header) {\r\n        await stream.writable.write(buffer_1.Buffer.from(JSON.stringify(header)));\r\n    }\r\n    /** Reads the server response header. */\r\n    static async readResponseHeader(stream) {\r\n        const { done, value } = await stream.readable.read();\r\n        if (done) {\r\n            throw new ResponseHeaderNotReceivedError();\r\n        }\r\n        const header = JSON.parse(value.toString());\r\n        if (header.status === undefined) {\r\n            throw new ResponseHeaderInvalidError();\r\n        }\r\n        if (header.headers === undefined) {\r\n            throw new ResponseHeaderInvalidError();\r\n        }\r\n        return header;\r\n    }\r\n}\r\nexports.HeaderProtocol = HeaderProtocol;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst queryable_1 = require(\"../../queryable\");\r\nconst streams_1 = require(\"../../streams\");\r\nconst buffer_1 = require(\"../../buffer\");\r\nconst SEND_CHUNK_SIZE = 65536; // 64k\r\n/**\r\n * The REST body protocol. Provides request body read / write between client\r\n * and server. Also supports the transmission of mediastreams.\r\n */\r\nclass BodyProtocol {\r\n    // #region readable\r\n    /** Segments the given buffers with the given size. */\r\n    static partition(buffers, size) {\r\n        const buffer = buffer_1.Buffer.concat(buffers);\r\n        const segments = [];\r\n        let offset = 0;\r\n        while (true) {\r\n            const slice = buffer.slice(offset, offset + size);\r\n            offset += slice.length;\r\n            if (slice.length > 0) {\r\n                segments.push(slice);\r\n                continue;\r\n            }\r\n            break;\r\n        }\r\n        return segments;\r\n    }\r\n    /**\r\n     * Transmits the given readable to the writable. Will signal EOF as a zero\r\n     * length buffer. This function will partition the buffers received from the\r\n     * given readable into buffer slices manageable for the underlying transport.\r\n     */\r\n    static async writeReadable(stream, readable, options = { ignoreError: false }) {\r\n        try {\r\n            const empty = buffer_1.Buffer.alloc(0);\r\n            let store = empty;\r\n            for await (const buffer of readable) {\r\n                const buffers = this.partition([store, buffer], SEND_CHUNK_SIZE);\r\n                store = empty;\r\n                for (const buffer of buffers) {\r\n                    if (buffer.length === SEND_CHUNK_SIZE) {\r\n                        await stream.writable.write(buffer);\r\n                    }\r\n                    else {\r\n                        store = buffer;\r\n                    }\r\n                }\r\n            }\r\n            if (store.length > 0) {\r\n                await stream.writable.write(store);\r\n            }\r\n            await stream.writable.write(buffer_1.Buffer.alloc(0)); // EOF\r\n        }\r\n        catch (error) {\r\n            if (!options.ignoreError) {\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Reads from the network stream as a REST body. Continues to pull content\r\n     * from the network stream until EOF.\r\n     */\r\n    static readReadable(stream) {\r\n        return new streams_1.Readable({\r\n            pull: async (controller) => {\r\n                try {\r\n                    const next = await stream.readable.read();\r\n                    const buffer = next.value;\r\n                    const end = (buffer.length === 0);\r\n                    if (!end) {\r\n                        controller.enqueue(buffer);\r\n                    }\r\n                    else {\r\n                        controller.close();\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    controller.error(new Error('Unable to read from this stream.'));\r\n                }\r\n            }\r\n        });\r\n    }\r\n    // #region queryable\r\n    /**\r\n     * Transmits the given queryable on the response stream. This allows for the\r\n     * receiver to pull new values from the queryable via the NetworkStream\r\n     * protocol. The different between this and the writeReadable is that\r\n     * records are encoded as JSON buffers.\r\n     */\r\n    static async writeQueryable(stream, queryable, options = { ignoreError: false }) {\r\n        try {\r\n            for await (const record of queryable) {\r\n                const json = JSON.stringify(record);\r\n                const buffer = buffer_1.Buffer.from(json, 'utf-8');\r\n                await stream.writable.write(buffer);\r\n            }\r\n            await stream.writable.write(buffer_1.Buffer.alloc(0)); // EOF\r\n        }\r\n        catch (error) {\r\n            if (!options.ignoreError) {\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Reads the given queryable as a REST body. This function will wrap the given\r\n     * queryable and continue to emit values from it so long as the payload\r\n     * received is not zero length (signalling EOF).\r\n     */\r\n    static readQueryable(stream) {\r\n        async function* generator(stream) {\r\n            for await (const buffer of stream.readable) {\r\n                if (buffer.length === 0) {\r\n                    break;\r\n                }\r\n                const json = buffer.toString('utf-8');\r\n                const record = JSON.parse(json);\r\n                yield record;\r\n            }\r\n        }\r\n        return new queryable_1.Queryable(generator(stream));\r\n    }\r\n    // #region mediastream\r\n    /**\r\n     * Writes the given mediastream out as the body on this streams writable.\r\n     * This function will send a disposition header on the response stream\r\n     * followed by the tracks themselves. Receivers should check the disposition\r\n     * before attempting to wait on incoming tracks.\r\n     */\r\n    static async writeMediaStream(stream, mediastream, options = { ignoreError: false }) {\r\n        try {\r\n            // Send disposition descriptor on response then EOF. We could additionally\r\n            // forward the mediastream id on the body for the recipient to check. \r\n            // Consider this if issues are observed with concurrent mediastreams overlap\r\n            // from the same sender.\r\n            await stream.writable.write(buffer_1.Buffer.from('mediastream'));\r\n            // Send mediastreams through the socket directory. It may be worth looking\r\n            // at another mechanism for doing instead of having to pipe through the\r\n            // Socket interface.\r\n            for (const track of mediastream.getTracks()) {\r\n                await stream.socket.addTrack(track, mediastream);\r\n            }\r\n            // Send EOF, signalling the mediastream tracks (body) have been sent.\r\n            await stream.writable.write(buffer_1.Buffer.alloc(0)); // EOF\r\n        }\r\n        catch (error) {\r\n            if (!options.ignoreError) {\r\n                throw error;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Reads a mediastream as a response. This function will check the disposition\r\n     * prior to listening for incoming tracks. This check is to help the receiver\r\n     * learn if they are actually receiving the correct type.\r\n     */\r\n    static async readMediaStream(stream) {\r\n        function wait_for_stream(stream, timeout) {\r\n            return new Promise((resolve, reject) => {\r\n                setTimeout(() => reject(new Error('MediaStream receive timeout.')), timeout);\r\n                stream.socket.once('track', track => resolve(track.streams[0]));\r\n            });\r\n        }\r\n        async function read_disposition() {\r\n            const { value: disposition } = await stream.readable.read();\r\n            const { value: eof } = await stream.readable.read();\r\n            return [disposition, eof];\r\n        }\r\n        async function read_transmit() {\r\n            for await (const buffer of stream.readable) {\r\n                // Here, we only read the values from the senders MediaStreamContext,\r\n                // this iteration will continue until the remote sender has disposed\r\n                // of the context. \r\n            }\r\n        }\r\n        const [disposition, eof] = await read_disposition();\r\n        if (disposition.toString() !== 'mediastream' && eof.length !== 0) {\r\n            throw Error('Unable to read mediastream. Sender sent invalid data.');\r\n        }\r\n        const mediastream = await wait_for_stream(stream, 4000);\r\n        read_transmit();\r\n        return mediastream;\r\n    }\r\n}\r\nexports.BodyProtocol = BodyProtocol;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst sockets_1 = require(\"../../sockets\");\r\nconst protocol_1 = require(\"../protocol\");\r\nconst request_1 = require(\"./request\");\r\nconst response_1 = require(\"./response\");\r\nconst router_1 = require(\"./router\");\r\nconst NETWORK_TIMEOUT = 4000;\r\n/**\r\n * A Rest server implementation fashioned on the nodejs express module.\r\n * This server provides route matching, middleware, and router and allows\r\n * for the transmission of byte data as well as MediaStream sharing using\r\n * response response semantics.\r\n */\r\nclass RestServer extends router_1.Router {\r\n    /** Creates a new instance of this server */\r\n    constructor(sockets, options) {\r\n        super();\r\n        this.sockets = sockets;\r\n        this.options = options;\r\n        this.options = this.options || {};\r\n        this.options.timeout = this.options.timeout || NETWORK_TIMEOUT;\r\n    }\r\n    /** Starts this server listening on the given port. */\r\n    listen(port) {\r\n        this.server = this.sockets.createServer(socket => this.onSocket(socket));\r\n        this.server.listen(port);\r\n        return this;\r\n    }\r\n    /** Disposes of this server. */\r\n    dispose() {\r\n        this.server.dispose();\r\n    }\r\n    /** Handles this socket as a request / response. */\r\n    async onSocket(socket) {\r\n        const stream = new sockets_1.NetworkStream(socket, this.options.timeout);\r\n        const response = new response_1.RestResponse(stream);\r\n        try {\r\n            const header = await protocol_1.HeaderProtocol.readRequestHeader(stream);\r\n            const request = new request_1.RestRequest(stream, header);\r\n            this.handle(request, response, () => { response.text('not found', 404); });\r\n        }\r\n        catch (error) {\r\n            response.text('internal server error', 500);\r\n        }\r\n    }\r\n}\r\nexports.RestServer = RestServer;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst url_1 = require(\"../../url\");\r\nconst buffer_1 = require(\"../../buffer\");\r\nconst streams_1 = require(\"../../streams\");\r\nconst sockets_1 = require(\"../../sockets\");\r\nconst request_1 = require(\"./request\");\r\nconst response_1 = require(\"./response\");\r\nclass FetchUrlError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n    }\r\n}\r\nexports.FetchUrlError = FetchUrlError;\r\nclass FetchReadError extends Error {\r\n    constructor(expected, actual) {\r\n        super(`Cannot read a '${expected}' from a '${actual}' response.`);\r\n    }\r\n}\r\nexports.FetchReadError = FetchReadError;\r\n/**\r\n * A REST fetch API that allows callers to retrieve resources hosted on remote\r\n * REST servers running within a peer network. Provides similar functionality\r\n * to the standard browser fetch API with the added ability to map readable\r\n * queryable and mediastreams responses.\r\n */\r\nclass Fetch {\r\n    constructor(sockets) {\r\n        this.sockets = sockets;\r\n    }\r\n    /** Creates a readable from the given buffer. */\r\n    createReadable(buffer) {\r\n        const queue = (buffer.length > 0) ? [buffer] : [];\r\n        return new streams_1.Readable({\r\n            pull: (controller) => {\r\n                if (queue.length > 0) {\r\n                    const next = queue.shift();\r\n                    controller.enqueue(next);\r\n                }\r\n                else {\r\n                    controller.close();\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /** Resolves a readable stream from body. */\r\n    resolveBodyAsReadable(body) {\r\n        if (body === undefined) {\r\n            return this.createReadable(buffer_1.Buffer.alloc(0));\r\n        }\r\n        else if (body instanceof streams_1.Readable) {\r\n            return body;\r\n        }\r\n        else if (body instanceof Uint8Array) { // matches: Buffer\r\n            return this.createReadable(body);\r\n        }\r\n        else if (body instanceof ArrayBuffer) {\r\n            return this.createReadable(buffer_1.Buffer.from(body));\r\n        }\r\n        else if (typeof body === 'string') {\r\n            return this.createReadable(buffer_1.Buffer.from(body));\r\n        }\r\n        else {\r\n            const json = JSON.stringify(body);\r\n            return this.createReadable(buffer_1.Buffer.from(json));\r\n        }\r\n    }\r\n    /** Opens a socket to the remote host. */\r\n    async connect(host, port) {\r\n        return new Promise((resolve, reject) => {\r\n            const socket = this.sockets.connect(host, port);\r\n            socket.once('error', error => reject(error));\r\n            socket.once('close', () => reject(new Error('Fetch socket closed unexpectedly.')));\r\n            socket.once('open', () => resolve(socket));\r\n        });\r\n    }\r\n    /**\r\n     * Creates a fetch request to a remote Rest server and returns a FetchResponse.\r\n     * @param endpoint The 'rest://<address>:<port>` endpoint. If no port is given,\r\n     * port 80 is used. If fetching resources from localhost, you can pass the root\r\n     * relative path.\r\n     * @param options The method, header and body options for this request. If undefined\r\n     * the request method will be GET.\r\n     */\r\n    async fetch(endpoint, options) {\r\n        options = options || {};\r\n        options.method = options.method || 'get';\r\n        options.headers = options.headers || {};\r\n        const result = url_1.Url.parse(endpoint);\r\n        if (result.protocol && result.protocol !== 'rest:') {\r\n            throw new FetchUrlError(`Can only fetch with 'rest:// protocols.'`);\r\n        }\r\n        if (result.path === null) {\r\n            throw new FetchUrlError(`The fetch URL '${result.path}' is invalid.`);\r\n        }\r\n        const url = result.path;\r\n        const host = result.host || 'localhost';\r\n        const port = result.port || '80';\r\n        const method = options.method || 'get';\r\n        const headers = options.headers || {};\r\n        const body = this.resolveBodyAsReadable(options.body);\r\n        const stream = new sockets_1.NetworkStream(await this.connect(host, port));\r\n        const request = new request_1.FetchRequest(stream, { url, method, headers }, body);\r\n        const response = await request.getResponse();\r\n        return new response_1.FetchResponse(stream, response);\r\n    }\r\n}\r\nexports.Fetch = Fetch;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst system_1 = require(\"./system\");\r\nconst hub_1 = require(\"./hub\");\r\nconst network_1 = require(\"./network\");\r\nconst sockets_1 = require(\"./sockets\");\r\nconst rest_1 = require(\"./rest\");\r\nconst media_1 = require(\"./media\");\r\nnew hub_1.PageHubServer({}).listen(0);\r\n/**\r\n * A peer to peer networking node that runs inside the browser. Instances of\r\n * this type form the primary API for smoke. It includes networking and storage\r\n * APIs that enable for the creation of rich data driven services over WebRTC.\r\n */\r\nclass Node {\r\n    /** Creates a new Smoke node with the given options. */\r\n    constructor(options) {\r\n        this.options = options;\r\n        options = options || {};\r\n        this.hub = options.hub || new hub_1.PageHub(0);\r\n        this.network = new network_1.Network(this.hub);\r\n        this.system = new system_1.System(this.network);\r\n        this.sockets = new sockets_1.Sockets(this.network);\r\n        this.rest = new rest_1.Rest(this.sockets);\r\n        this.media = new media_1.Media();\r\n    }\r\n    /**\r\n     * Returns the network address of this node. This address is given to the\r\n     * node by way of the hub this node is connected to. To assign a hostname\r\n     * for this node, use the hub api.\r\n     */\r\n    address() {\r\n        return this.hub.address();\r\n    }\r\n    /**\r\n     * Disposes of this node along with its connection to the network.\r\n     */\r\n    async dispose() {\r\n        await this.rest.dispose();\r\n        await this.sockets.dispose();\r\n        await this.network.dispose();\r\n    }\r\n}\r\nexports.Node = Node;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar media_1 = require(\"./media\");\r\nexports.Media = media_1.Media;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst webrtc_1 = require(\"./webrtc\");\r\nconst mse_1 = require(\"./mse\");\r\n/**\r\n * Provides interface for creating and generating MediaStream and MediaSource\r\n * objects for video playback and streaming. This namespace deals with both\r\n * the WebRTC MediaStream API as well as the Media Source Extension API.\r\n */\r\nclass Media {\r\n    /**\r\n     * Generates a live video feed from a background captureStream(). Useful for\r\n     * testing mediastream pass-through over webrtc.\r\n     *\r\n     * @example\r\n     *\r\n     * ```typescript\r\n     *\r\n     * const mediastream = media.createTestPattern()\r\n     * const video = document.getElementById('video-id')\r\n     * video.srcObject = mediastream\r\n     * video.play()\r\n     * ```\r\n     */\r\n    createTestPattern() {\r\n        return webrtc_1.WebRTC.createTestPattern();\r\n    }\r\n    /**\r\n     * Creates a MediaSource from the given Readable<Buffer>. Accepts a codec type\r\n     * for playback of 'webm' and 'mp4' content only.\r\n     *\r\n     * @example\r\n     *\r\n     * ```typescript\r\n     *\r\n     * const readable = files.readable('/video.webm')\r\n     * const mediasource = media.createMediaSource(readable, 'webm')\r\n     * const video = document.getElementById('video-id')\r\n     * video.src = URL.createObjectURL(mediasource)\r\n     * video.play()\r\n     * ```\r\n     */\r\n    createMediaSource(readable, codec) {\r\n        return mse_1.MediaSourceExtensions.createMediaSource(readable, codec);\r\n    }\r\n}\r\nexports.Media = Media;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass WebRTC {\r\n    /** Generates a live MediaStream test pattern. */\r\n    static createTestPattern() {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = 1024;\r\n        canvas.height = 768;\r\n        const context = canvas.getContext('2d');\r\n        setInterval(() => {\r\n            const r = Math.floor(Math.random() * 255);\r\n            const g = Math.floor(Math.random() * 255);\r\n            const b = Math.floor(Math.random() * 255);\r\n            context.fillStyle = `rgb(${r}, ${g}, ${b})`;\r\n            context.fillRect(0, 0, 100, 100);\r\n        }, 10);\r\n        const facade = canvas;\r\n        return facade['captureStream'](30);\r\n    }\r\n}\r\nexports.WebRTC = WebRTC;\r\n","\"use strict\";\r\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2019 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Provides functionality over the Media Source Extensions API.\r\n */\r\nclass MediaSourceExtensions {\r\n    static resolveCodec(codec) {\r\n        switch (codec) {\r\n            case 'mp4': return 'video/mp4; codecs=\"avc1.640029, mp4a.40.5\"';\r\n            case 'webm': return 'video/webm; codecs=\"vp8, vorbis\"';\r\n            default: throw Error(`Unknown media codec type ${codec}`);\r\n        }\r\n    }\r\n    static async writeSourceBuffer(readable, buffer) {\r\n        const { done, value } = await readable.read();\r\n        if (!done) {\r\n            buffer.appendBuffer(value);\r\n            return value.length;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    }\r\n    /**\r\n     * Creates a MediaSource from the given Readable<Buffer>. Accepts a codec type\r\n     * for playback of 'webm' and 'mp4' content only.\r\n     */\r\n    static createMediaSource(readable, codec) {\r\n        const mediasource = new MediaSource();\r\n        mediasource.addEventListener('sourceopen', async () => {\r\n            const buffer = mediasource.addSourceBuffer(this.resolveCodec(codec));\r\n            buffer.mode = 'sequence';\r\n            buffer.addEventListener('updateend', async () => {\r\n                const written = await this.writeSourceBuffer(readable, buffer);\r\n                if (written === 0) {\r\n                    mediasource.endOfStream();\r\n                }\r\n            });\r\n            const written = await this.writeSourceBuffer(readable, buffer);\r\n            if (written === 0) {\r\n                mediasource.endOfStream();\r\n            }\r\n        });\r\n        return mediasource;\r\n    }\r\n}\r\nexports.MediaSourceExtensions = MediaSourceExtensions;\r\n"],"sourceRoot":""}